<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Lab 4 局部线性估计及效率分析（工资案例） | 高级计量暑期研讨</title>
  <meta name="description" content="高级计量经济学系列专题。" />
  <meta name="generator" content="bookdown 0.22.2 and GitBook 2.6.7" />

  <meta property="og:title" content="Lab 4 局部线性估计及效率分析（工资案例） | 高级计量暑期研讨" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="高级计量经济学系列专题。" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Lab 4 局部线性估计及效率分析（工资案例） | 高级计量暑期研讨" />
  
  <meta name="twitter:description" content="高级计量经济学系列专题。" />
  

<meta name="author" content="胡华平" />


<meta name="date" content="2022-06-29" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="lab-local-reg.html"/>
<link rel="next" href="lab-srdd-nocovs.html"/>
<script src="libs/header-attrs/header-attrs.js"></script>
<script src="libs/jquery/jquery.min.js"></script>
<link href="libs/gitbook/css/style.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections/anchor-sections.js"></script>
<script src="libs/htmlwidgets/htmlwidgets.js"></script>
<link href="libs/datatables-css/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding/datatables.js"></script>
<link href="libs/dt-core/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk/js/crosstalk.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="css/text-box.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">高级计量暑期研讨</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>前言</a></li>
<li class="chapter" data-level="1" data-path="lab-R-beginner.html"><a href="lab-R-beginner.html"><i class="fa fa-check"></i><b>1</b> R语言在计量经济的应用（新手启蒙）</a>
<ul>
<li class="chapter" data-level="1.1" data-path="lab-R-beginner.html"><a href="lab-R-beginner.html#open-source"><i class="fa fa-check"></i><b>1.1</b> 现代开源统计软件的趋势特点</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="lab-R-beginner.html"><a href="lab-R-beginner.html#封闭vs开源"><i class="fa fa-check"></i><b>1.1.1</b> 封闭VS开源</a></li>
<li class="chapter" data-level="1.1.2" data-path="lab-R-beginner.html"><a href="lab-R-beginner.html#文学化编程"><i class="fa fa-check"></i><b>1.1.2</b> 文学化编程</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="lab-R-beginner.html"><a href="lab-R-beginner.html#the-useage"><i class="fa fa-check"></i><b>1.2</b> R在论文写作和项目协作中的应用</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="lab-R-beginner.html"><a href="lab-R-beginner.html#科技论文写作演示现场操作"><i class="fa fa-check"></i><b>1.2.1</b> 科技论文写作演示（现场操作）</a></li>
<li class="chapter" data-level="1.2.2" data-path="lab-R-beginner.html"><a href="lab-R-beginner.html#科研项目写作演示现场操作"><i class="fa fa-check"></i><b>1.2.2</b> 科研项目写作演示（现场操作）</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="lab-R-beginner.html"><a href="lab-R-beginner.html#Rstudio-intro"><i class="fa fa-check"></i><b>1.3</b> R及Rstudio简介</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="lab-R-beginner.html"><a href="lab-R-beginner.html#rstudio基本视窗"><i class="fa fa-check"></i><b>1.3.1</b> Rstudio基本视窗</a></li>
<li class="chapter" data-level="1.3.2" data-path="lab-R-beginner.html"><a href="lab-R-beginner.html#项目文件结构"><i class="fa fa-check"></i><b>1.3.2</b> 项目文件结构</a></li>
<li class="chapter" data-level="1.3.3" data-path="lab-R-beginner.html"><a href="lab-R-beginner.html#r包r-packages"><i class="fa fa-check"></i><b>1.3.3</b> R包（R packages）</a></li>
<li class="chapter" data-level="1.3.4" data-path="lab-R-beginner.html"><a href="lab-R-beginner.html#r编程风格classic-r-vs-tidyvese-r"><i class="fa fa-check"></i><b>1.3.4</b> R编程风格：Classic R VS tidyvese R</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="lab-R-beginner.html"><a href="lab-R-beginner.html#resources"><i class="fa fa-check"></i><b>1.4</b> 一些R学习资源</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="lab-R-beginner.html"><a href="lab-R-beginner.html#用r进行编程统计分析"><i class="fa fa-check"></i><b>1.4.1</b> 用R进行编程统计分析</a></li>
<li class="chapter" data-level="1.4.2" data-path="lab-R-beginner.html"><a href="lab-R-beginner.html#用r进行绘图图形可视化"><i class="fa fa-check"></i><b>1.4.2</b> 用R进行绘图（图形可视化）</a></li>
<li class="chapter" data-level="1.4.3" data-path="lab-R-beginner.html"><a href="lab-R-beginner.html#用r来写文章"><i class="fa fa-check"></i><b>1.4.3</b> 用R来写文章</a></li>
<li class="chapter" data-level="1.4.4" data-path="lab-R-beginner.html"><a href="lab-R-beginner.html#project版本控制和团队协作"><i class="fa fa-check"></i><b>1.4.4</b> project版本控制和团队协作</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="lab-R-beginner.html"><a href="lab-R-beginner.html#recommends-AE"><i class="fa fa-check"></i><b>1.5</b> 关于计量经济学习的几点建议</a></li>
<li class="chapter" data-level="1.6" data-path="lab-R-beginner.html"><a href="lab-R-beginner.html#recommends-coding"><i class="fa fa-check"></i><b>1.6</b> 关于编程语言的几点建议</a></li>
<li class="chapter" data-level="" data-path="lab-R-beginner.html"><a href="lab-R-beginner.html#参考文献"><i class="fa fa-check"></i>参考文献</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="lab-mean-est.html"><a href="lab-mean-est.html"><i class="fa fa-check"></i><b>2</b> 均值估计（模拟数据）</a>
<ul>
<li class="chapter" data-level="2.1" data-path="lab-mean-est.html"><a href="lab-mean-est.html#实验说明"><i class="fa fa-check"></i><b>2.1</b> 实验说明</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="lab-mean-est.html"><a href="lab-mean-est.html#实验内容"><i class="fa fa-check"></i><b>2.1.1</b> 实验内容</a></li>
<li class="chapter" data-level="2.1.2" data-path="lab-mean-est.html"><a href="lab-mean-est.html#材料准备"><i class="fa fa-check"></i><b>2.1.2</b> 材料准备</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="lab-mean-est.html"><a href="lab-mean-est.html#数据集描述"><i class="fa fa-check"></i><b>2.2</b> 数据集描述</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="lab-mean-est.html"><a href="lab-mean-est.html#数据呈现"><i class="fa fa-check"></i><b>2.2.1</b> 数据呈现</a></li>
<li class="chapter" data-level="2.2.2" data-path="lab-mean-est.html"><a href="lab-mean-est.html#数据散点图"><i class="fa fa-check"></i><b>2.2.2</b> 数据散点图</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="lab-mean-est.html"><a href="lab-mean-est.html#均值估计"><i class="fa fa-check"></i><b>2.3</b> 均值估计</a></li>
<li class="chapter" data-level="2.4" data-path="lab-mean-est.html"><a href="lab-mean-est.html#整合计算结果"><i class="fa fa-check"></i><b>2.4</b> 整合计算结果</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="lab-mean-est.html"><a href="lab-mean-est.html#基于箱组数的结果整合n1001"><i class="fa fa-check"></i><b>2.4.1</b> 基于箱组数的结果整合（N=1001）</a></li>
<li class="chapter" data-level="2.4.2" data-path="lab-mean-est.html"><a href="lab-mean-est.html#匹配样本数据和箱组nn100100"><i class="fa fa-check"></i><b>2.4.2</b> 匹配样本数据和箱组（Nn=100100）</a></li>
<li class="chapter" data-level="2.4.3" data-path="lab-mean-est.html"><a href="lab-mean-est.html#获得不同方法下的计算表格"><i class="fa fa-check"></i><b>2.4.3</b> 获得不同方法下的计算表格</a></li>
<li class="chapter" data-level="2.4.4" data-path="lab-mean-est.html"><a href="lab-mean-est.html#生成箱组区隔及相关计算表"><i class="fa fa-check"></i><b>2.4.4</b> 生成箱组区隔及相关计算表</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="lab-mean-est.html"><a href="lab-mean-est.html#绘制分析图"><i class="fa fa-check"></i><b>2.5</b> 绘制分析图</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="lab-mean-est.html"><a href="lab-mean-est.html#绘制底图"><i class="fa fa-check"></i><b>2.5.1</b> 绘制底图</a></li>
<li class="chapter" data-level="2.5.2" data-path="lab-mean-est.html"><a href="lab-mean-est.html#箱组均值估计图形"><i class="fa fa-check"></i><b>2.5.2</b> 箱组均值估计图形</a></li>
<li class="chapter" data-level="2.5.3" data-path="lab-mean-est.html"><a href="lab-mean-est.html#滚动箱组均值估计图形"><i class="fa fa-check"></i><b>2.5.3</b> 滚动箱组均值估计图形</a></li>
<li class="chapter" data-level="2.5.4" data-path="lab-mean-est.html"><a href="lab-mean-est.html#nw核均值估计图形"><i class="fa fa-check"></i><b>2.5.4</b> NW核均值估计图形</a></li>
<li class="chapter" data-level="2.5.5" data-path="lab-mean-est.html"><a href="lab-mean-est.html#三种方法的图形"><i class="fa fa-check"></i><b>2.5.5</b> 三种方法的图形</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="lab-mean-est.html"><a href="lab-mean-est.html#展示分析结果"><i class="fa fa-check"></i><b>2.6</b> 展示分析结果</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="lab-mean-est.html"><a href="lab-mean-est.html#箱组均值估计结果"><i class="fa fa-check"></i><b>2.6.1</b> 箱组均值估计结果</a></li>
<li class="chapter" data-level="2.6.2" data-path="lab-mean-est.html"><a href="lab-mean-est.html#滚动箱组均值估计结果"><i class="fa fa-check"></i><b>2.6.2</b> 滚动箱组均值估计结果</a></li>
<li class="chapter" data-level="2.6.3" data-path="lab-mean-est.html"><a href="lab-mean-est.html#nw核均值估计结果"><i class="fa fa-check"></i><b>2.6.3</b> NW核均值估计结果</a></li>
<li class="chapter" data-level="2.6.4" data-path="lab-mean-est.html"><a href="lab-mean-est.html#三种方法估计对比"><i class="fa fa-check"></i><b>2.6.4</b> 三种方法估计对比</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="lab-mean-est.html"><a href="lab-mean-est.html#参考文献-1"><i class="fa fa-check"></i>参考文献</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="lab-local-reg.html"><a href="lab-local-reg.html"><i class="fa fa-check"></i><b>3</b> 局部回归（模拟数据）</a>
<ul>
<li class="chapter" data-level="3.1" data-path="lab-local-reg.html"><a href="lab-local-reg.html#实验说明-1"><i class="fa fa-check"></i><b>3.1</b> 实验说明</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="lab-local-reg.html"><a href="lab-local-reg.html#实验内容-1"><i class="fa fa-check"></i><b>3.1.1</b> 实验内容</a></li>
<li class="chapter" data-level="3.1.2" data-path="lab-local-reg.html"><a href="lab-local-reg.html#材料准备-1"><i class="fa fa-check"></i><b>3.1.2</b> 材料准备</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="lab-local-reg.html"><a href="lab-local-reg.html#数据集描述-1"><i class="fa fa-check"></i><b>3.2</b> 数据集描述</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="lab-local-reg.html"><a href="lab-local-reg.html#数据呈现-1"><i class="fa fa-check"></i><b>3.2.1</b> 数据呈现</a></li>
<li class="chapter" data-level="3.2.2" data-path="lab-local-reg.html"><a href="lab-local-reg.html#数据散点图-1"><i class="fa fa-check"></i><b>3.2.2</b> 数据散点图</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="lab-local-reg.html"><a href="lab-local-reg.html#局部回归估计过程"><i class="fa fa-check"></i><b>3.3</b> 局部回归估计过程</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="lab-local-reg.html"><a href="lab-local-reg.html#基本原理"><i class="fa fa-check"></i><b>3.3.1</b> 基本原理</a></li>
<li class="chapter" data-level="3.3.2" data-path="lab-local-reg.html"><a href="lab-local-reg.html#局部回归计算"><i class="fa fa-check"></i><b>3.3.2</b> 局部回归计算</a>
<ul>
<li class="chapter" data-level="3.3.2.1" data-path="lab-local-reg.html"><a href="lab-local-reg.html#对于局部滚动回归和局部线性回归"><i class="fa fa-check"></i><b>3.3.2.1</b> 对于局部滚动回归和局部线性回归</a></li>
<li class="chapter" data-level="3.3.2.2" data-path="lab-local-reg.html"><a href="lab-local-reg.html#对于局部箱组回归"><i class="fa fa-check"></i><b>3.3.2.2</b> 对于局部箱组回归</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="lab-local-reg.html"><a href="lab-local-reg.html#整合计算结果-1"><i class="fa fa-check"></i><b>3.4</b> 整合计算结果</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="lab-local-reg.html"><a href="lab-local-reg.html#基于箱组数的结果整合n1001-1"><i class="fa fa-check"></i><b>3.4.1</b> 基于箱组数的结果整合（N=1001）</a></li>
<li class="chapter" data-level="3.4.2" data-path="lab-local-reg.html"><a href="lab-local-reg.html#匹配样本数据和箱组nn100100-1"><i class="fa fa-check"></i><b>3.4.2</b> 匹配样本数据和箱组（Nn=100100）</a></li>
<li class="chapter" data-level="3.4.3" data-path="lab-local-reg.html"><a href="lab-local-reg.html#获得不同方法下的计算表格-1"><i class="fa fa-check"></i><b>3.4.3</b> 获得不同方法下的计算表格</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="lab-local-reg.html"><a href="lab-local-reg.html#绘制分析图-1"><i class="fa fa-check"></i><b>3.5</b> 绘制分析图</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="lab-local-reg.html"><a href="lab-local-reg.html#绘制底图-1"><i class="fa fa-check"></i><b>3.5.1</b> 绘制底图</a></li>
<li class="chapter" data-level="3.5.2" data-path="lab-local-reg.html"><a href="lab-local-reg.html#箱组回归估计图形"><i class="fa fa-check"></i><b>3.5.2</b> 箱组回归估计图形</a></li>
<li class="chapter" data-level="3.5.3" data-path="lab-local-reg.html"><a href="lab-local-reg.html#滚动箱组回归估计图形"><i class="fa fa-check"></i><b>3.5.3</b> 滚动箱组回归估计图形</a></li>
<li class="chapter" data-level="3.5.4" data-path="lab-local-reg.html"><a href="lab-local-reg.html#局部线性核回归估计图形"><i class="fa fa-check"></i><b>3.5.4</b> 局部线性核回归估计图形</a></li>
<li class="chapter" data-level="3.5.5" data-path="lab-local-reg.html"><a href="lab-local-reg.html#三种方法的图形-1"><i class="fa fa-check"></i><b>3.5.5</b> 三种方法的图形</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="lab-local-reg.html"><a href="lab-local-reg.html#展示分析结果-1"><i class="fa fa-check"></i><b>3.6</b> 展示分析结果</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="lab-local-reg.html"><a href="lab-local-reg.html#箱组局部回归估计结果"><i class="fa fa-check"></i><b>3.6.1</b> 箱组局部回归估计结果</a></li>
<li class="chapter" data-level="3.6.2" data-path="lab-local-reg.html"><a href="lab-local-reg.html#滚动箱组局部回归估计结果"><i class="fa fa-check"></i><b>3.6.2</b> 滚动箱组局部回归估计结果</a></li>
<li class="chapter" data-level="3.6.3" data-path="lab-local-reg.html"><a href="lab-local-reg.html#局部线性回归估计结果"><i class="fa fa-check"></i><b>3.6.3</b> 局部线性回归估计结果</a></li>
<li class="chapter" data-level="3.6.4" data-path="lab-local-reg.html"><a href="lab-local-reg.html#三种方法估计对比-1"><i class="fa fa-check"></i><b>3.6.4</b> 三种方法估计对比</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="lab-local-reg.html"><a href="lab-local-reg.html#参考文献-2"><i class="fa fa-check"></i>参考文献</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="lab-LL-wage.html"><a href="lab-LL-wage.html"><i class="fa fa-check"></i><b>4</b> 局部线性估计及效率分析（工资案例）</a>
<ul>
<li class="chapter" data-level="4.1" data-path="lab-LL-wage.html"><a href="lab-LL-wage.html#实验说明-2"><i class="fa fa-check"></i><b>4.1</b> 实验说明</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="lab-LL-wage.html"><a href="lab-LL-wage.html#实验内容-2"><i class="fa fa-check"></i><b>4.1.1</b> 实验内容</a></li>
<li class="chapter" data-level="4.1.2" data-path="lab-LL-wage.html"><a href="lab-LL-wage.html#材料准备-2"><i class="fa fa-check"></i><b>4.1.2</b> 材料准备</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="lab-LL-wage.html"><a href="lab-LL-wage.html#案例描述"><i class="fa fa-check"></i><b>4.2</b> 案例描述</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="lab-LL-wage.html"><a href="lab-LL-wage.html#工资案例背景说明"><i class="fa fa-check"></i><b>4.2.1</b> 工资案例：背景说明</a></li>
<li class="chapter" data-level="4.2.2" data-path="lab-LL-wage.html"><a href="lab-LL-wage.html#读取案例数据"><i class="fa fa-check"></i><b>4.2.2</b> 读取案例数据</a></li>
<li class="chapter" data-level="4.2.3" data-path="lab-LL-wage.html"><a href="lab-LL-wage.html#数据呈现-2"><i class="fa fa-check"></i><b>4.2.3</b> 数据呈现</a></li>
<li class="chapter" data-level="4.2.4" data-path="lab-LL-wage.html"><a href="lab-LL-wage.html#数据散点图-2"><i class="fa fa-check"></i><b>4.2.4</b> 数据散点图</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="lab-LL-wage.html"><a href="lab-LL-wage.html#过程1cef估计的经验参考谱宽选择"><i class="fa fa-check"></i><b>4.3</b> 过程1：CEF估计的经验参考谱宽选择</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="lab-LL-wage.html"><a href="lab-LL-wage.html#r运算代码"><i class="fa fa-check"></i><b>4.3.1</b> R运算代码</a></li>
<li class="chapter" data-level="4.3.2" data-path="lab-LL-wage.html"><a href="lab-LL-wage.html#过程步骤解读"><i class="fa fa-check"></i><b>4.3.2</b> 过程步骤解读</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="lab-LL-wage.html"><a href="lab-LL-wage.html#过程2cef估计的最优交叉验证谱宽选择"><i class="fa fa-check"></i><b>4.4</b> 过程2：CEF估计的最优交叉验证谱宽选择</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="lab-LL-wage.html"><a href="lab-LL-wage.html#r运算代码-1"><i class="fa fa-check"></i><b>4.4.1</b> R运算代码</a></li>
<li class="chapter" data-level="4.4.2" data-path="lab-LL-wage.html"><a href="lab-LL-wage.html#过程步骤解读-1"><i class="fa fa-check"></i><b>4.4.2</b> 过程步骤解读</a></li>
<li class="chapter" data-level="4.4.3" data-path="lab-LL-wage.html"><a href="lab-LL-wage.html#图形展示选择结果"><i class="fa fa-check"></i><b>4.4.3</b> 图形展示选择结果</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="lab-LL-wage.html"><a href="lab-LL-wage.html#过程3基于不同谱宽选择的cef估计"><i class="fa fa-check"></i><b>4.5</b> 过程3：基于不同谱宽选择的CEF估计</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="lab-LL-wage.html"><a href="lab-LL-wage.html#r运算代码-2"><i class="fa fa-check"></i><b>4.5.1</b> R运算代码</a></li>
<li class="chapter" data-level="4.5.2" data-path="lab-LL-wage.html"><a href="lab-LL-wage.html#过程步骤解读-2"><i class="fa fa-check"></i><b>4.5.2</b> 过程步骤解读</a></li>
<li class="chapter" data-level="4.5.3" data-path="lab-LL-wage.html"><a href="lab-LL-wage.html#图形展示估计结果"><i class="fa fa-check"></i><b>4.5.3</b> 图形展示估计结果</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="lab-LL-wage.html"><a href="lab-LL-wage.html#过程4计算非参数估计的预测误差"><i class="fa fa-check"></i><b>4.6</b> 过程4：计算非参数估计的预测误差</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="lab-LL-wage.html"><a href="lab-LL-wage.html#r运算代码-3"><i class="fa fa-check"></i><b>4.6.1</b> R运算代码</a></li>
<li class="chapter" data-level="4.6.2" data-path="lab-LL-wage.html"><a href="lab-LL-wage.html#过程步骤解读-3"><i class="fa fa-check"></i><b>4.6.2</b> 过程步骤解读</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="lab-LL-wage.html"><a href="lab-LL-wage.html#过程5计算条件方差估计时的参考谱宽"><i class="fa fa-check"></i><b>4.7</b> 过程5：计算条件方差估计时的参考谱宽</a>
<ul>
<li class="chapter" data-level="4.7.1" data-path="lab-LL-wage.html"><a href="lab-LL-wage.html#r运算代码-4"><i class="fa fa-check"></i><b>4.7.1</b> R运算代码</a></li>
<li class="chapter" data-level="4.7.2" data-path="lab-LL-wage.html"><a href="lab-LL-wage.html#过程步骤解读-4"><i class="fa fa-check"></i><b>4.7.2</b> 过程步骤解读</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="lab-LL-wage.html"><a href="lab-LL-wage.html#过程6计算条件方差估计时的最优交叉验证谱宽"><i class="fa fa-check"></i><b>4.8</b> 过程6：计算条件方差估计时的最优交叉验证谱宽</a>
<ul>
<li class="chapter" data-level="4.8.1" data-path="lab-LL-wage.html"><a href="lab-LL-wage.html#r运算代码-5"><i class="fa fa-check"></i><b>4.8.1</b> R运算代码</a></li>
<li class="chapter" data-level="4.8.2" data-path="lab-LL-wage.html"><a href="lab-LL-wage.html#过程步骤解读-5"><i class="fa fa-check"></i><b>4.8.2</b> 过程步骤解读</a></li>
<li class="chapter" data-level="4.8.3" data-path="lab-LL-wage.html"><a href="lab-LL-wage.html#图形展示谱宽选择结果"><i class="fa fa-check"></i><b>4.8.3</b> 图形展示谱宽选择结果</a></li>
</ul></li>
<li class="chapter" data-level="4.9" data-path="lab-LL-wage.html"><a href="lab-LL-wage.html#过程7计算cef估计的方差和标准差"><i class="fa fa-check"></i><b>4.9</b> 过程7：计算CEF估计的方差和标准差</a>
<ul>
<li class="chapter" data-level="4.9.1" data-path="lab-LL-wage.html"><a href="lab-LL-wage.html#r运算代码-6"><i class="fa fa-check"></i><b>4.9.1</b> R运算代码</a></li>
<li class="chapter" data-level="4.9.2" data-path="lab-LL-wage.html"><a href="lab-LL-wage.html#过程步骤解读-6"><i class="fa fa-check"></i><b>4.9.2</b> 过程步骤解读</a></li>
<li class="chapter" data-level="4.9.3" data-path="lab-LL-wage.html"><a href="lab-LL-wage.html#图形展示置信带"><i class="fa fa-check"></i><b>4.9.3</b> 图形展示置信带</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="lab-LL-wage.html"><a href="lab-LL-wage.html#参考文献-3"><i class="fa fa-check"></i>参考文献</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="lab-srdd-nocovs.html"><a href="lab-srdd-nocovs.html"><i class="fa fa-check"></i><b>5</b> 无协变量的SRDD效应分析（儿童死亡率案例）</a>
<ul>
<li class="chapter" data-level="5.1" data-path="lab-srdd-nocovs.html"><a href="lab-srdd-nocovs.html#实验说明-3"><i class="fa fa-check"></i><b>5.1</b> 实验说明</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="lab-srdd-nocovs.html"><a href="lab-srdd-nocovs.html#实验内容-3"><i class="fa fa-check"></i><b>5.1.1</b> 实验内容</a></li>
<li class="chapter" data-level="5.1.2" data-path="lab-srdd-nocovs.html"><a href="lab-srdd-nocovs.html#材料准备-3"><i class="fa fa-check"></i><b>5.1.2</b> 材料准备</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="lab-srdd-nocovs.html"><a href="lab-srdd-nocovs.html#案例描述-1"><i class="fa fa-check"></i><b>5.2</b> 案例描述</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="lab-srdd-nocovs.html"><a href="lab-srdd-nocovs.html#死亡率案例背景说明"><i class="fa fa-check"></i><b>5.2.1</b> 死亡率案例：背景说明</a></li>
<li class="chapter" data-level="5.2.2" data-path="lab-srdd-nocovs.html"><a href="lab-srdd-nocovs.html#读取案例数据-1"><i class="fa fa-check"></i><b>5.2.2</b> 读取案例数据</a></li>
<li class="chapter" data-level="5.2.3" data-path="lab-srdd-nocovs.html"><a href="lab-srdd-nocovs.html#数据呈现-3"><i class="fa fa-check"></i><b>5.2.3</b> 数据呈现</a></li>
<li class="chapter" data-level="5.2.4" data-path="lab-srdd-nocovs.html"><a href="lab-srdd-nocovs.html#数据分组描述性统计"><i class="fa fa-check"></i><b>5.2.4</b> 数据分组描述性统计</a></li>
<li class="chapter" data-level="5.2.5" data-path="lab-srdd-nocovs.html"><a href="lab-srdd-nocovs.html#数据散点图-3"><i class="fa fa-check"></i><b>5.2.5</b> 数据散点图</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="lab-srdd-nocovs.html"><a href="lab-srdd-nocovs.html#过程1设定相关参数和辅助计算工具"><i class="fa fa-check"></i><b>5.3</b> 过程1：设定相关参数和辅助计算工具</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="lab-srdd-nocovs.html"><a href="lab-srdd-nocovs.html#r运算代码-7"><i class="fa fa-check"></i><b>5.3.1</b> R运算代码</a></li>
<li class="chapter" data-level="5.3.2" data-path="lab-srdd-nocovs.html"><a href="lab-srdd-nocovs.html#过程步骤解读-7"><i class="fa fa-check"></i><b>5.3.2</b> 过程步骤解读</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="lab-srdd-nocovs.html"><a href="lab-srdd-nocovs.html#过程2进行rdd估计运算r代码"><i class="fa fa-check"></i><b>5.4</b> 过程2：进行RDD估计运算（R代码）</a></li>
<li class="chapter" data-level="5.5" data-path="lab-srdd-nocovs.html"><a href="lab-srdd-nocovs.html#过程3将rdd估计结果整理成相关表格"><i class="fa fa-check"></i><b>5.5</b> 过程3：将RDD估计结果整理成相关表格</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="lab-srdd-nocovs.html"><a href="lab-srdd-nocovs.html#将断点两侧的mx估计结果整理成表格r代码"><i class="fa fa-check"></i><b>5.5.1</b> 将断点两侧的m(x)估计结果整理成表格（R代码）</a></li>
<li class="chapter" data-level="5.5.2" data-path="lab-srdd-nocovs.html"><a href="lab-srdd-nocovs.html#将最终rdd断点效应整理成表格r代码"><i class="fa fa-check"></i><b>5.5.2</b> 将最终RDD断点效应整理成表格（R代码）</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="lab-srdd-nocovs.html"><a href="lab-srdd-nocovs.html#过程4绘制rdd分析图mx估计值"><i class="fa fa-check"></i><b>5.6</b> 过程4：绘制RDD分析图（mx估计值）</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="lab-srdd-nocovs.html"><a href="lab-srdd-nocovs.html#对绘制底图r代码"><i class="fa fa-check"></i><b>5.6.1</b> 对绘制底图（R代码）</a></li>
<li class="chapter" data-level="5.6.2" data-path="lab-srdd-nocovs.html"><a href="lab-srdd-nocovs.html#对断点左边绘制mx估计图r代码"><i class="fa fa-check"></i><b>5.6.2</b> 对断点左边绘制mx估计图（R代码）</a></li>
<li class="chapter" data-level="5.6.3" data-path="lab-srdd-nocovs.html"><a href="lab-srdd-nocovs.html#对断点右边绘制mx估计图r代码"><i class="fa fa-check"></i><b>5.6.3</b> 对断点右边绘制mx估计图（R代码）</a></li>
<li class="chapter" data-level="5.6.4" data-path="lab-srdd-nocovs.html"><a href="lab-srdd-nocovs.html#同时对断点两边绘制mx估计图r代码"><i class="fa fa-check"></i><b>5.6.4</b> 同时对断点两边绘制mx估计图（R代码）</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="lab-srdd-nocovs.html"><a href="lab-srdd-nocovs.html#过程5绘制rdd置信带图"><i class="fa fa-check"></i><b>5.7</b> 过程5：绘制RDD置信带图</a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="lab-srdd-nocovs.html"><a href="lab-srdd-nocovs.html#对断点左边绘制置信带r代码"><i class="fa fa-check"></i><b>5.7.1</b> 对断点左边绘制置信带（R代码）</a></li>
<li class="chapter" data-level="5.7.2" data-path="lab-srdd-nocovs.html"><a href="lab-srdd-nocovs.html#对断点右边绘制置信带r代码"><i class="fa fa-check"></i><b>5.7.2</b> 对断点右边绘制置信带（R代码）</a></li>
<li class="chapter" data-level="5.7.3" data-path="lab-srdd-nocovs.html"><a href="lab-srdd-nocovs.html#对断点两边同时绘制置信带r代码"><i class="fa fa-check"></i><b>5.7.3</b> 对断点两边同时绘制置信带（R代码）</a></li>
<li class="chapter" data-level="5.7.4" data-path="lab-srdd-nocovs.html"><a href="lab-srdd-nocovs.html#额外辅助绘图函数r代码"><i class="fa fa-check"></i><b>5.7.4</b> 额外辅助绘图函数（R代码）</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="lab-srdd-nocovs.html"><a href="lab-srdd-nocovs.html#rdd分析的过程步骤解读"><i class="fa fa-check"></i><b>5.8</b> RDD分析的过程步骤解读</a>
<ul>
<li class="chapter" data-level="5.8.1" data-path="lab-srdd-nocovs.html"><a href="lab-srdd-nocovs.html#条件期望函数cef-mx的llr估计结果"><i class="fa fa-check"></i><b>5.8.1</b> 条件期望函数CEF m(x)的LLR估计结果</a></li>
<li class="chapter" data-level="5.8.2" data-path="lab-srdd-nocovs.html"><a href="lab-srdd-nocovs.html#条件期望函数cef-mx的方差和标准差估计结果"><i class="fa fa-check"></i><b>5.8.2</b> 条件期望函数CEF m(x)的方差和标准差估计结果</a></li>
<li class="chapter" data-level="5.8.3" data-path="lab-srdd-nocovs.html"><a href="lab-srdd-nocovs.html#条件期望函数cef-mx的置信区间和置信带"><i class="fa fa-check"></i><b>5.8.3</b> 条件期望函数CEF m(x)的置信区间和置信带</a></li>
<li class="chapter" data-level="5.8.4" data-path="lab-srdd-nocovs.html"><a href="lab-srdd-nocovs.html#rdd断点处置效应计算结果"><i class="fa fa-check"></i><b>5.8.4</b> RDD断点处置效应计算结果</a></li>
<li class="chapter" data-level="5.8.5" data-path="lab-srdd-nocovs.html"><a href="lab-srdd-nocovs.html#rdd断点处置效应的估计误差及显著性检验"><i class="fa fa-check"></i><b>5.8.5</b> RDD断点处置效应的估计误差及显著性检验</a></li>
</ul></li>
<li class="chapter" data-level="5.9" data-path="lab-srdd-nocovs.html"><a href="lab-srdd-nocovs.html#过程6等价线性回归"><i class="fa fa-check"></i><b>5.9</b> 过程6：等价线性回归</a>
<ul>
<li class="chapter" data-level="5.9.1" data-path="lab-srdd-nocovs.html"><a href="lab-srdd-nocovs.html#基本原理调整运行变量范围"><i class="fa fa-check"></i><b>5.9.1</b> 基本原理：调整运行变量范围</a></li>
<li class="chapter" data-level="5.9.2" data-path="lab-srdd-nocovs.html"><a href="lab-srdd-nocovs.html#r运算代码-8"><i class="fa fa-check"></i><b>5.9.2</b> R运算代码</a></li>
<li class="chapter" data-level="5.9.3" data-path="lab-srdd-nocovs.html"><a href="lab-srdd-nocovs.html#过程步骤解读-8"><i class="fa fa-check"></i><b>5.9.3</b> 过程步骤解读</a>
<ul>
<li class="chapter" data-level="5.9.3.1" data-path="lab-srdd-nocovs.html"><a href="lab-srdd-nocovs.html#等价线性回归调整后的数据集"><i class="fa fa-check"></i><b>5.9.3.1</b> 等价线性回归：调整后的数据集</a></li>
<li class="chapter" data-level="5.9.3.2" data-path="lab-srdd-nocovs.html"><a href="lab-srdd-nocovs.html#等价线性回归分组描述性统计"><i class="fa fa-check"></i><b>5.9.3.2</b> 等价线性回归：分组描述性统计</a></li>
<li class="chapter" data-level="5.9.3.3" data-path="lab-srdd-nocovs.html"><a href="lab-srdd-nocovs.html#等价线性回归ols估计结果"><i class="fa fa-check"></i><b>5.9.3.3</b> 等价线性回归：OLS估计结果</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="lab-srdd-nocovs.html"><a href="lab-srdd-nocovs.html#参考文献-4"><i class="fa fa-check"></i>参考文献</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="lab-srdd-withcovs.html"><a href="lab-srdd-withcovs.html"><i class="fa fa-check"></i><b>6</b> 引入协变量的RDD效应分析（儿童死亡率案例）</a>
<ul>
<li class="chapter" data-level="6.1" data-path="lab-srdd-withcovs.html"><a href="lab-srdd-withcovs.html#实验说明-4"><i class="fa fa-check"></i><b>6.1</b> 实验说明</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="lab-srdd-withcovs.html"><a href="lab-srdd-withcovs.html#实验内容-4"><i class="fa fa-check"></i><b>6.1.1</b> 实验内容</a></li>
<li class="chapter" data-level="6.1.2" data-path="lab-srdd-withcovs.html"><a href="lab-srdd-withcovs.html#材料准备-4"><i class="fa fa-check"></i><b>6.1.2</b> 材料准备</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="lab-srdd-withcovs.html"><a href="lab-srdd-withcovs.html#案例描述-2"><i class="fa fa-check"></i><b>6.2</b> 案例描述</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="lab-srdd-withcovs.html"><a href="lab-srdd-withcovs.html#死亡率案例续背景说明"><i class="fa fa-check"></i><b>6.2.1</b> 死亡率案例（续）：背景说明</a></li>
<li class="chapter" data-level="6.2.2" data-path="lab-srdd-withcovs.html"><a href="lab-srdd-withcovs.html#读取案例数据-2"><i class="fa fa-check"></i><b>6.2.2</b> 读取案例数据</a></li>
<li class="chapter" data-level="6.2.3" data-path="lab-srdd-withcovs.html"><a href="lab-srdd-withcovs.html#数据呈现-4"><i class="fa fa-check"></i><b>6.2.3</b> 数据呈现</a></li>
<li class="chapter" data-level="6.2.4" data-path="lab-srdd-withcovs.html"><a href="lab-srdd-withcovs.html#数据分组描述性统计-1"><i class="fa fa-check"></i><b>6.2.4</b> 数据分组描述性统计</a></li>
<li class="chapter" data-level="6.2.5" data-path="lab-srdd-withcovs.html"><a href="lab-srdd-withcovs.html#数据散点图-4"><i class="fa fa-check"></i><b>6.2.5</b> 数据散点图</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="lab-srdd-withcovs.html"><a href="lab-srdd-withcovs.html#过程0设定相关参数和辅助计算工具"><i class="fa fa-check"></i><b>6.3</b> 过程0：设定相关参数和辅助计算工具</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="lab-srdd-withcovs.html"><a href="lab-srdd-withcovs.html#r运算代码-9"><i class="fa fa-check"></i><b>6.3.1</b> R运算代码</a></li>
<li class="chapter" data-level="6.3.2" data-path="lab-srdd-withcovs.html"><a href="lab-srdd-withcovs.html#过程步骤解读协变量rdd分析的规则策略"><i class="fa fa-check"></i><b>6.3.2</b> 过程步骤解读：协变量RDD分析的规则策略</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="lab-srdd-withcovs.html"><a href="lab-srdd-withcovs.html#过程2协变量srdd估计"><i class="fa fa-check"></i><b>6.4</b> 过程2：协变量SRDD估计</a></li>
<li class="chapter" data-level="6.5" data-path="lab-srdd-withcovs.html"><a href="lab-srdd-withcovs.html#过程3将rdd估计结果整理成相关表格-1"><i class="fa fa-check"></i><b>6.5</b> 过程3：将RDD估计结果整理成相关表格</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="lab-srdd-withcovs.html"><a href="lab-srdd-withcovs.html#将断点两侧的mx估计结果整理成表格r代码-1"><i class="fa fa-check"></i><b>6.5.1</b> 将断点两侧的m(x)估计结果整理成表格（R代码）</a></li>
<li class="chapter" data-level="6.5.2" data-path="lab-srdd-withcovs.html"><a href="lab-srdd-withcovs.html#将rdd预测误差整理成表格r代码"><i class="fa fa-check"></i><b>6.5.2</b> 将RDD预测误差整理成表格（R代码）</a></li>
<li class="chapter" data-level="6.5.3" data-path="lab-srdd-withcovs.html"><a href="lab-srdd-withcovs.html#将最终rdd断点效应整理成表格r代码-1"><i class="fa fa-check"></i><b>6.5.3</b> 将最终RDD断点效应整理成表格（R代码）</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="lab-srdd-withcovs.html"><a href="lab-srdd-withcovs.html#过程4绘制rdd分析图mx估计值-1"><i class="fa fa-check"></i><b>6.6</b> 过程4：绘制RDD分析图（mx估计值）</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="lab-srdd-withcovs.html"><a href="lab-srdd-withcovs.html#对绘制底图r代码-1"><i class="fa fa-check"></i><b>6.6.1</b> 对绘制底图（R代码）</a></li>
<li class="chapter" data-level="6.6.2" data-path="lab-srdd-withcovs.html"><a href="lab-srdd-withcovs.html#对断点左边绘制mx估计图r代码-1"><i class="fa fa-check"></i><b>6.6.2</b> 对断点左边绘制mx估计图（R代码）</a></li>
<li class="chapter" data-level="6.6.3" data-path="lab-srdd-withcovs.html"><a href="lab-srdd-withcovs.html#对断点右边绘制mx估计图r代码-1"><i class="fa fa-check"></i><b>6.6.3</b> 对断点右边绘制mx估计图（R代码）</a></li>
<li class="chapter" data-level="6.6.4" data-path="lab-srdd-withcovs.html"><a href="lab-srdd-withcovs.html#同时对断点两边绘制mx估计图r代码-1"><i class="fa fa-check"></i><b>6.6.4</b> 同时对断点两边绘制mx估计图（R代码）</a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="lab-srdd-withcovs.html"><a href="lab-srdd-withcovs.html#过程5绘制rdd置信带图-1"><i class="fa fa-check"></i><b>6.7</b> 过程5：绘制RDD置信带图</a>
<ul>
<li class="chapter" data-level="6.7.1" data-path="lab-srdd-withcovs.html"><a href="lab-srdd-withcovs.html#对断点左边绘制置信带r代码-1"><i class="fa fa-check"></i><b>6.7.1</b> 对断点左边绘制置信带（R代码）</a></li>
<li class="chapter" data-level="6.7.2" data-path="lab-srdd-withcovs.html"><a href="lab-srdd-withcovs.html#对断点右边绘制置信带r代码-1"><i class="fa fa-check"></i><b>6.7.2</b> 对断点右边绘制置信带（R代码）</a></li>
<li class="chapter" data-level="6.7.3" data-path="lab-srdd-withcovs.html"><a href="lab-srdd-withcovs.html#对断点两边同时绘制置信带r代码-1"><i class="fa fa-check"></i><b>6.7.3</b> 对断点两边同时绘制置信带（R代码）</a></li>
</ul></li>
<li class="chapter" data-level="6.8" data-path="lab-srdd-withcovs.html"><a href="lab-srdd-withcovs.html#协变量rdd分析的过程步骤解读"><i class="fa fa-check"></i><b>6.8</b> 协变量RDD分析的过程步骤解读</a>
<ul>
<li class="chapter" data-level="6.8.1" data-path="lab-srdd-withcovs.html"><a href="lab-srdd-withcovs.html#第1阶段llr估计残差"><i class="fa fa-check"></i><b>6.8.1</b> 第1阶段LLR估计残差</a></li>
<li class="chapter" data-level="6.8.2" data-path="lab-srdd-withcovs.html"><a href="lab-srdd-withcovs.html#第2阶段llr估计残差"><i class="fa fa-check"></i><b>6.8.2</b> 第2阶段LLR估计残差</a></li>
<li class="chapter" data-level="6.8.3" data-path="lab-srdd-withcovs.html"><a href="lab-srdd-withcovs.html#第3阶段ols估计模型"><i class="fa fa-check"></i><b>6.8.3</b> 第3阶段OLS估计(模型)</a></li>
<li class="chapter" data-level="6.8.4" data-path="lab-srdd-withcovs.html"><a href="lab-srdd-withcovs.html#第3阶段ols估计结果"><i class="fa fa-check"></i><b>6.8.4</b> 第3阶段OLS估计（结果）</a></li>
<li class="chapter" data-level="6.8.5" data-path="lab-srdd-withcovs.html"><a href="lab-srdd-withcovs.html#第4阶段构造残差"><i class="fa fa-check"></i><b>6.8.5</b> 第4阶段构造残差</a></li>
<li class="chapter" data-level="6.8.6" data-path="lab-srdd-withcovs.html"><a href="lab-srdd-withcovs.html#条件期望函数cef-mx的llr估计结果-1"><i class="fa fa-check"></i><b>6.8.6</b> 条件期望函数CEF m(x)的LLR估计结果</a></li>
<li class="chapter" data-level="6.8.7" data-path="lab-srdd-withcovs.html"><a href="lab-srdd-withcovs.html#条件期望函数cef-mx的标准差和置信区间"><i class="fa fa-check"></i><b>6.8.7</b> 条件期望函数CEF m(x)的标准差和置信区间</a></li>
<li class="chapter" data-level="6.8.8" data-path="lab-srdd-withcovs.html"><a href="lab-srdd-withcovs.html#rdd断点处置效应计算结果-1"><i class="fa fa-check"></i><b>6.8.8</b> RDD断点处置效应计算结果</a></li>
<li class="chapter" data-level="6.8.9" data-path="lab-srdd-withcovs.html"><a href="lab-srdd-withcovs.html#rdd断点处置效应的估计误差及显著性检验-1"><i class="fa fa-check"></i><b>6.8.9</b> RDD断点处置效应的估计误差及显著性检验</a></li>
</ul></li>
<li class="chapter" data-level="6.9" data-path="lab-srdd-withcovs.html"><a href="lab-srdd-withcovs.html#过程6无协变量srdd和有协变量srdd的比较"><i class="fa fa-check"></i><b>6.9</b> 过程6：无协变量SRDD和有协变量SRDD的比较</a>
<ul>
<li class="chapter" data-level="6.9.1" data-path="lab-srdd-withcovs.html"><a href="lab-srdd-withcovs.html#r运算代码-10"><i class="fa fa-check"></i><b>6.9.1</b> R运算代码</a></li>
<li class="chapter" data-level="6.9.2" data-path="lab-srdd-withcovs.html"><a href="lab-srdd-withcovs.html#过程步骤解读1系数和标准误比较"><i class="fa fa-check"></i><b>6.9.2</b> 过程步骤解读1：系数和标准误比较</a></li>
<li class="chapter" data-level="6.9.3" data-path="lab-srdd-withcovs.html"><a href="lab-srdd-withcovs.html#过程步骤解读2cef估计值图形比较"><i class="fa fa-check"></i><b>6.9.3</b> 过程步骤解读2：CEF估计值图形比较</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="lab-srdd-withcovs.html"><a href="lab-srdd-withcovs.html#参考文献-5"><i class="fa fa-check"></i>参考文献</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="appendix.html"><a href="appendix.html"><i class="fa fa-check"></i><b>7</b> 附录</a>
<ul>
<li class="chapter" data-level="7.1" data-path="appendix.html"><a href="appendix.html#command-stata"><i class="fa fa-check"></i><b>7.1</b> 常用stata命令</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="appendix.html"><a href="appendix.html#数列操作"><i class="fa fa-check"></i><b>7.1.1</b> 数列操作</a></li>
<li class="chapter" data-level="7.1.2" data-path="appendix.html"><a href="appendix.html#时期操作"><i class="fa fa-check"></i><b>7.1.2</b> 时期操作</a></li>
<li class="chapter" data-level="7.1.3" data-path="appendix.html"><a href="appendix.html#条件下回归"><i class="fa fa-check"></i><b>7.1.3</b> 条件下回归</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a 本书版权所有@胡华平</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">高级计量暑期研讨</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="lab-LL-wage" class="section level1" number="4">
<h1><span class="header-section-number">Lab 4</span> 局部线性估计及效率分析（工资案例）</h1>
<div id="实验说明-2" class="section level2" number="4.1">
<h2><span class="header-section-number">4.1</span> 实验说明</h2>
<div id="实验内容-2" class="section level3" number="4.1.1">
<h3><span class="header-section-number">4.1.1</span> 实验内容</h3>
<p><strong>实验目标</strong>：非参数局部线性回归估计及其效率分析，复现<strong>工资案例</strong>（包括<strong>Figure 19.5</strong>和<strong>Figure 19.6</strong>的全部过程及结果（参看：HANSEN B. Econometrics[M].2021（作者手稿）. 第19章 Nonparametric Regression. ）</p>
<p>主要内容包括：</p>
<ul>
<li><p>局部线性回归方法（LLR）下，估计CEF<span class="math inline">\(\widehat{m}(x)\)</span>的最优谱宽<span class="math inline">\(h\)</span>选择（经验法和交叉验证法）</p></li>
<li><p>局部线性回归方法（LLR）下，估计方差最优谱宽的选择</p></li>
<li><p>局部线性回归方法（LLR）的估计偏误、估计方差和标准差</p></li>
<li><p>局部线性回归估计（LLR）的显著性检验（置信区间）</p></li>
</ul>
</div>
<div id="材料准备-2" class="section level3" number="4.1.2">
<h3><span class="header-section-number">4.1.2</span> 材料准备</h3>
<ul>
<li><p>软件环境：编译器为<code>Rstudio</code>（要求<code>R 4.1</code>及以上版本）</p></li>
<li><p>R代码文件：工作项目（R project）根目录下<code>Rscript/</code>文件夹内</p></li>
</ul>
<div class="sourceCode" id="cb55"><pre class="sourceCode numberSource r foldable numberLines"><code class="sourceCode r"><span id="cb55-1"><a href="lab-LL-wage.html#cb55-1"></a><span class="co"># don&#39;t run here ! </span></span>
<span id="cb55-2"><a href="lab-LL-wage.html#cb55-2"></a><span class="co"># only show you the code file path!</span></span>
<span id="cb55-3"><a href="lab-LL-wage.html#cb55-3"></a><span class="fu">source</span>(<span class="fu">here</span>(<span class="st">&quot;Rscript/hensen21-fig19-5.R&quot;</span>), <span class="at">encoding =</span> <span class="st">&quot;UTF-8&quot;</span>)</span>
<span id="cb55-4"><a href="lab-LL-wage.html#cb55-4"></a><span class="fu">source</span>(<span class="fu">here</span>(<span class="st">&quot;Rscript/hensen21-fig19-5.R&quot;</span>), <span class="at">encoding =</span> <span class="st">&quot;UTF-8&quot;</span>)</span></code></pre></div>
</div>
</div>
<div id="案例描述" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> 案例描述</h2>
<div id="工资案例背景说明" class="section level3" number="4.2.1">
<h3><span class="header-section-number">4.2.1</span> 工资案例：背景说明</h3>
<ul>
<li><p>案例基于CPS数据集，重点分析其中的<strong>子样本数据</strong>（黑人、男性、拥有12年受教育程度——高中毕业），样本数为n=100。</p></li>
<li><p>关注的问题：<strong>时均工资</strong>的对数（<code>Y =log(wage)</code>）对<strong>职业经历</strong>（<code>X=experience</code>）的非参数回归估计。</p></li>
<li><p>后面的分析中，我们会重点划定观测窗口为：职业经历（年数）范围为
<span class="math inline">\([0,40]\)</span>。因为样本中90%以上的观测对象都落在这个范围之内。</p></li>
</ul>
</div>
<div id="读取案例数据" class="section level3" number="4.2.2">
<h3><span class="header-section-number">4.2.2</span> 读取案例数据</h3>
<div class="sourceCode" id="cb56"><pre class="sourceCode numberSource r foldable numberLines"><code class="sourceCode r"><span id="cb56-1"><a href="lab-LL-wage.html#cb56-1"></a><span class="do">##  This file generates Figures 19.5 and 19.6</span></span>
<span id="cb56-2"><a href="lab-LL-wage.html#cb56-2"></a><span class="do">##  Wage/Experience</span></span>
<span id="cb56-3"><a href="lab-LL-wage.html#cb56-3"></a></span>
<span id="cb56-4"><a href="lab-LL-wage.html#cb56-4"></a><span class="do">#### attention 1/2 ####</span></span>
<span id="cb56-5"><a href="lab-LL-wage.html#cb56-5"></a><span class="do">## this is the part 1/2 R script of the whole analysis</span></span>
<span id="cb56-6"><a href="lab-LL-wage.html#cb56-6"></a><span class="do">## so you will run `hensen21-fig19-6.R` forthcoming </span></span>
<span id="cb56-7"><a href="lab-LL-wage.html#cb56-7"></a></span>
<span id="cb56-8"><a href="lab-LL-wage.html#cb56-8"></a><span class="co"># Uses data file cps09mar.dta</span></span>
<span id="cb56-9"><a href="lab-LL-wage.html#cb56-9"></a></span>
<span id="cb56-10"><a href="lab-LL-wage.html#cb56-10"></a>dt_file <span class="ot">&lt;-</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;data/cps09mar.dta&quot;</span>)</span>
<span id="cb56-11"><a href="lab-LL-wage.html#cb56-11"></a>dat <span class="ot">&lt;-</span> haven<span class="sc">::</span><span class="fu">read_dta</span>(dt_file)</span>
<span id="cb56-12"><a href="lab-LL-wage.html#cb56-12"></a></span>
<span id="cb56-13"><a href="lab-LL-wage.html#cb56-13"></a><span class="co"># data set 1</span></span>
<span id="cb56-14"><a href="lab-LL-wage.html#cb56-14"></a><span class="co"># sub-sample of black men with 12 years of education</span></span>
<span id="cb56-15"><a href="lab-LL-wage.html#cb56-15"></a>bf <span class="ot">&lt;-</span> (dat[,<span class="dv">11</span>]<span class="sc">==</span><span class="dv">2</span>)<span class="sc">&amp;</span>(dat[,<span class="dv">2</span>]<span class="sc">==</span><span class="dv">1</span>)<span class="sc">&amp;</span>(dat[,<span class="dv">4</span>]<span class="sc">==</span><span class="dv">12</span>)</span>
<span id="cb56-16"><a href="lab-LL-wage.html#cb56-16"></a>dat1 <span class="ot">&lt;-</span> dat[bf,]</span>
<span id="cb56-17"><a href="lab-LL-wage.html#cb56-17"></a><span class="do">## earning per hours</span></span>
<span id="cb56-18"><a href="lab-LL-wage.html#cb56-18"></a>y <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">log</span>(dat1[,<span class="dv">5</span>]<span class="sc">/</span>(dat1[,<span class="dv">6</span>]<span class="sc">*</span>dat1[,<span class="dv">7</span>])))</span>
<span id="cb56-19"><a href="lab-LL-wage.html#cb56-19"></a>x <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(dat1[,<span class="dv">1</span>]<span class="sc">-</span>dat1[,<span class="dv">4</span>]<span class="sc">-</span><span class="dv">6</span>)</span>
<span id="cb56-20"><a href="lab-LL-wage.html#cb56-20"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(y)</span>
<span id="cb56-21"><a href="lab-LL-wage.html#cb56-21"></a></span>
<span id="cb56-22"><a href="lab-LL-wage.html#cb56-22"></a>dt_cps1 <span class="ot">&lt;-</span>  <span class="fu">tibble</span>(<span class="at">X=</span>x, <span class="at">Y=</span>y)</span></code></pre></div>
</div>
<div id="数据呈现-2" class="section level3" number="4.2.3">
<h3><span class="header-section-number">4.2.3</span> 数据呈现</h3>
<div class="sourceCode" id="cb57"><pre class="sourceCode numberSource r foldable numberLines"><code class="sourceCode r"><span id="cb57-1"><a href="lab-LL-wage.html#cb57-1"></a>dt_cps1 <span class="sc">%&gt;%</span></span>
<span id="cb57-2"><a href="lab-LL-wage.html#cb57-2"></a>  <span class="fu">add_column</span>(<span class="at">obs =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(.), <span class="at">.before =</span> <span class="st">&quot;X&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb57-3"><a href="lab-LL-wage.html#cb57-3"></a>  DT<span class="sc">::</span><span class="fu">datatable</span>(</span>
<span id="cb57-4"><a href="lab-LL-wage.html#cb57-4"></a>    <span class="at">caption =</span> <span class="fu">paste0</span>(<span class="st">&quot;CPS数据集(n=&quot;</span>,n,<span class="st">&quot;)&quot;</span>),</span>
<span id="cb57-5"><a href="lab-LL-wage.html#cb57-5"></a>    <span class="at">options =</span> <span class="fu">list</span>(<span class="at">dom =</span> <span class="st">&quot;tip&quot;</span>, <span class="at">pageLength =</span><span class="dv">8</span>))<span class="sc">%&gt;%</span></span>
<span id="cb57-6"><a href="lab-LL-wage.html#cb57-6"></a>  <span class="fu">formatRound</span>(<span class="fu">c</span>(<span class="dv">3</span>), <span class="at">digits =</span> <span class="dv">4</span>)</span></code></pre></div>
<div id="htmlwidget-ba23f54db24fbe9645d9" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-ba23f54db24fbe9645d9">{"x":{"filter":"none","caption":"<caption>CPS数据集(n=762)<\/caption>","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153","154","155","156","157","158","159","160","161","162","163","164","165","166","167","168","169","170","171","172","173","174","175","176","177","178","179","180","181","182","183","184","185","186","187","188","189","190","191","192","193","194","195","196","197","198","199","200","201","202","203","204","205","206","207","208","209","210","211","212","213","214","215","216","217","218","219","220","221","222","223","224","225","226","227","228","229","230","231","232","233","234","235","236","237","238","239","240","241","242","243","244","245","246","247","248","249","250","251","252","253","254","255","256","257","258","259","260","261","262","263","264","265","266","267","268","269","270","271","272","273","274","275","276","277","278","279","280","281","282","283","284","285","286","287","288","289","290","291","292","293","294","295","296","297","298","299","300","301","302","303","304","305","306","307","308","309","310","311","312","313","314","315","316","317","318","319","320","321","322","323","324","325","326","327","328","329","330","331","332","333","334","335","336","337","338","339","340","341","342","343","344","345","346","347","348","349","350","351","352","353","354","355","356","357","358","359","360","361","362","363","364","365","366","367","368","369","370","371","372","373","374","375","376","377","378","379","380","381","382","383","384","385","386","387","388","389","390","391","392","393","394","395","396","397","398","399","400","401","402","403","404","405","406","407","408","409","410","411","412","413","414","415","416","417","418","419","420","421","422","423","424","425","426","427","428","429","430","431","432","433","434","435","436","437","438","439","440","441","442","443","444","445","446","447","448","449","450","451","452","453","454","455","456","457","458","459","460","461","462","463","464","465","466","467","468","469","470","471","472","473","474","475","476","477","478","479","480","481","482","483","484","485","486","487","488","489","490","491","492","493","494","495","496","497","498","499","500","501","502","503","504","505","506","507","508","509","510","511","512","513","514","515","516","517","518","519","520","521","522","523","524","525","526","527","528","529","530","531","532","533","534","535","536","537","538","539","540","541","542","543","544","545","546","547","548","549","550","551","552","553","554","555","556","557","558","559","560","561","562","563","564","565","566","567","568","569","570","571","572","573","574","575","576","577","578","579","580","581","582","583","584","585","586","587","588","589","590","591","592","593","594","595","596","597","598","599","600","601","602","603","604","605","606","607","608","609","610","611","612","613","614","615","616","617","618","619","620","621","622","623","624","625","626","627","628","629","630","631","632","633","634","635","636","637","638","639","640","641","642","643","644","645","646","647","648","649","650","651","652","653","654","655","656","657","658","659","660","661","662","663","664","665","666","667","668","669","670","671","672","673","674","675","676","677","678","679","680","681","682","683","684","685","686","687","688","689","690","691","692","693","694","695","696","697","698","699","700","701","702","703","704","705","706","707","708","709","710","711","712","713","714","715","716","717","718","719","720","721","722","723","724","725","726","727","728","729","730","731","732","733","734","735","736","737","738","739","740","741","742","743","744","745","746","747","748","749","750","751","752","753","754","755","756","757","758","759","760","761","762"],[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,272,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,288,289,290,291,292,293,294,295,296,297,298,299,300,301,302,303,304,305,306,307,308,309,310,311,312,313,314,315,316,317,318,319,320,321,322,323,324,325,326,327,328,329,330,331,332,333,334,335,336,337,338,339,340,341,342,343,344,345,346,347,348,349,350,351,352,353,354,355,356,357,358,359,360,361,362,363,364,365,366,367,368,369,370,371,372,373,374,375,376,377,378,379,380,381,382,383,384,385,386,387,388,389,390,391,392,393,394,395,396,397,398,399,400,401,402,403,404,405,406,407,408,409,410,411,412,413,414,415,416,417,418,419,420,421,422,423,424,425,426,427,428,429,430,431,432,433,434,435,436,437,438,439,440,441,442,443,444,445,446,447,448,449,450,451,452,453,454,455,456,457,458,459,460,461,462,463,464,465,466,467,468,469,470,471,472,473,474,475,476,477,478,479,480,481,482,483,484,485,486,487,488,489,490,491,492,493,494,495,496,497,498,499,500,501,502,503,504,505,506,507,508,509,510,511,512,513,514,515,516,517,518,519,520,521,522,523,524,525,526,527,528,529,530,531,532,533,534,535,536,537,538,539,540,541,542,543,544,545,546,547,548,549,550,551,552,553,554,555,556,557,558,559,560,561,562,563,564,565,566,567,568,569,570,571,572,573,574,575,576,577,578,579,580,581,582,583,584,585,586,587,588,589,590,591,592,593,594,595,596,597,598,599,600,601,602,603,604,605,606,607,608,609,610,611,612,613,614,615,616,617,618,619,620,621,622,623,624,625,626,627,628,629,630,631,632,633,634,635,636,637,638,639,640,641,642,643,644,645,646,647,648,649,650,651,652,653,654,655,656,657,658,659,660,661,662,663,664,665,666,667,668,669,670,671,672,673,674,675,676,677,678,679,680,681,682,683,684,685,686,687,688,689,690,691,692,693,694,695,696,697,698,699,700,701,702,703,704,705,706,707,708,709,710,711,712,713,714,715,716,717,718,719,720,721,722,723,724,725,726,727,728,729,730,731,732,733,734,735,736,737,738,739,740,741,742,743,744,745,746,747,748,749,750,751,752,753,754,755,756,757,758,759,760,761,762],[[18],[-2],[30],[30],[18],[28],[14],[22],[30],[29],[19],[2],[44],[36],[42],[47],[25],[49],[33],[9],[14],[35],[36],[30],[19],[4],[29],[6],[6],[5],[4],[12],[25],[40],[46],[20],[12],[44],[30],[37],[25],[49],[30],[31],[20],[29],[40],[33],[17],[42],[33],[19],[32],[19],[22],[23],[31],[32],[17],[36],[31],[11],[37],[31],[32],[49],[28],[36],[31],[42],[32],[21],[30],[15],[37],[28],[53],[19],[26],[16],[20],[25],[19],[40],[24],[23],[11],[2],[40],[15],[23],[23],[25],[32],[7],[6],[37],[36],[35],[31],[28],[35],[30],[35],[43],[28],[13],[36],[43],[44],[28],[43],[42],[31],[34],[38],[2],[27],[36],[28],[9],[31],[23],[32],[31],[21],[17],[28],[33],[37],[29],[38],[20],[15],[24],[37],[42],[23],[30],[15],[39],[29],[50],[27],[30],[44],[37],[59],[18],[27],[14],[28],[25],[37],[19],[12],[21],[21],[32],[11],[33],[19],[31],[30],[29],[25],[32],[26],[21],[34],[13],[9],[44],[28],[19],[28],[45],[42],[18],[6],[12],[26],[38],[33],[26],[36],[7],[29],[16],[15],[23],[41],[28],[35],[29],[10],[28],[32],[29],[8],[21],[10],[11],[6],[15],[37],[15],[4],[31],[36],[8],[22],[30],[35],[19],[4],[26],[40],[18],[22],[7],[19],[31],[16],[40],[10],[20],[23],[12],[14],[23],[38],[36],[36],[37],[14],[22],[24],[18],[29],[33],[6],[11],[23],[48],[13],[38],[32],[11],[22],[38],[32],[44],[48],[25],[25],[26],[38],[6],[5],[25],[41],[41],[22],[26],[11],[29],[27],[53],[38],[31],[5],[36],[3],[23],[5],[24],[22],[14],[42],[24],[43],[22],[15],[38],[7],[13],[16],[28],[5],[35],[22],[17],[29],[33],[8],[23],[36],[22],[6],[10],[32],[19],[29],[29],[27],[6],[28],[28],[14],[36],[24],[23],[40],[13],[20],[7],[31],[2],[44],[44],[38],[14],[19],[35],[32],[36],[41],[20],[14],[6],[26],[34],[32],[26],[16],[23],[19],[16],[37],[39],[31],[42],[13],[34],[36],[44],[41],[35],[5],[9],[32],[28],[6],[20],[22],[5],[7],[4],[45],[25],[16],[12],[17],[47],[20],[10],[32],[11],[26],[11],[22],[12],[33],[24],[24],[37],[31],[24],[20],[26],[22],[28],[29],[34],[19],[36],[21],[34],[33],[32],[25],[42],[31],[11],[19],[32],[29],[13],[28],[32],[30],[27],[28],[17],[37],[25],[29],[21],[24],[23],[21],[18],[31],[22],[20],[17],[12],[52],[33],[38],[35],[19],[35],[30],[22],[20],[36],[17],[11],[7],[44],[20],[39],[36],[25],[41],[25],[7],[24],[6],[41],[41],[29],[7],[39],[23],[39],[36],[22],[36],[10],[35],[10],[28],[34],[41],[43],[27],[26],[34],[9],[20],[15],[13],[30],[25],[9],[26],[29],[36],[21],[6],[26],[18],[39],[27],[2],[31],[36],[22],[42],[3],[25],[8],[8],[4],[34],[23],[25],[33],[11],[26],[4],[30],[27],[13],[7],[43],[3],[12],[8],[7],[9],[16],[6],[26],[26],[34],[29],[27],[26],[21],[21],[27],[43],[25],[4],[36],[15],[31],[24],[6],[12],[35],[13],[22],[17],[31],[36],[22],[38],[20],[9],[32],[19],[19],[20],[19],[38],[26],[14],[40],[39],[7],[3],[57],[30],[31],[31],[38],[4],[34],[29],[13],[48],[20],[7],[15],[23],[38],[39],[33],[35],[24],[32],[42],[23],[46],[41],[3],[14],[15],[19],[13],[20],[26],[8],[20],[12],[38],[16],[13],[12],[25],[41],[12],[11],[32],[22],[31],[29],[17],[34],[24],[40],[35],[3],[41],[34],[35],[28],[28],[35],[15],[33],[16],[37],[22],[29],[16],[29],[21],[14],[18],[27],[41],[8],[16],[2],[16],[37],[21],[31],[39],[7],[16],[14],[21],[42],[28],[10],[19],[33],[21],[13],[11],[24],[34],[10],[36],[6],[11],[47],[42],[26],[15],[13],[41],[46],[25],[48],[15],[10],[29],[31],[29],[12],[24],[35],[41],[2],[25],[10],[8],[36],[17],[40],[31],[25],[39],[26],[10],[11],[13],[26],[26],[15],[24],[20],[9],[11],[12],[17],[12],[22],[35],[41],[19],[7],[2],[1],[12],[35],[7],[17],[34],[38],[11],[8],[9],[12],[10],[27],[31],[36],[21],[29],[15],[41],[20],[23],[43],[22],[36],[26],[38],[13],[31],[29],[38],[20],[18],[47],[15],[35],[14],[28],[12],[17],[23],[30],[31],[23],[20],[10],[62],[49],[21],[9],[18],[25],[33],[35],[43],[20],[17],[17],[20],[22],[15],[17],[11],[4],[18],[12],[8],[10],[29],[36],[38],[9]],[[2.71761965211836],[1.75253875607477],[2.79399263090294],[2.79399263090294],[2.35867455964509],[2.59983661646198],[2.95651156040071],[3.00530172457014],[1.97568230738898],[2.51769647261099],[2.63492793627325],[2.15800386418294],[1.75253875607477],[3.05182174020503],[2.85115104474288],[2.00313117638223],[2.82298016777619],[2.95651156040071],[2.66882948794893],[2.10084545034299],[3.5983654465731],[3.36197666850887],[2.26336437984076],[3.29298379702192],[3.23161485064563],[1.97568230738898],[1.97568230738898],[2.5634689722911],[2.484906649788],[2.30258509299405],[2.04022082852655],[1.95798273028958],[1.90668943590203],[2.21207108545321],[2.981829368385],[2.35867455964509],[1.6412346865161],[3.17965511171492],[1.90668943590203],[2.82298016777619],[3.00915529388613],[2.48650793115497],[2.40312632221592],[2.30258509299405],[2.95651156040071],[2.59983661646198],[2.82298016777619],[2.59983661646198],[2.59472151579521],[3.17965511171492],[2.30258509299405],[2.9291125862126],[0.941608539858445],[3.23792401983889],[1.90668943590203],[1.96325978739043],[2.79399263090294],[2.95651156040071],[3.36197666850887],[2.21457421567133],[2.82298016777619],[2.66882948794893],[2.85115104474288],[1.57021719928082],[2.14558134418438],[0.575964925936952],[2.26336437984076],[1.75253875607477],[2.82298016777619],[2.85115104474288],[2.99733355492096],[2.59983661646198],[2.90521826601316],[2.34132592131048],[2.66882948794893],[3.8647701205776],[2.59983661646198],[2.82298016777619],[2.48650793115497],[2.6862212306608],[3.00530172457014],[2.40312632221592],[2.40312632221592],[2.35867455964509],[2.74441784527308],[3.22844527588435],[2.5634689722911],[2.02974952865926],[2.11021320034659],[2.76413966775325],[2.66882948794893],[3.36197666850887],[2.36872489549859],[2.40312632221592],[2.26336437984076],[2.44568593663472],[3.39476649133186],[2.20206385397697],[2.26336437984076],[3.64965874096066],[2.79399263090294],[1.1339804325059],[2.52572864430826],[2.82298016777619],[3.34516955019249],[2.40312632221592],[2.40312632221592],[2.66882948794893],[2.7333680090865],[2.47100374461901],[2.35867455964509],[0.972743768789156],[2.59990804248251],[2.82298016777619],[2.90521826601316],[1.75253875607477],[2.26336437984076],[2.45336471256172],[3.36197666850887],[2.03395121551296],[2.16805420003644],[3.41076683267831],[2.30110470782361],[2.63492793627325],[2.40312632221592],[2.59472151579521],[2.44568593663472],[2.48205358080559],[3.00530172457014],[2.63492793627325],[2.82298016777619],[2.66882948794893],[2.29003262692293],[2.40312632221592],[2.33268312415133],[2.44568593663472],[2.3121545440102],[2.70805020110221],[2.78863068776155],[2.50631055845115],[3.51612734833613],[2.42036812865043],[2.65202236963255],[2.48650793115497],[1.97568230738898],[2.44568593663472],[3.36197666850887],[3.17965511171492],[2.42036812865043],[2.82298016777619],[2.52572864430826],[2.37943655109352],[2.91829034758051],[2.70805020110221],[2.48205358080559],[2.42463252743689],[2.74887219562247],[2.26336437984076],[2.20929715857049],[2.26336437984076],[3.25661615285105],[1.34707364796661],[1.57021719928082],[2.18332167216723],[2.76413966775325],[2.15800386418294],[2.04022082852655],[3.27496529151924],[3.12356564506388],[3.19442549061837],[2.26336437984076],[2.40312632221592],[2.44568593663472],[2.90521826601316],[1.75253875607477],[2.35867455964509],[2.15800386418294],[2.22414366668748],[2.38114741549715],[2.00100011537327],[2.25835183801722],[3.51612734833613],[2.48650793115497],[3.17965511171492],[2.16839414224954],[2.7333680090865],[1.75253875607477],[2.82298016777619],[2.19722457733622],[2.02697560177653],[2.00148000021012],[3.07429459605709],[3.27496529151924],[3.07429459605709],[2.66882948794893],[2.44568593663472],[2.44568593663472],[2.26336437984076],[2.03395121551296],[2.52572864430826],[2.20414502018079],[2.59983661646198],[2.11021320034659],[2.66882948794893],[3.04402628291295],[3.31068337412132],[2.26336437984076],[2.26336437984076],[2.52572864430826],[2.41178438495904],[2.70805020110221],[2.18332167216723],[2.8128721101991],[2.52572864430826],[2.20414502018079],[1.75253875607477],[2.85115104474288],[2.5634689722911],[2.54477683927895],[2.41751505966802],[2.41751505966802],[2.76413966775325],[2.14558134418438],[2.48650793115497],[2.53780122554252],[2.26456366041625],[2.01490302054226],[2.22254238532051],[2.27660960659078],[2.26336437984076],[2.82298016777619],[2.26336437984076],[2.40312632221592],[2.10084545034299],[2.28138288534344],[1.95798273028958],[2.72012278233648],[2.65319508460179],[2.07703480164927],[2.85115104474288],[2.878550018931],[2.44568593663472],[2.91729084724743],[2.35867455964509],[3.17965511171492],[2.40312632221592],[3.58512021982308],[2.52572864430826],[2.04022082852655],[2.61167107410898],[3.41076683267831],[2.82298016777619],[2.91729084724743],[2.58109057364092],[2.5634689722911],[3.1994577390111],[2.7333680090865],[3.51612734833613],[2.91729084724743],[2.19722457733622],[3.13883311719466],[3.37027547132357],[3.64965874096066],[3.44201937618241],[2.48650793115497],[2.66882948794893],[2.48650793115497],[2.34032542097689],[3.17805383034795],[2.26336437984076],[3.2188758248682],[2.04022082852655],[2.66882948794893],[2.26336437984076],[1.97568230738898],[2.35867455964509],[3.23414329699899],[2.48650793115497],[2.15800386418294],[1.97568230738898],[3.39834431267975],[2.78466130347405],[2.90521826601316],[3.25661615285105],[2.63727001904116],[1.21354225534209],[2.95651156040071],[3.34516955019249],[2.90521826601316],[2.66882948794893],[3.76744177661704],[2.80336038090653],[1.8478489358791],[3.07429459605709],[3.17965511171492],[2.79399263090294],[2.95651156040071],[2.19437150835381],[2.49975315790499],[3.17965511171492],[2.48650793115497],[3.17490384228943],[2.74406063862524],[3.07429459605709],[2.3121545440102],[2.66882948794893],[2.26336437984076],[2.61753619356138],[2.93119375241642],[2.95651156040071],[2.95651156040071],[2.82298016777619],[2.53269731362435],[3.36197666850887],[2.63492793627325],[2.90521826601316],[3.17965511171492],[3.75501925661848],[2.26336437984076],[2.66882948794893],[2.59983661646198],[3.07429459605709],[2.99999667234045],[3.00530172457014],[2.7333680090865],[2.99573227355399],[3.17965511171492],[2.66882948794893],[2.59983661646198],[2.82298016777619],[2.3434070875143],[1.8478489358791],[2.26336437984076],[2.30258509299405],[2.79399263090294],[2.63492793627325],[3.77408631933571],[2.59983661646198],[2.70805020110221],[3.25661615285105],[2.44568593663472],[2.7333680090865],[2.19722457733622],[1.6412346865161],[2.89935314656076],[2.52572864430826],[3.2188758248682],[2.35867455964509],[1.92899519341633],[0.653926467406664],[3.05182174020503],[3.1594524043974],[2.48650793115497],[2.04022082852655],[2.66882948794893],[3.2188758248682],[2.3121545440102],[2.34732098683544],[2.66882948794893],[2.52572864430826],[1.97568230738898],[2.63492793627325],[2.59983661646198],[3.17965511171492],[2.14558134418438],[2.59983661646198],[2.77419000360676],[2.66882948794893],[2.40794560865187],[2.4639383433518],[2.79399263090294],[2.52572864430826],[2.66882948794893],[2.99573227355399],[2.28493015775532],[2.3121545440102],[2.85115104474288],[2.98391053458882],[3.55809154743516],[2.95651156040071],[2.66882948794893],[3.05182174020503],[3.00530172457014],[2.26336437984076],[2.75958385121739],[3.31068337412132],[2.47100374461901],[2.54099611643904],[1.79175946922805],[2.14046624351761],[2.39789527279837],[2.01490302054226],[2.99573227355399],[1.57021719928082],[2.15800386418294],[3.20592696445375],[2.3121545440102],[2.48650793115497],[2.26336437984076],[2.79399263090294],[2.52572864430826],[2.66882948794893],[2.5818181109593],[2.42844413020021],[1.96325978739043],[2.21207108545321],[2.59983661646198],[2.32653568769829],[2.40312632221592],[1.97568230738898],[2.14558134418438],[2.57702193869581],[2.66882948794893],[1.97568230738898],[2.74887219562247],[2.80236088057345],[2.3434070875143],[2.7333680090865],[2.0949457282158],[2.44568593663472],[2.82785140091483],[2.15800386418294],[2.00585318502235],[3.28299042012951],[2.26336437984076],[2.85115104474288],[2.64635663209687],[1.27948035683408],[2.75065950619656],[2.3121545440102],[2.71761965211836],[2.07944154167984],[3.00530172457014],[2.1676922297712],[2.51759851822501],[3.00780485478826],[3.07429459605709],[2.22566251265675],[2.4849488216383],[2.12122461267964],[1.97568230738898],[2.85115104474288],[2.12983298721624],[2.48650793115497],[2.50848683787375],[2.82298016777619],[2.65540646761679],[2.18540283837105],[1.28253512682904],[2.95651156040071],[2.48650793115497],[2.19722457733622],[2.48650793115497],[2.48650793115497],[3.17965511171492],[2.48650793115497],[2.17742195004004],[1.93486031286873],[2.35867455964509],[2.26336437984076],[2.85814661060143],[0.990398704027877],[2.30258509299405],[2.52572864430826],[2.82298016777619],[2.10096309048194],[2.95651156040071],[2.21207108545321],[2.3121545440102],[2.79399263090294],[0.972743768789156],[2.82298016777619],[2.15800386418294],[1.75253875607477],[2.78215817325593],[2.5634689722911],[2.01490302054226],[2.77917754511779],[1.75253875607477],[2.48650793115497],[2.7333680090865],[1.75253875607477],[2.7333680090865],[2.90521826601316],[2.52572864430826],[2.36872489549859],[2.26336437984076],[2.46403507530292],[3.44201937618241],[2.26381427862113],[2.93119375241642],[2.48650793115497],[1.60300702210381],[2.26336437984076],[2.48650793115497],[2.79399263090294],[2.42036812865043],[1.94464710048293],[3.95076383374458],[2.66882948794893],[2.15800386418294],[1.52428010409379],[1.92087407089399],[2.7333680090865],[2.52572864430826],[2.95651156040071],[3.29298379702192],[2.44576926649602],[2.90521826601316],[3.17965511171492],[2.79399263090294],[2.26336437984076],[2.27133254948994],[2.5634689722911],[3.00530172457014],[2.61373952163097],[3.44201937618241],[2.07703480164927],[3.76744177661704],[2.66882948794893],[2.44568593663472],[3.17965511171492],[2.26336437984076],[2.26336437984076],[3.07429459605709],[1.75253875607477],[2.59983661646198],[2.26336437984076],[2.15800386418294],[1.95798273028958],[2.15800386418294],[2.23804657185647],[3.10733445013529],[2.26336437984076],[0.967584026261706],[2.15800386418294],[2.66882948794893],[3.2188758248682],[2.66882948794893],[2.26336437984076],[2.74679102941864],[2.44568593663472],[2.66882948794893],[2.63441056107847],[2.01490302054226],[2.95651156040071],[2.07944154167984],[3.25761665318463],[2.5634689722911],[3.00530172457014],[2.85115104474288],[1.51614997801054],[2.21207108545321],[2.44568593663472],[2.10084545034299],[2.66882948794893],[2.04022082852655],[2.5634689722911],[2.85115104474288],[2.35037575683039],[2.26336437984076],[2.48650793115497],[3.13883311719466],[1.75253875607477],[2.12983298721624],[1.93486031286873],[2.30258509299405],[2.7333680090865],[2.85115104474288],[2.04022082852655],[2.66882948794893],[2.40312632221592],[2.40312632221592],[1.83258146374831],[2.21207108545321],[2.4423470353692],[2.85115104474288],[2.1788069918127],[1.97568230738898],[2.7333680090865],[2.40312632221592],[1.52428010409379],[3.23792401983889],[2.26336437984076],[2.26336437984076],[2.40312632221592],[2.41751505966802],[2.15800386418294],[2.15800386418294],[2.63810782803222],[2.23804657185647],[2.25331404398726],[2.7333680090865],[2.22462355152433],[2.74887219562247],[2.26336437984076],[2.3434070875143],[2.26336437984076],[2.35867455964509],[2.23547917635123],[1.90668943590203],[3.17965511171492],[1.87032179173116],[1.75253875607477],[2.29211379312675],[1.92689214321955],[2.00847213021197],[2.00847213021197],[2.26336437984076],[2.35867455964509],[2.15800386418294],[2.40312632221592],[3.09627350277587],[2.85115104474288],[2.44568593663472],[2.38114741549715],[2.10084545034299],[2.21207108545321],[1.75253875607477],[2.85115104474288],[1.89872126625286],[2.35867455964509],[1.83258146374831],[2.26336437984076],[2.35876546460402],[1.6703006578378],[2.15800386418294],[2.19722457733622],[2.76413966775325],[2.59983661646198],[1.70997914165598],[2.15800386418294],[2.26336437984076],[2.48650793115497],[1.57021719928082],[2.12983298721624],[2.26336437984076],[2.26336437984076],[1.57021719928082],[1.21354225534209],[2.59983661646198],[2.40312632221592],[1.90668943590203],[2.06137702849387],[2.26336437984076],[2.66882948794893],[2.3121545440102],[2.15800386418294],[2.21207108545321],[2.40312632221592],[2.15800386418294],[1.70474809223843],[2.66882948794893],[2.15800386418294],[2.26336437984076],[1.94828333320087],[2.52572864430826],[2.08104282304681],[2.82298016777619],[2.44568593663472],[2.52572864430826],[2.15800386418294],[2.44568593663472],[2.66882948794893],[2.66882948794893],[2.7333680090865],[1.97568230738898],[2.01204995155986],[1.97568230738898],[2.52572864430826],[2.66882948794893],[2.08104282304681],[1.75253875607477],[2.35137525716348],[2.99573227355399],[1.90668943590203],[3.11066224022797],[3.07429459605709],[2.7333680090865],[2.26336437984076],[2.66882948794893],[2.52572864430826],[1.83258146374831],[2.46007467408682],[2.40312632221592],[2.44568593663472],[3.25661615285105],[3.23414329699899],[3.36197666850887],[2.76413966775325],[2.01490302054226],[1.55471301274485],[2.43392109505513],[2.7333680090865],[2.63492793627325],[2.7452024667335],[2.85115104474288],[2.48650793115497],[2.06491344111693],[-3.05515569402479],[2.26336437984076],[2.11021320034659],[2.59983661646198],[3.13883311719466],[2.48650793115497],[3.0349831758422],[2.5634689722911],[1.26006227097698],[2.63492793627325],[2.15800386418294],[2.48650793115497],[1.90668943590203],[3.4572868483132],[3.17965511171492],[2.26336437984076],[2.48650793115497],[3.29298379702192],[2.59983661646198],[2.64385350187875],[2.40312632221592],[2.93198830846801],[3.17965511171492],[2.93630885308319],[2.82298016777619],[2.90521826601316],[2.878550018931],[2.95651156040071],[2.77917754511779],[2.76413966775325],[2.85115104474288],[2.30258509299405],[2.5634689722911],[3.36197666850887],[3.13883311719466],[2.82298016777619],[2.81497831334916],[2.66882948794893],[2.95651156040071],[1.97568230738898],[1.57021719928082],[2.55104645229255],[2.81132955055621],[2.30258509299405],[2.59983661646198],[2.59990804248251],[2.21207108545321],[2.7333680090865],[2.48650793115497],[2.95651156040071],[2.3121545440102],[2.7333680090865],[2.59983661646198],[3.05182174020503],[2.76413966775325],[2.35867455964509],[2.98120417299108],[2.39119775135065],[2.63492793627325],[3.29387625580494],[3.29298379702192],[3.47232472567774],[2.08901099269599]]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>obs<\/th>\n      <th>X<\/th>\n      <th>Y<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"tip","columnDefs":[{"targets":3,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 4, 3, \",\", \".\");\n  }"},{"className":"dt-center","targets":"_all"},{"visible":false,"targets":0},{"orderable":false,"targets":0}],"pageLength":8,"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[8,10,25,50,100]}},"evals":["options.columnDefs.0.render"],"jsHooks":[]}</script>
<ul>
<li>样本数据的描述性统计如下：</li>
</ul>
<div class="sourceCode" id="cb58"><pre class="sourceCode numberSource r foldable numberLines"><code class="sourceCode r"><span id="cb58-1"><a href="lab-LL-wage.html#cb58-1"></a><span class="fu">summary</span>(dt_cps1)</span></code></pre></div>
<pre><code>    X.age       Y.earnings  
 Min.   :-2   Min.   :-3.1  
 1st Qu.:15   1st Qu.: 2.2  
 Median :25   Median : 2.5  
 Mean   :25   Mean   : 2.5  
 3rd Qu.:34   3rd Qu.: 2.8  
 Max.   :62   Max.   : 4.0  </code></pre>
</div>
<div id="数据散点图-2" class="section level3" number="4.2.4">
<h3><span class="header-section-number">4.2.4</span> 数据散点图</h3>
<div class="sourceCode" id="cb60"><pre class="sourceCode numberSource r foldable numberLines"><code class="sourceCode r"><span id="cb60-1"><a href="lab-LL-wage.html#cb60-1"></a><span class="do">#### basic plot ####</span></span>
<span id="cb60-2"><a href="lab-LL-wage.html#cb60-2"></a>fsize <span class="ot">&lt;-</span> <span class="dv">16</span></span>
<span id="cb60-3"><a href="lab-LL-wage.html#cb60-3"></a>p0 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb60-4"><a href="lab-LL-wage.html#cb60-4"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(X, Y),<span class="at">data =</span> dt_cps1, <span class="at">pch=</span><span class="dv">21</span>) <span class="sc">+</span></span>
<span id="cb60-5"><a href="lab-LL-wage.html#cb60-5"></a>  <span class="fu">labs</span>(<span class="at">x=</span> <span class="st">&quot;X职业年数&quot;</span>, <span class="at">y =</span><span class="st">&quot;log(Y)时均工资的对数&quot;</span>) <span class="sc">+</span></span>
<span id="cb60-6"><a href="lab-LL-wage.html#cb60-6"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">70</span>,<span class="dv">10</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">65</span>)) <span class="sc">+</span></span>
<span id="cb60-7"><a href="lab-LL-wage.html#cb60-7"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">4</span>,<span class="dv">1</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">4</span>)) <span class="sc">+</span></span>
<span id="cb60-8"><a href="lab-LL-wage.html#cb60-8"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb60-9"><a href="lab-LL-wage.html#cb60-9"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> fsize))</span></code></pre></div>
<div class="sourceCode" id="cb61"><pre class="sourceCode numberSource r foldable numberLines"><code class="sourceCode r"><span id="cb61-1"><a href="lab-LL-wage.html#cb61-1"></a><span class="co"># show the scatter</span></span>
<span id="cb61-2"><a href="lab-LL-wage.html#cb61-2"></a>p0</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-67"></span>
<img src="seminar_files/figure-html/unnamed-chunk-67-1.svg" alt="样本数据散点图n=`r n`" width="90%" height="600" />
<p class="caption">
图 4.1: 样本数据散点图n=<code>r n</code>
</p>
</div>
</div>
</div>
<div id="过程1cef估计的经验参考谱宽选择" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> 过程1：CEF估计的经验参考谱宽选择</h2>
<div id="r运算代码" class="section level3" number="4.3.1">
<h3><span class="header-section-number">4.3.1</span> R运算代码</h3>
<p>我们先把经验参考谱宽的完整代码给出，后面我们再按分析流程进行步骤分解操作。</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode numberSource r foldable numberLines"><code class="sourceCode r"><span id="cb62-1"><a href="lab-LL-wage.html#cb62-1"></a><span class="co"># Reference Rule </span></span>
<span id="cb62-2"><a href="lab-LL-wage.html#cb62-2"></a></span>
<span id="cb62-3"><a href="lab-LL-wage.html#cb62-3"></a>sx1 <span class="ot">&lt;-</span> <span class="dv">0</span>     <span class="co"># window range</span></span>
<span id="cb62-4"><a href="lab-LL-wage.html#cb62-4"></a>sx2 <span class="ot">&lt;-</span> <span class="dv">40</span></span>
<span id="cb62-5"><a href="lab-LL-wage.html#cb62-5"></a>x1 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">1</span>,n,<span class="dv">1</span>)</span>
<span id="cb62-6"><a href="lab-LL-wage.html#cb62-6"></a>zz <span class="ot">&lt;-</span> <span class="fu">cbind</span>(x1,x,x<span class="sc">^</span><span class="dv">2</span>,x<span class="sc">^</span><span class="dv">3</span>,x<span class="sc">^</span><span class="dv">4</span>)</span>
<span id="cb62-7"><a href="lab-LL-wage.html#cb62-7"></a>beta <span class="ot">&lt;-</span> <span class="fu">solve</span>((<span class="fu">t</span>(zz)<span class="sc">%*%</span>zz),(<span class="fu">t</span>(zz)<span class="sc">%*%</span>y))</span>
<span id="cb62-8"><a href="lab-LL-wage.html#cb62-8"></a>xtrim <span class="ot">&lt;-</span> (x<span class="sc">&lt;=</span>sx2)<span class="sc">*</span>(x<span class="sc">&gt;=</span>sx1)</span>
<span id="cb62-9"><a href="lab-LL-wage.html#cb62-9"></a>b <span class="ot">&lt;-</span> <span class="fu">mean</span>(((beta[<span class="dv">3</span>]<span class="sc">+</span>x<span class="sc">*</span><span class="dv">3</span><span class="sc">*</span>beta[<span class="dv">4</span>]<span class="sc">+</span>(x<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span><span class="dv">6</span><span class="sc">*</span>beta[<span class="dv">5</span>])<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>xtrim)</span>
<span id="cb62-10"><a href="lab-LL-wage.html#cb62-10"></a>e <span class="ot">&lt;-</span> y <span class="sc">-</span> zz<span class="sc">%*%</span>beta</span>
<span id="cb62-11"><a href="lab-LL-wage.html#cb62-11"></a>sig <span class="ot">&lt;-</span> (<span class="fu">sum</span>(e<span class="sc">^</span><span class="dv">2</span>))<span class="sc">/</span>(n<span class="dv">-5</span>)</span>
<span id="cb62-12"><a href="lab-LL-wage.html#cb62-12"></a>hrot <span class="ot">&lt;-</span> <span class="fl">0.58</span><span class="sc">*</span>(((sx2<span class="sc">-</span>sx1)<span class="sc">*</span>sig<span class="sc">/</span>n<span class="sc">/</span>b)<span class="sc">^</span>.<span class="dv">2</span>)</span></code></pre></div>
</div>
<div id="过程步骤解读" class="section level3" number="4.3.2">
<h3><span class="header-section-number">4.3.2</span> 过程步骤解读</h3>
<p>下面我们按前述步骤来计算参考谱宽值
<span class="math inline">\(h_{rot}\)</span>：</p>
<ul>
<li><p><strong>步骤1</strong>：根据案例数据集，设定权重取值范围
<span class="math inline">\(\left\{\xi_{1} \leq x \leq \xi_{2}\right\}=\{0,40\}\)</span></p></li>
<li><p><strong>步骤2</strong>：构建多项式回归</p></li>
</ul>
<div class="sourceCode" id="cb63"><pre class="sourceCode numberSource r foldable numberLines"><code class="sourceCode r"><span id="cb63-1"><a href="lab-LL-wage.html#cb63-1"></a>varx <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;X&quot;</span>,<span class="st">&quot;X^2&quot;</span>,<span class="st">&quot;X^3&quot;</span>,<span class="st">&quot;X^4&quot;</span>)</span>
<span id="cb63-2"><a href="lab-LL-wage.html#cb63-2"></a>lx_out <span class="ot">&lt;-</span> xmerit<span class="sc">::</span><span class="fu">lx.psm</span>(<span class="at">x =</span> varx, <span class="at">n.row =</span> <span class="dv">5</span>)</span></code></pre></div>
<p><span class="math display">\[\begin{align}
\begin{split}
Y_i=&amp;+\beta_{1}+\beta_{2}X_i+\beta_{3}X^2_i+\beta_{4}X^3_i+\beta_{5}X^4_i+u_i
\end{split}
\end{align}\]</span></p>
<blockquote>
<p>直接使用OLS进行估计，得到估计方程：</p>
</blockquote>
<div class="sourceCode" id="cb64"><pre class="sourceCode numberSource r foldable numberLines"><code class="sourceCode r"><span id="cb64-1"><a href="lab-LL-wage.html#cb64-1"></a>mod_poly <span class="ot">&lt;-</span> <span class="fu">formula</span>(<span class="st">&quot;Y~X +I(X^2) +I(X^3) +I(X^4)&quot;</span> )</span>
<span id="cb64-2"><a href="lab-LL-wage.html#cb64-2"></a>lx_est <span class="ot">&lt;-</span> xmerit<span class="sc">::</span><span class="fu">lx.est</span>(<span class="at">lm.mod =</span> mod_poly, </span>
<span id="cb64-3"><a href="lab-LL-wage.html#cb64-3"></a>                         <span class="at">lm.dt =</span> dt_cps1, <span class="at">lm.n =</span> <span class="dv">5</span>,</span>
<span id="cb64-4"><a href="lab-LL-wage.html#cb64-4"></a>                         <span class="at">opt =</span> <span class="fu">c</span>(<span class="st">&quot;s&quot;</span>),</span>
<span id="cb64-5"><a href="lab-LL-wage.html#cb64-5"></a>                         <span class="at">digits =</span> <span class="fu">c</span>(<span class="dv">6</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">4</span>))</span></code></pre></div>
<p><span class="math display">\[\begin{equation}
\begin{alignedat}{999}
&amp;\widehat{Y}=&amp;&amp;+2.094395&amp;&amp;+0.030951X_i&amp;&amp;-0.000103X^2_i&amp;&amp;-0.000021X^3_i&amp;&amp;+0.000000X^4_i\\
&amp;(s)&amp;&amp;(0.1371)&amp;&amp;(0.0284)&amp;&amp;(0.0019)&amp;&amp;(0.0000)&amp;&amp;(0.0000)
\end{alignedat}
\end{equation}\]</span></p>
<blockquote>
<p>进而得到拟合值
<span class="math inline">\(\widehat{m}(x)\)</span>及其二阶导
<span class="math inline">\(\widehat{m}^{\prime \prime}(x)\)</span>及残差
<span class="math inline">\(\hat{\epsilon}\)</span></p>
</blockquote>
<p><span class="math display">\[\begin{align}
\widehat{m}(x)
&amp;=2.094395+0.030951x_i-0.000103x^2_i-0.000021x^3_i+0.000000x^4_i \\
\widehat{m}^{\prime \prime}(x)
&amp;=-2\times0.000103-6\times0.000021x_i+12\times0.000000x^2_i \\
\end{align}\]</span></p>
<ul>
<li>步骤3：利用上述估计结果计算</li>
</ul>
<p><span class="math display">\[\begin{align}
\widehat{B}=\frac{1}{n} \sum_{i=1}^{n}\left(\frac{1}{2} \hat{m}^{\prime \prime}\left(X_{i}\right)\right)^{2} \mathbb{1}\left\{\xi_{1} \leq X_{i} \leq \xi_{2}\right\}
= 0.00000025
\end{align}\]</span></p>
<ul>
<li>步骤4：多项式模型的回归误差方差</li>
</ul>
<p><span class="math display">\[\hat{\sigma}^2 = \frac{\sum{\hat{\epsilon}^2}}{n-q-1}=0.2592\]</span></p>
<ul>
<li>步骤5：根据上述全部结果计算得到经验谱宽：</li>
</ul>
<p><span class="math display">\[\begin{align}
h_{\text {rot }}&amp;=0.58\left(\frac{\widehat{\sigma}^{2}\left(\xi_{2}-\xi_{1}\right)}{n \widehat{B}}\right)^{1 / 5}  = 0.58 \times \left(\frac{0.2592\times \left(40-0\right)}{762 \times 0.000000248}\right)^{1 / 5}
= 5.1442
\end{align}\]</span></p>
</div>
</div>
<div id="过程2cef估计的最优交叉验证谱宽选择" class="section level2" number="4.4">
<h2><span class="header-section-number">4.4</span> 过程2：CEF估计的最优交叉验证谱宽选择</h2>
<div id="r运算代码-1" class="section level3" number="4.4.1">
<h3><span class="header-section-number">4.4.1</span> R运算代码</h3>
<div class="notes">
<p><strong>注意</strong>：此代码运行时间较长（约3-5分钟），为提高渲染效率代码文件仅需运行一次。</p>
</div>
<div class="sourceCode" id="cb65"><pre class="sourceCode numberSource r foldable numberLines"><code class="sourceCode r"><span id="cb65-1"><a href="lab-LL-wage.html#cb65-1"></a><span class="do">#### CV Bandwidth Selection ####</span></span>
<span id="cb65-2"><a href="lab-LL-wage.html#cb65-2"></a>g <span class="ot">&lt;-</span> <span class="dv">200</span></span>
<span id="cb65-3"><a href="lab-LL-wage.html#cb65-3"></a>h1 <span class="ot">&lt;-</span> hrot<span class="sc">/</span><span class="dv">3</span></span>
<span id="cb65-4"><a href="lab-LL-wage.html#cb65-4"></a>h2 <span class="ot">&lt;-</span> <span class="dv">3</span><span class="sc">*</span>hrot</span>
<span id="cb65-5"><a href="lab-LL-wage.html#cb65-5"></a>hh <span class="ot">&lt;-</span> <span class="fu">seq</span>(h1,h2,(h2<span class="sc">-</span>h1)<span class="sc">/</span>g)</span>
<span id="cb65-6"><a href="lab-LL-wage.html#cb65-6"></a>hn <span class="ot">&lt;-</span> <span class="fu">length</span>(hh)</span>
<span id="cb65-7"><a href="lab-LL-wage.html#cb65-7"></a></span>
<span id="cb65-8"><a href="lab-LL-wage.html#cb65-8"></a>LL <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,n,hn)</span>
<span id="cb65-9"><a href="lab-LL-wage.html#cb65-9"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>hn){</span>
<span id="cb65-10"><a href="lab-LL-wage.html#cb65-10"></a>  hi <span class="ot">&lt;-</span> hh[i]</span>
<span id="cb65-11"><a href="lab-LL-wage.html#cb65-11"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb65-12"><a href="lab-LL-wage.html#cb65-12"></a>    xj <span class="ot">&lt;-</span> x<span class="sc">-</span>x[j]</span>
<span id="cb65-13"><a href="lab-LL-wage.html#cb65-13"></a>    k <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(xj<span class="sc">/</span>hi)</span>
<span id="cb65-14"><a href="lab-LL-wage.html#cb65-14"></a>    k[j] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb65-15"><a href="lab-LL-wage.html#cb65-15"></a>    z <span class="ot">&lt;-</span> <span class="fu">cbind</span>(x1,xj)</span>
<span id="cb65-16"><a href="lab-LL-wage.html#cb65-16"></a>    zk <span class="ot">&lt;-</span> z<span class="sc">*</span>(k<span class="sc">%*%</span><span class="fu">cbind</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb65-17"><a href="lab-LL-wage.html#cb65-17"></a>    beta <span class="ot">&lt;-</span> <span class="fu">solve</span>(<span class="fu">t</span>(zk)<span class="sc">%*%</span>z,<span class="fu">t</span>(zk)<span class="sc">%*%</span>y)</span>
<span id="cb65-18"><a href="lab-LL-wage.html#cb65-18"></a>    LL[j,i] <span class="ot">&lt;-</span> (y[j]<span class="sc">-</span>beta[<span class="dv">1</span>])<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb65-19"><a href="lab-LL-wage.html#cb65-19"></a>  }</span>
<span id="cb65-20"><a href="lab-LL-wage.html#cb65-20"></a>}</span>
<span id="cb65-21"><a href="lab-LL-wage.html#cb65-21"></a></span>
<span id="cb65-22"><a href="lab-LL-wage.html#cb65-22"></a>LL2 <span class="ot">&lt;-</span> LL<span class="sc">*</span>(xtrim<span class="sc">%*%</span><span class="fu">matrix</span>(<span class="dv">1</span>,<span class="dv">1</span>,hn))</span>
<span id="cb65-23"><a href="lab-LL-wage.html#cb65-23"></a>cvLL <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(LL2)</span>
<span id="cb65-24"><a href="lab-LL-wage.html#cb65-24"></a>i <span class="ot">&lt;-</span> <span class="fu">which.min</span>(cvLL)</span>
<span id="cb65-25"><a href="lab-LL-wage.html#cb65-25"></a>hLL <span class="ot">&lt;-</span> hh[i]</span>
<span id="cb65-26"><a href="lab-LL-wage.html#cb65-26"></a>hLL_tex <span class="ot">&lt;-</span><span class="fu">paste0</span>(<span class="st">&quot;$h_{CV}=$&quot;</span>,<span class="fu">number</span>(hLL,<span class="fl">0.0001</span>),<span class="st">&quot;&quot;</span>)</span>
<span id="cb65-27"><a href="lab-LL-wage.html#cb65-27"></a>LLmin <span class="ot">&lt;-</span> <span class="fu">min</span>(cvLL)</span>
<span id="cb65-28"><a href="lab-LL-wage.html#cb65-28"></a></span>
<span id="cb65-29"><a href="lab-LL-wage.html#cb65-29"></a><span class="co"># combine result as data.frame</span></span>
<span id="cb65-30"><a href="lab-LL-wage.html#cb65-30"></a>tb_cvc <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb65-31"><a href="lab-LL-wage.html#cb65-31"></a>  <span class="at">h_tune =</span> hh, </span>
<span id="cb65-32"><a href="lab-LL-wage.html#cb65-32"></a>  <span class="at">cv_LL =</span> cvLL)</span></code></pre></div>
</div>
<div id="过程步骤解读-1" class="section level3" number="4.4.2">
<h3><span class="header-section-number">4.4.2</span> 过程步骤解读</h3>
<p>首先我们约定一下交叉验证谱宽的计算规则</p>
<ul>
<li><p>步骤1：设定<strong>经验谱宽</strong>
<span class="math inline">\(h_{rot}=5.1442\)</span>作为<strong>初始值</strong>。。</p></li>
<li><p>步骤2：设定<strong>调参谱宽</strong>（tuning bandwidth）。
&gt;</p></li>
<li><p>一个经验谱宽范围可供参考：
<span class="math inline">\([h_{rot}/3, 3h_{rot}]=[1.7147, 15.4326]\)</span>。</p></li>
<li><p>给定范围内的搜寻总数为
<span class="math inline">\(n=201\)</span>。则待评估序贯值为
<span class="math inline">\(h\in (1.7147, 1.7833, 1.8519, 1.9205, 1.9891, \cdots,15.2268, 15.2954, 15.3640, 15.4326)\)</span>。</p></li>
</ul>
<p>下面我们就可以得到交叉验证谱宽的CV计算表：</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode numberSource r foldable numberLines"><code class="sourceCode r"><span id="cb66-1"><a href="lab-LL-wage.html#cb66-1"></a>tb_cvc <span class="sc">%&gt;%</span></span>
<span id="cb66-2"><a href="lab-LL-wage.html#cb66-2"></a>  <span class="fu">add_column</span>(<span class="at">id =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(.), <span class="at">.before =</span> <span class="st">&quot;h_tune&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb66-3"><a href="lab-LL-wage.html#cb66-3"></a>  DT<span class="sc">::</span><span class="fu">datatable</span>(<span class="at">caption =</span> <span class="st">&quot;LL方法下的CV计算表&quot;</span>,</span>
<span id="cb66-4"><a href="lab-LL-wage.html#cb66-4"></a>                <span class="at">options =</span> <span class="fu">list</span>(<span class="at">dom =</span><span class="st">&quot;tip&quot;</span>, <span class="at">pageLength =</span><span class="dv">8</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb66-5"><a href="lab-LL-wage.html#cb66-5"></a>  <span class="fu">formatRound</span>(<span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>), <span class="at">digits =</span> <span class="dv">4</span>)</span></code></pre></div>
<div id="htmlwidget-d7232ff2c4539d8d494f" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-d7232ff2c4539d8d494f">{"x":{"filter":"none","caption":"<caption>LL方法下的CV计算表<\/caption>","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153","154","155","156","157","158","159","160","161","162","163","164","165","166","167","168","169","170","171","172","173","174","175","176","177","178","179","180","181","182","183","184","185","186","187","188","189","190","191","192","193","194","195","196","197","198","199","200","201"],[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201],[1.71473048841998,1.78331970795678,1.85190892749358,1.92049814703038,1.98908736656718,2.05767658610398,2.12626580564078,2.19485502517758,2.26344424471438,2.33203346425118,2.40062268378798,2.46921190332477,2.53780112286157,2.60639034239837,2.67497956193517,2.74356878147197,2.81215800100877,2.88074722054557,2.94933644008237,3.01792565961917,3.08651487915597,3.15510409869277,3.22369331822957,3.29228253776637,3.36087175730317,3.42946097683996,3.49805019637676,3.56663941591356,3.63522863545036,3.70381785498716,3.77240707452396,3.84099629406076,3.90958551359756,3.97817473313436,4.04676395267116,4.11535317220796,4.18394239174476,4.25253161128156,4.32112083081836,4.38971005035515,4.45829926989195,4.52688848942875,4.59547770896555,4.66406692850235,4.73265614803915,4.80124536757595,4.86983458711275,4.93842380664955,5.00701302618635,5.07560224572315,5.14419146525995,5.21278068479675,5.28136990433355,5.34995912387035,5.41854834340714,5.48713756294394,5.55572678248074,5.62431600201754,5.69290522155434,5.76149444109114,5.83008366062794,5.89867288016474,5.96726209970154,6.03585131923834,6.10444053877514,6.17302975831194,6.24161897784874,6.31020819738553,6.37879741692233,6.44738663645913,6.51597585599593,6.58456507553273,6.65315429506953,6.72174351460633,6.79033273414313,6.85892195367993,6.92751117321673,6.99610039275353,7.06468961229033,7.13327883182713,7.20186805136393,7.27045727090072,7.33904649043752,7.40763570997432,7.47622492951112,7.54481414904792,7.61340336858472,7.68199258812152,7.75058180765832,7.81917102719512,7.88776024673192,7.95634946626872,8.02493868580552,8.09352790534232,8.16211712487912,8.23070634441592,8.29929556395271,8.36788478348951,8.43647400302631,8.50506322256311,8.57365244209991,8.64224166163671,8.71083088117351,8.77942010071031,8.84800932024711,8.91659853978391,8.98518775932071,9.05377697885751,9.12236619839431,9.19095541793111,9.2595446374679,9.3281338570047,9.3967230765415,9.4653122960783,9.5339015156151,9.6024907351519,9.6710799546887,9.7396691742255,9.8082583937623,9.8768476132991,9.9454368328359,10.0140260523727,10.0826152719095,10.1512044914463,10.2197937109831,10.2883829305199,10.3569721500567,10.4255613695935,10.4941505891303,10.5627398086671,10.6313290282039,10.6999182477407,10.7685074672775,10.8370966868143,10.9056859063511,10.9742751258879,11.0428643454247,11.1114535649615,11.1800427844983,11.2486320040351,11.3172212235719,11.3858104431087,11.4543996626455,11.5229888821823,11.5915781017191,11.6601673212559,11.7287565407927,11.7973457603295,11.8659349798663,11.9345241994031,12.0031134189399,12.0717026384767,12.1402918580135,12.2088810775503,12.2774702970871,12.3460595166239,12.4146487361607,12.4832379556975,12.5518271752343,12.6204163947711,12.6890056143079,12.7575948338447,12.8261840533815,12.8947732729183,12.9633624924551,13.0319517119919,13.1005409315287,13.1691301510655,13.2377193706023,13.3063085901391,13.3748978096759,13.4434870292127,13.5120762487495,13.5806654682863,13.6492546878231,13.7178439073599,13.7864331268967,13.8550223464335,13.9236115659703,13.9922007855071,14.0607900050439,14.1293792245807,14.1979684441175,14.2665576636543,14.3351468831911,14.4037361027279,14.4723253222647,14.5409145418015,14.6095037613382,14.678092980875,14.7466822004118,14.8152714199486,14.8838606394854,14.9524498590222,15.021039078559,15.0896282980958,15.1582175176326,15.2268067371694,15.2953959567062,15.363985176243,15.4325743957798],[0.23111804194426,0.231025224533529,0.230932212194641,0.230839834722392,0.230748897875224,0.230660130724259,0.230574156324589,0.230491479291383,0.230412484971112,0.230337446066617,0.230266533650146,0.230199830396933,0.230137344568595,0.230079023785482,0.230024767984336,0.229974441201263,0.229927881984823,0.229884912357045,0.229845345319574,0.229808990959521,0.229775661251047,0.229745173677636,0.229717353818194,0.229692037048692,0.229669069511457,0.229648308497861,0.229629622378596,0.229612890200837,0.229598001054747,0.229584853294487,0.229573353682129,0.229563416507428,0.229554962722778,0.229547919121076,0.229542217574631,0.229537794345696,0.229534589473356,0.229532546237189,0.229531610695109,0.229531731290772,0.229532858524727,0.229534944682868,0.229537943615611,0.229541810561288,0.229546502007646,0.229551975585742,0.22955818999106,0.229565104927192,0.229572681067995,0.22958088003457,0.229589664383953,0.229598997606804,0.229608844131766,0.229619169334547,0.229629939550084,0.229641122086407,0.229652685239114,0.229664598305531,0.229676831597877,0.22968935645487,0.229702145251388,0.229715171405889,0.229728409385427,0.229741834708145,0.229755423943242,0.229769154708413,0.229783005664845,0.229796956509865,0.22981098796735,0.229825081776047,0.229839220675942,0.229853388392817,0.229867569621154,0.22988175000553,0.229895916120632,0.229910055450032,0.229924156363854,0.229938208095437,0.229952200717126,0.229966125115275,0.229979972964577,0.22999373670181,0.230007409499078,0.230020985236648,0.230034458475454,0.23004782442933,0.230061078937086,0.230074218434458,0.230087239926017,0.230100140957122,0.230112919585957,0.230125574355726,0.230138104267082,0.23015050875083,0.230162787640983,0.230174941148209,0.230186969833741,0.230198874583792,0.230210656584525,0.230222317297627,0.230233858436533,0.230245281943328,0.230256589966377,0.230267784838708,0.23027886905718,0.230289845262448,0.230300716219776,0.230311484800673,0.230322153965407,0.230332726746374,0.230343206232345,0.230353595553587,0.230363897867861,0.230374116347279,0.230384254166029,0.230394314488946,0.230404300460917,0.230414215197104,0.230424061773967,0.23043384322106,0.230443562513592,0.230453222565703,0.230462826224461,0.230472376264523,0.230481875383444,0.230491326197618,0.230500731238794,0.230510092951156,0.230519413688938,0.230528695714526,0.230537941197039,0.230547152211342,0.230556330737466,0.230565478660419,0.230574597770329,0.230583689762926,0.230592756240317,0.230601798712021,0.230610818596263,0.230619817221477,0.230628795828018,0.230637755570034,0.230646697517502,0.230655622658405,0.230664531901007,0.230673426076235,0.230682305940147,0.230691172176452,0.230700025399097,0.230708866154872,0.230717694926056,0.230726512133068,0.230735318137121,0.230744113242872,0.230752897701047,0.230761671711055,0.23077043542356,0.230779188943018,0.230787932330176,0.230796665604509,0.23080538874662,0.230814101700574,0.23082280437617,0.230831496651158,0.230840178373383,0.23084884936287,0.23085750941383,0.230866158296613,0.230874795759567,0.230883421530858,0.230892035320187,0.230900636820466,0.230909225709399,0.230917801651016,0.230926364297125,0.2309349132887,0.230943448257207,0.230951968825859,0.230960474610818,0.230968965222322,0.230977440265762,0.2309858993427,0.230994342051823,0.23100276798985,0.231011176752383,0.231019567934705,0.231027941132532,0.231036295942713,0.231044631963886,0.231052948797095,0.231061246046351,0.231069523319172,0.231077780227062,0.231086016385974,0.231094231416721,0.231102424945362,0.231110596603554,0.231118746028871,0.231126872865098,0.231134976762491,0.231143057378017]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>id<\/th>\n      <th>h_tune<\/th>\n      <th>cv_LL<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"tip","columnDefs":[{"targets":2,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 4, 3, \",\", \".\");\n  }"},{"targets":3,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 4, 3, \",\", \".\");\n  }"},{"className":"dt-center","targets":"_all"},{"visible":false,"targets":0},{"orderable":false,"targets":0}],"pageLength":8,"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[8,10,25,50,100]}},"evals":["options.columnDefs.0.render","options.columnDefs.1.render"],"jsHooks":[]}</script>
</div>
<div id="图形展示选择结果" class="section level3" number="4.4.3">
<h3><span class="header-section-number">4.4.3</span> 图形展示选择结果</h3>
<div class="sourceCode" id="cb67"><pre class="sourceCode numberSource r foldable numberLines"><code class="sourceCode r"><span id="cb67-1"><a href="lab-LL-wage.html#cb67-1"></a><span class="do">#### plot 19.5-a Cross-Validation Criterion ####</span></span>
<span id="cb67-2"><a href="lab-LL-wage.html#cb67-2"></a></span>
<span id="cb67-3"><a href="lab-LL-wage.html#cb67-3"></a>lwd <span class="ot">&lt;-</span> <span class="fl">0.8</span></span>
<span id="cb67-4"><a href="lab-LL-wage.html#cb67-4"></a>lwadd <span class="ot">&lt;-</span> <span class="fl">0.2</span></span>
<span id="cb67-5"><a href="lab-LL-wage.html#cb67-5"></a></span>
<span id="cb67-6"><a href="lab-LL-wage.html#cb67-6"></a>p_cvc <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> h_tune),<span class="at">data =</span> tb_cvc) <span class="sc">+</span></span>
<span id="cb67-7"><a href="lab-LL-wage.html#cb67-7"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> cv_LL),</span>
<span id="cb67-8"><a href="lab-LL-wage.html#cb67-8"></a>            <span class="at">lty =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>,</span>
<span id="cb67-9"><a href="lab-LL-wage.html#cb67-9"></a>            <span class="at">lwd =</span> lwd) <span class="sc">+</span></span>
<span id="cb67-10"><a href="lab-LL-wage.html#cb67-10"></a>  <span class="fu">labs</span>(<span class="at">x=</span> <span class="st">&quot;谱宽h&quot;</span>, <span class="at">y =</span><span class="st">&quot;交叉验证准则函数值CV(h)&quot;</span>) <span class="sc">+</span></span>
<span id="cb67-11"><a href="lab-LL-wage.html#cb67-11"></a>  <span class="fu">scale_x_continuous</span>(<span class="co">#expand = expansion(add = c(0, .06)),</span></span>
<span id="cb67-12"><a href="lab-LL-wage.html#cb67-12"></a>    <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">12</span>,<span class="dv">1</span>), </span>
<span id="cb67-13"><a href="lab-LL-wage.html#cb67-13"></a>    <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">12</span>)) <span class="sc">+</span></span>
<span id="cb67-14"><a href="lab-LL-wage.html#cb67-14"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb67-15"><a href="lab-LL-wage.html#cb67-15"></a>    <span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">add =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)),</span>
<span id="cb67-16"><a href="lab-LL-wage.html#cb67-16"></a>    <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="fl">0.2290</span>,<span class="fl">0.2310</span>,<span class="fl">0.0005</span>), </span>
<span id="cb67-17"><a href="lab-LL-wage.html#cb67-17"></a>    <span class="at">limits =</span> <span class="fu">c</span>(<span class="fl">0.2290</span>,<span class="fl">0.2310</span>),</span>
<span id="cb67-18"><a href="lab-LL-wage.html#cb67-18"></a>    <span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">number_format</span>(<span class="at">accuracy =</span> <span class="fl">0.0001</span>)</span>
<span id="cb67-19"><a href="lab-LL-wage.html#cb67-19"></a>                     ) <span class="sc">+</span></span>
<span id="cb67-20"><a href="lab-LL-wage.html#cb67-20"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x=</span>hLL, <span class="at">xend =</span> hLL,</span>
<span id="cb67-21"><a href="lab-LL-wage.html#cb67-21"></a>                   <span class="at">y=</span> LLmin, <span class="at">yend =</span> <span class="fu">c</span>(<span class="fl">0.2290</span>)),</span>
<span id="cb67-22"><a href="lab-LL-wage.html#cb67-22"></a>               <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.1</span>,<span class="st">&quot;cm&quot;</span>),</span>
<span id="cb67-23"><a href="lab-LL-wage.html#cb67-23"></a>                             <span class="at">type =</span> <span class="st">&quot;closed&quot;</span>),</span>
<span id="cb67-24"><a href="lab-LL-wage.html#cb67-24"></a>               <span class="at">lty =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">color=</span> <span class="st">&quot;gray&quot;</span>, <span class="at">lwd=</span>lwd) <span class="sc">+</span></span>
<span id="cb67-25"><a href="lab-LL-wage.html#cb67-25"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> hLL<span class="fl">+0.5</span>, <span class="at">y=</span>LLmin<span class="fl">-0.0004</span>), </span>
<span id="cb67-26"><a href="lab-LL-wage.html#cb67-26"></a>            <span class="at">label =</span>latex2exp<span class="sc">::</span><span class="fu">TeX</span>(hLL_tex),</span>
<span id="cb67-27"><a href="lab-LL-wage.html#cb67-27"></a>            <span class="co">#parse=TRUE,</span></span>
<span id="cb67-28"><a href="lab-LL-wage.html#cb67-28"></a>            <span class="at">color=</span> <span class="st">&quot;blue&quot;</span>, <span class="at">size=</span><span class="dv">4</span>)  <span class="sc">+</span></span>
<span id="cb67-29"><a href="lab-LL-wage.html#cb67-29"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb67-30"><a href="lab-LL-wage.html#cb67-30"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> fsize))</span></code></pre></div>
<p>下面，我们可以视觉化展示交叉验证谱宽与CV变化关系：</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode numberSource r foldable numberLines"><code class="sourceCode r"><span id="cb68-1"><a href="lab-LL-wage.html#cb68-1"></a>p_cvc</span></code></pre></div>
<p><img src="seminar_files/figure-html/unnamed-chunk-74-1.svg" width="90%" height="450" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="过程3基于不同谱宽选择的cef估计" class="section level2" number="4.5">
<h2><span class="header-section-number">4.5</span> 过程3：基于不同谱宽选择的CEF估计</h2>
<div id="r运算代码-2" class="section level3" number="4.5.1">
<h3><span class="header-section-number">4.5.1</span> R运算代码</h3>
<div class="notes">
<p><strong>注意</strong>：此代码运行时间较长（约3-5分钟），为提高渲染效率代码文件仅需运行一次。</p>
</div>
<div class="sourceCode" id="cb69"><pre class="sourceCode numberSource r foldable numberLines"><code class="sourceCode r"><span id="cb69-1"><a href="lab-LL-wage.html#cb69-1"></a><span class="do">#### CEF LL Regression Estimation ####</span></span>
<span id="cb69-2"><a href="lab-LL-wage.html#cb69-2"></a>g <span class="ot">&lt;-</span> <span class="dv">201</span></span>
<span id="cb69-3"><a href="lab-LL-wage.html#cb69-3"></a>xg <span class="ot">&lt;-</span> <span class="fu">seq</span>(sx1,sx2,(sx2<span class="sc">-</span>sx1)<span class="sc">/</span>(g<span class="dv">-1</span>))</span>
<span id="cb69-4"><a href="lab-LL-wage.html#cb69-4"></a>m1 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,g,<span class="dv">1</span>)</span>
<span id="cb69-5"><a href="lab-LL-wage.html#cb69-5"></a>m2 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,g,<span class="dv">1</span>)</span>
<span id="cb69-6"><a href="lab-LL-wage.html#cb69-6"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>g){</span>
<span id="cb69-7"><a href="lab-LL-wage.html#cb69-7"></a>  xj <span class="ot">&lt;-</span> x<span class="sc">-</span>xg[j]</span>
<span id="cb69-8"><a href="lab-LL-wage.html#cb69-8"></a>  z <span class="ot">&lt;-</span> <span class="fu">cbind</span>(x1,xj)</span>
<span id="cb69-9"><a href="lab-LL-wage.html#cb69-9"></a>  z1 <span class="ot">&lt;-</span> z<span class="sc">*</span>(<span class="fu">dnorm</span>(xj<span class="sc">/</span>hrot)<span class="sc">%*%</span><span class="fu">cbind</span>(<span class="dv">1</span>,<span class="dv">1</span>))  <span class="co"># use rot bandwidth</span></span>
<span id="cb69-10"><a href="lab-LL-wage.html#cb69-10"></a>  z2 <span class="ot">&lt;-</span> z<span class="sc">*</span>(<span class="fu">dnorm</span>(xj<span class="sc">/</span>hLL)<span class="sc">%*%</span><span class="fu">cbind</span>(<span class="dv">1</span>,<span class="dv">1</span>))   <span class="co"># use CV  bandwidth</span></span>
<span id="cb69-11"><a href="lab-LL-wage.html#cb69-11"></a>  beta1 <span class="ot">&lt;-</span> <span class="fu">solve</span>(<span class="fu">t</span>(z1)<span class="sc">%*%</span>z,<span class="fu">t</span>(z1)<span class="sc">%*%</span>y)</span>
<span id="cb69-12"><a href="lab-LL-wage.html#cb69-12"></a>  beta2 <span class="ot">&lt;-</span> <span class="fu">solve</span>(<span class="fu">t</span>(z2)<span class="sc">%*%</span>z,<span class="fu">t</span>(z2)<span class="sc">%*%</span>y)</span>
<span id="cb69-13"><a href="lab-LL-wage.html#cb69-13"></a>  m1[j,<span class="dv">1</span>] <span class="ot">&lt;-</span> beta1[<span class="dv">1</span>]</span>
<span id="cb69-14"><a href="lab-LL-wage.html#cb69-14"></a>  m2[j,<span class="dv">1</span>] <span class="ot">&lt;-</span> beta2[<span class="dv">1</span>]</span>
<span id="cb69-15"><a href="lab-LL-wage.html#cb69-15"></a>}</span>
<span id="cb69-16"><a href="lab-LL-wage.html#cb69-16"></a></span>
<span id="cb69-17"><a href="lab-LL-wage.html#cb69-17"></a><span class="co"># combine result as data.frame</span></span>
<span id="cb69-18"><a href="lab-LL-wage.html#cb69-18"></a>tb_mxh <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">xg =</span> xg,</span>
<span id="cb69-19"><a href="lab-LL-wage.html#cb69-19"></a>                 <span class="at">mx1=</span><span class="fu">as.vector</span>(m1), </span>
<span id="cb69-20"><a href="lab-LL-wage.html#cb69-20"></a>                 <span class="at">mx2=</span><span class="fu">as.vector</span>(m2))</span></code></pre></div>
</div>
<div id="过程步骤解读-2" class="section level3" number="4.5.2">
<h3><span class="header-section-number">4.5.2</span> 过程步骤解读</h3>
<p>首先，我们给出两种谱宽选择（rot谱宽或者CV谱宽）下的CEF估计值（<span class="math inline">\(\widehat{m}(x)\)</span>）的最终计算表：</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode numberSource r foldable numberLines"><code class="sourceCode r"><span id="cb70-1"><a href="lab-LL-wage.html#cb70-1"></a>tb_mxh <span class="sc">%&gt;%</span></span>
<span id="cb70-2"><a href="lab-LL-wage.html#cb70-2"></a>  <span class="fu">add_column</span>(<span class="at">index =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(.), <span class="at">.before =</span> <span class="st">&quot;xg&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb70-3"><a href="lab-LL-wage.html#cb70-3"></a>  <span class="fu">rename</span>(<span class="st">&quot;mx_rot&quot;</span><span class="ot">=</span><span class="st">&#39;mx1&#39;</span>, <span class="st">&quot;mx_cv&quot;</span><span class="ot">=</span><span class="st">&#39;mx2&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb70-4"><a href="lab-LL-wage.html#cb70-4"></a>  DT<span class="sc">::</span><span class="fu">datatable</span>(<span class="at">caption =</span> <span class="st">&quot;使用不同谱宽下LL方法对m(x)的估计结果&quot;</span>,</span>
<span id="cb70-5"><a href="lab-LL-wage.html#cb70-5"></a>                <span class="at">options =</span> <span class="fu">list</span>(<span class="at">dom =</span><span class="st">&quot;tip&quot;</span>, <span class="at">pageLength =</span><span class="dv">8</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb70-6"><a href="lab-LL-wage.html#cb70-6"></a>  <span class="fu">formatRound</span>(<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>), <span class="at">digits =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">4</span>))</span></code></pre></div>
<div id="htmlwidget-abdf7c763213e4afaefa" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-abdf7c763213e4afaefa">{"x":{"filter":"none","caption":"<caption>使用不同谱宽下LL方法对m(x)的估计结果<\/caption>","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153","154","155","156","157","158","159","160","161","162","163","164","165","166","167","168","169","170","171","172","173","174","175","176","177","178","179","180","181","182","183","184","185","186","187","188","189","190","191","192","193","194","195","196","197","198","199","200","201"],[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201],[0,0.2,0.4,0.6,0.8,1,1.2,1.4,1.6,1.8,2,2.2,2.4,2.6,2.8,3,3.2,3.4,3.6,3.8,4,4.2,4.4,4.6,4.8,5,5.2,5.4,5.6,5.8,6,6.2,6.4,6.6,6.8,7,7.2,7.4,7.6,7.8,8,8.2,8.4,8.6,8.8,9,9.2,9.4,9.6,9.8,10,10.2,10.4,10.6,10.8,11,11.2,11.4,11.6,11.8,12,12.2,12.4,12.6,12.8,13,13.2,13.4,13.6,13.8,14,14.2,14.4,14.6,14.8,15,15.2,15.4,15.6,15.8,16,16.2,16.4,16.6,16.8,17,17.2,17.4,17.6,17.8,18,18.2,18.4,18.6,18.8,19,19.2,19.4,19.6,19.8,20,20.2,20.4,20.6,20.8,21,21.2,21.4,21.6,21.8,22,22.2,22.4,22.6,22.8,23,23.2,23.4,23.6,23.8,24,24.2,24.4,24.6,24.8,25,25.2,25.4,25.6,25.8,26,26.2,26.4,26.6,26.8,27,27.2,27.4,27.6,27.8,28,28.2,28.4,28.6,28.8,29,29.2,29.4,29.6,29.8,30,30.2,30.4,30.6,30.8,31,31.2,31.4,31.6,31.8,32,32.2,32.4,32.6,32.8,33,33.2,33.4,33.6,33.8,34,34.2,34.4,34.6,34.8,35,35.2,35.4,35.6,35.8,36,36.2,36.4,36.6,36.8,37,37.2,37.4,37.6,37.8,38,38.2,38.4,38.6,38.8,39,39.2,39.4,39.6,39.8,40],[2.2050100332756,2.20771586176893,2.2102054679244,2.21250064643396,2.21462269966501,2.2165923886791,2.21842988927969,2.22015475291379,2.22178587222696,2.22334145104625,2.22483897855038,2.22629520737474,2.22772613539181,2.22914699090616,2.23057222100557,2.23201548281502,2.23348963741075,2.2350067461634,2.23657806929387,2.23821406644373,2.23992439907968,2.24171793457294,2.24360275181511,2.24558614825449,2.24767464825902,2.2498740127334,2.25218924994058,2.25462462749715,2.25718368553159,2.2598692510117,2.26268345326155,2.26562774070113,2.26870289885032,2.27190906964417,2.27524577210881,2.27871192444375,2.28230586755095,2.28602539003958,2.28986775472048,2.29382972658596,2.2979076022472,2.30209724077672,2.30639409587474,2.31079324924836,2.3152894450621,2.31987712528718,2.32455046574774,2.32930341263492,2.33412971923545,2.33902298260204,2.34397667987774,2.34898420397821,2.35403889833323,2.35913409039339,2.36426312361914,2.36941938768743,2.37459634667537,2.37978756501042,2.38498673101081,2.39018767787907,2.39538440205138,2.40057107884913,2.40574207542035,2.41089196100095,2.41601551456458,2.42110772996607,2.42616381871601,2.43117921055111,2.4361495519884,2.44107070306844,2.44593873250546,2.45074991146993,2.4555007062318,2.46018776989166,2.46480793342209,2.46935819623375,2.47383571647062,2.47823780122641,2.4825618968615,2.48680557958536,2.49096654645488,2.49504260692524,2.49903167507465,2.5029317626112,2.5067409727553,2.51045749507771,2.51407960135959,2.51760564252644,2.52103404669388,2.52436331834786,2.52759203866627,2.53071886697268,2.53374254329496,2.53666189198428,2.53947582633103,2.54218335409572,2.54478358385499,2.54727573204497,2.54965913056893,2.55193323482175,2.55409763197327,2.55615204934452,2.55809636270666,2.55993060433343,2.5616549706415,2.56326982926288,2.56477572540598,2.56617338737911,2.56746373117014,2.56864786399835,2.56972708677872,2.57070289546368,2.57157698125151,2.57235122967426,2.57302771859893,2.57360871519431,2.57409667193125,2.5744942216951,2.57480417209724,2.57502949907565,2.57517333987478,2.5752389854909,2.57522987266259,2.57514957547657,2.57500179664788,2.5747903585207,2.57451919382304,2.57419233619483,2.57381391049638,2.57338812289235,2.57291925069608,2.57241163195067,2.57186965471727,2.57129774603716,2.57070036053296,2.57008196861583,2.56944704426939,2.56880005238714,2.56814543564922,2.56748760093407,2.56683090527313,2.5661796413697,2.56553802271688,2.56491016836433,2.56430008739711,2.56371166320421,2.56314863762649,2.56261459508477,2.56211294679915,2.56164691521662,2.56121951877039,2.56083355709611,2.56049159683085,2.56019595811832,2.55994870193907,2.5597516183781,2.55960621593357,2.55951371196003,2.55947502432872,2.55949076437473,2.55956123118875,2.559686407298,2.55986595576808,2.56009921874609,2.56038521745284,2.56072265362247,2.56110991237722,2.56154506651704,2.56202588219627,2.56254982595244,2.5631140730475,2.56371551707612,2.56435078079216,2.5650162281004,2.56570797715765,2.56642191452427,2.56715371030451,2.56789883421132,2.56865257248909,2.56941004562485,2.57016622677682,2.57091596084662,2.57165398411982,2.57237494439873,2.57307342154944,2.57374394838633,2.57438103181708,2.57497917417331,2.57553289465462,2.57603675081748,2.57648536004545,2.57687342094264,2.57719573459972,2.57744722568891,2.57762296335265,2.57771818185981,2.57772830101097,2.57764894628384,2.5774759687173,2.57720546453959,2.57683379455294],[2.2152916221277,2.22048205169573,2.22510055202153,2.22918633325406,2.23277880550059,2.23591734280322,2.23864106632118,2.24098864713971,2.24299812874702,2.24470676889545,2.24615090029474,2.24736580937259,2.24838563217254,2.24924326633935,2.24997029806283,2.25059694280122,2.25115199858824,2.25166281072955,2.25215524671582,2.25265368021585,2.25318098305783,2.25375852416291,2.25440617445398,2.25514231682862,2.25598386035425,2.25694625791395,2.25804352660905,2.25928827030051,2.2606917037543,2.26226367794025,2.26401270612271,2.26594599047408,2.26806944903726,2.27038774296176,2.27290430403799,2.27562136265389,2.27853997639612,2.28166005961054,2.28498041432228,2.2884987629888,2.29221178361688,2.2961151478129,2.30020356234862,2.30447081481101,2.30890982385806,2.31351269452384,2.3182707789017,2.32317474238707,2.32821463548353,2.33337997097215,2.33865980602252,2.3440428285941,2.34951744724916,2.35507188328636,2.36069426391927,2.36637271507969,2.37209545233052,2.37785086833722,2.3836276153733,2.38941468142664,2.39520145862495,2.4009778029049,2.40673408409824,2.41246122588787,2.41815073538077,2.42379472233881,2.42938590838707,2.43491762676928,2.44038381343142,2.44577899037869,2.45109824236588,2.45633718804409,2.46149194670193,2.46655910171116,2.47153566172266,2.47641902056687,2.48120691670258,2.48589739293784,2.49048875702454,2.49497954361215,2.49936847793981,2.50365444155611,2.50783644028283,2.51191357458499,2.51588501247406,2.51974996505207,2.5235076647996,2.52715734671556,2.53069823242791,2.53412951740721,2.53745036142267,2.54065988238237,2.54375715368641,2.54674120519568,2.54961102787396,2.55236558209862,2.55500380955611,2.55752464854433,2.55992705240103,2.56221001067016,2.56437257251395,2.56641387178538,2.56833315310001,2.57012979819546,2.57180335184567,2.57335354660827,2.57478032572892,2.57608386360306,2.57726458329984,2.57832317077907,2.57926058557115,2.58007806783527,2.58077714185213,2.58135961613803,2.58182758048014,2.58218340028176,2.58242970867124,2.58256939686433,2.5826056032803,2.58254170189747,2.58238129029799,2.58212817779792,2.5817863739915,2.5813600779622,2.58085366833089,2.58027169422861,2.57961886719895,2.57890005395707,2.57812026986082,2.57728467288534,2.57639855783813,2.57546735050778,2.57449660140729,2.57349197875316,2.57245926031535,2.57140432378025,2.57033313529115,2.56925173586664,2.56816622544741,2.56708274438531,2.56600745226299,2.56494650401666,2.56390602342445,2.56289207411684,2.56191062835727,2.5609675339286,2.56006847953854,2.55921895922154,2.55842423626158,2.55768930718897,2.55701886641082,2.55641727202105,2.55588851330197,2.55543618037742,2.55506343641121,2.55477299266804,2.55456708667203,2.55444746361488,2.55441536108689,2.55447149713337,2.55461606157939,2.55484871052103,2.55516856385098,2.55557420567266,2.55606368745685,2.55663453380939,2.55728375074189,2.55800783636941,2.55880279399395,2.55966414756846,2.56058695956696,2.56156585131188,2.56259502582308,2.56366829325573,2.56477909898089,2.5659205543355,2.56708547002529,2.56826639210746,2.56945564041135,2.57064534917759,2.57182750961334,2.5729940139781,2.57413670073543,2.57524740023547,2.57631798033804,2.57734039134788,2.57830670961841,2.57920917918871,2.58004025085315,2.58079261812231,2.58145924961763,2.5820334175466,2.58250872202671,2.58287911116017,2.583138896901,2.58328276689811,2.58330579263301,2.58320343429802,2.58297154297121,2.58260636073686,2.58210451947045]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>index<\/th>\n      <th>xg<\/th>\n      <th>mx_rot<\/th>\n      <th>mx_cv<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"tip","columnDefs":[{"targets":2,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 2, 3, \",\", \".\");\n  }"},{"targets":3,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 4, 3, \",\", \".\");\n  }"},{"targets":4,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 4, 3, \",\", \".\");\n  }"},{"className":"dt-center","targets":"_all"},{"visible":false,"targets":0},{"orderable":false,"targets":0}],"pageLength":8,"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[8,10,25,50,100]}},"evals":["options.columnDefs.0.render","options.columnDefs.1.render","options.columnDefs.2.render"],"jsHooks":[]}</script>
</div>
<div id="图形展示估计结果" class="section level3" number="4.5.3">
<h3><span class="header-section-number">4.5.3</span> 图形展示估计结果</h3>
<p>根据上述计算表，我们首先图形化展示在局部线性回归方法下（LLR）使用ROT谱宽估计得到的<span class="math inline">\(\widehat{m}(x)\)</span>：</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode numberSource r foldable numberLines"><code class="sourceCode r"><span id="cb71-1"><a href="lab-LL-wage.html#cb71-1"></a><span class="do">#### plot 19.5-b Local Linear Regression ####</span></span>
<span id="cb71-2"><a href="lab-LL-wage.html#cb71-2"></a></span>
<span id="cb71-3"><a href="lab-LL-wage.html#cb71-3"></a><span class="co"># basic plot</span></span>
<span id="cb71-4"><a href="lab-LL-wage.html#cb71-4"></a>p00 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb71-5"><a href="lab-LL-wage.html#cb71-5"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(X, Y),<span class="at">data =</span> dt_cps1, <span class="at">pch=</span><span class="dv">21</span>,<span class="at">alpha =</span><span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb71-6"><a href="lab-LL-wage.html#cb71-6"></a>  <span class="fu">labs</span>(<span class="at">x=</span> <span class="st">&quot;X职业年数&quot;</span>, <span class="at">y =</span><span class="st">&quot;log(Y)时均工资的对数&quot;</span>) <span class="sc">+</span></span>
<span id="cb71-7"><a href="lab-LL-wage.html#cb71-7"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">40</span>,<span class="dv">5</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">40</span>)) <span class="sc">+</span></span>
<span id="cb71-8"><a href="lab-LL-wage.html#cb71-8"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">2</span>,<span class="fl">2.7</span>,<span class="fl">0.1</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="fl">2.7</span>)) <span class="sc">+</span></span>
<span id="cb71-9"><a href="lab-LL-wage.html#cb71-9"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb71-10"><a href="lab-LL-wage.html#cb71-10"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> fsize))</span>
<span id="cb71-11"><a href="lab-LL-wage.html#cb71-11"></a></span>
<span id="cb71-12"><a href="lab-LL-wage.html#cb71-12"></a><span class="co"># plot mx with h_rot</span></span>
<span id="cb71-13"><a href="lab-LL-wage.html#cb71-13"></a>p_mxh1 <span class="ot">&lt;-</span> p00 <span class="sc">+</span></span>
<span id="cb71-14"><a href="lab-LL-wage.html#cb71-14"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> xg, <span class="at">y =</span> m1, </span>
<span id="cb71-15"><a href="lab-LL-wage.html#cb71-15"></a>                <span class="at">color=</span><span class="st">&quot;m1&quot;</span>, <span class="at">lty=</span><span class="st">&quot;m1&quot;</span>),</span>
<span id="cb71-16"><a href="lab-LL-wage.html#cb71-16"></a>            <span class="at">lwd =</span> lwd<span class="sc">+</span>lwadd,</span>
<span id="cb71-17"><a href="lab-LL-wage.html#cb71-17"></a>            <span class="at">data =</span> tb_mxh) <span class="sc">+</span></span>
<span id="cb71-18"><a href="lab-LL-wage.html#cb71-18"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb71-19"><a href="lab-LL-wage.html#cb71-19"></a>  <span class="fu">scale_color_manual</span>(</span>
<span id="cb71-20"><a href="lab-LL-wage.html#cb71-20"></a>    <span class="at">name=</span><span class="st">&quot;&quot;</span>,</span>
<span id="cb71-21"><a href="lab-LL-wage.html#cb71-21"></a>    <span class="at">breaks =</span> <span class="fu">c</span>(<span class="st">&quot;m1&quot;</span>),</span>
<span id="cb71-22"><a href="lab-LL-wage.html#cb71-22"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="fu">expression</span>(<span class="fu">m</span>(x)<span class="sc">:</span>h[ROT])),</span>
<span id="cb71-23"><a href="lab-LL-wage.html#cb71-23"></a>    <span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;green&quot;</span>))<span class="sc">+</span></span>
<span id="cb71-24"><a href="lab-LL-wage.html#cb71-24"></a>  <span class="fu">scale_linetype_manual</span>(</span>
<span id="cb71-25"><a href="lab-LL-wage.html#cb71-25"></a>    <span class="at">name=</span><span class="st">&quot;&quot;</span>,</span>
<span id="cb71-26"><a href="lab-LL-wage.html#cb71-26"></a>    <span class="at">breaks =</span> <span class="fu">c</span>(<span class="st">&quot;m1&quot;</span>),</span>
<span id="cb71-27"><a href="lab-LL-wage.html#cb71-27"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="fu">expression</span>(<span class="fu">m</span>(x)<span class="sc">:</span>h[ROT])),</span>
<span id="cb71-28"><a href="lab-LL-wage.html#cb71-28"></a>    <span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;dotted&quot;</span>))<span class="sc">+</span></span>
<span id="cb71-29"><a href="lab-LL-wage.html#cb71-29"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;right&quot;</span>,</span>
<span id="cb71-30"><a href="lab-LL-wage.html#cb71-30"></a>        <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> fsize))</span></code></pre></div>
<div class="sourceCode" id="cb72"><pre class="sourceCode numberSource r foldable numberLines"><code class="sourceCode r"><span id="cb72-1"><a href="lab-LL-wage.html#cb72-1"></a>p_mxh1</span></code></pre></div>
<p><img src="seminar_files/figure-html/unnamed-chunk-78-1.svg" width="90%" height="450" style="display: block; margin: auto;" /></p>
<p>然后，我们再图形化展示在局部线性回归方法下（LLR）使用最优CV谱宽估计得到的<span class="math inline">\(\widehat{m}(x)\)</span>：</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode numberSource r foldable numberLines"><code class="sourceCode r"><span id="cb73-1"><a href="lab-LL-wage.html#cb73-1"></a><span class="co"># plot mx with h_CV</span></span>
<span id="cb73-2"><a href="lab-LL-wage.html#cb73-2"></a>p_mxh2 <span class="ot">&lt;-</span> p00 <span class="sc">+</span></span>
<span id="cb73-3"><a href="lab-LL-wage.html#cb73-3"></a> <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> xg, <span class="at">y =</span> m2, </span>
<span id="cb73-4"><a href="lab-LL-wage.html#cb73-4"></a>                <span class="at">color=</span><span class="st">&quot;m2&quot;</span>, <span class="at">lty=</span><span class="st">&quot;m2&quot;</span>),</span>
<span id="cb73-5"><a href="lab-LL-wage.html#cb73-5"></a>            <span class="at">lwd =</span> lwd<span class="sc">+</span>lwadd,</span>
<span id="cb73-6"><a href="lab-LL-wage.html#cb73-6"></a>            <span class="at">data =</span> tb_mxh) <span class="sc">+</span></span>
<span id="cb73-7"><a href="lab-LL-wage.html#cb73-7"></a>  <span class="fu">scale_color_manual</span>(</span>
<span id="cb73-8"><a href="lab-LL-wage.html#cb73-8"></a>    <span class="at">name=</span><span class="st">&quot;&quot;</span>,</span>
<span id="cb73-9"><a href="lab-LL-wage.html#cb73-9"></a>    <span class="at">breaks =</span> <span class="fu">c</span>(<span class="st">&quot;m2&quot;</span>),</span>
<span id="cb73-10"><a href="lab-LL-wage.html#cb73-10"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="fu">expression</span>(<span class="fu">m</span>(x)<span class="sc">:</span>h[CV])),</span>
<span id="cb73-11"><a href="lab-LL-wage.html#cb73-11"></a>    <span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>))<span class="sc">+</span></span>
<span id="cb73-12"><a href="lab-LL-wage.html#cb73-12"></a>  <span class="fu">scale_linetype_manual</span>(</span>
<span id="cb73-13"><a href="lab-LL-wage.html#cb73-13"></a>    <span class="at">name=</span><span class="st">&quot;&quot;</span>,</span>
<span id="cb73-14"><a href="lab-LL-wage.html#cb73-14"></a>    <span class="at">breaks =</span> <span class="fu">c</span>(<span class="st">&quot;m2&quot;</span>),</span>
<span id="cb73-15"><a href="lab-LL-wage.html#cb73-15"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="fu">expression</span>(<span class="fu">m</span>(x)<span class="sc">:</span>h[CV])),</span>
<span id="cb73-16"><a href="lab-LL-wage.html#cb73-16"></a>    <span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;dashed&quot;</span>))<span class="sc">+</span></span>
<span id="cb73-17"><a href="lab-LL-wage.html#cb73-17"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;right&quot;</span>,</span>
<span id="cb73-18"><a href="lab-LL-wage.html#cb73-18"></a>        <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> fsize))</span></code></pre></div>
<div class="sourceCode" id="cb74"><pre class="sourceCode numberSource r foldable numberLines"><code class="sourceCode r"><span id="cb74-1"><a href="lab-LL-wage.html#cb74-1"></a>p_mxh2</span></code></pre></div>
<p><img src="seminar_files/figure-html/unnamed-chunk-80-1.svg" width="90%" height="450" style="display: block; margin: auto;" /></p>
<p>当然，最后我们可以对使用两种谱宽选择（rot谱宽或者CV谱宽）下的CEF估计值（<span class="math inline">\(\widehat{m}(x)\)</span>）做图形对比：</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode numberSource r foldable numberLines"><code class="sourceCode r"><span id="cb75-1"><a href="lab-LL-wage.html#cb75-1"></a><span class="co"># plot mx with both h selections</span></span>
<span id="cb75-2"><a href="lab-LL-wage.html#cb75-2"></a>p_mxh <span class="ot">&lt;-</span> p00 <span class="sc">+</span></span>
<span id="cb75-3"><a href="lab-LL-wage.html#cb75-3"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> xg, <span class="at">y =</span> m1, </span>
<span id="cb75-4"><a href="lab-LL-wage.html#cb75-4"></a>                <span class="at">color=</span><span class="st">&quot;m1&quot;</span>, <span class="at">lty=</span><span class="st">&quot;m1&quot;</span>),</span>
<span id="cb75-5"><a href="lab-LL-wage.html#cb75-5"></a>            <span class="at">lwd =</span> lwd<span class="sc">+</span>lwadd,</span>
<span id="cb75-6"><a href="lab-LL-wage.html#cb75-6"></a>            <span class="at">data =</span> tb_mxh) <span class="sc">+</span></span>
<span id="cb75-7"><a href="lab-LL-wage.html#cb75-7"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> xg, <span class="at">y =</span> m2, </span>
<span id="cb75-8"><a href="lab-LL-wage.html#cb75-8"></a>                <span class="at">color=</span><span class="st">&quot;m2&quot;</span>, <span class="at">lty=</span><span class="st">&quot;m2&quot;</span>), </span>
<span id="cb75-9"><a href="lab-LL-wage.html#cb75-9"></a>            <span class="at">lwd =</span> lwd<span class="sc">+</span>lwadd,</span>
<span id="cb75-10"><a href="lab-LL-wage.html#cb75-10"></a>            <span class="at">data =</span> tb_mxh) <span class="sc">+</span></span>
<span id="cb75-11"><a href="lab-LL-wage.html#cb75-11"></a>  <span class="fu">scale_color_manual</span>(</span>
<span id="cb75-12"><a href="lab-LL-wage.html#cb75-12"></a>    <span class="at">name=</span><span class="st">&quot;&quot;</span>,</span>
<span id="cb75-13"><a href="lab-LL-wage.html#cb75-13"></a>    <span class="at">breaks =</span> <span class="fu">c</span>(<span class="st">&quot;m1&quot;</span>, <span class="st">&quot;m2&quot;</span>),</span>
<span id="cb75-14"><a href="lab-LL-wage.html#cb75-14"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="fu">expression</span>(<span class="fu">m</span>(x)<span class="sc">:</span>h[ROT]),<span class="fu">expression</span>(<span class="fu">m</span>(x)<span class="sc">:</span>h[CV])),</span>
<span id="cb75-15"><a href="lab-LL-wage.html#cb75-15"></a>    <span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;green&quot;</span>, <span class="st">&quot;blue&quot;</span>))<span class="sc">+</span></span>
<span id="cb75-16"><a href="lab-LL-wage.html#cb75-16"></a>  <span class="fu">scale_linetype_manual</span>(</span>
<span id="cb75-17"><a href="lab-LL-wage.html#cb75-17"></a>    <span class="at">name=</span><span class="st">&quot;&quot;</span>,</span>
<span id="cb75-18"><a href="lab-LL-wage.html#cb75-18"></a>    <span class="at">breaks =</span> <span class="fu">c</span>(<span class="st">&quot;m1&quot;</span>, <span class="st">&quot;m2&quot;</span>),</span>
<span id="cb75-19"><a href="lab-LL-wage.html#cb75-19"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="fu">expression</span>(<span class="fu">m</span>(x)<span class="sc">:</span>h[ROT]),<span class="fu">expression</span>(<span class="fu">m</span>(x)<span class="sc">:</span>h[CV])),</span>
<span id="cb75-20"><a href="lab-LL-wage.html#cb75-20"></a>    <span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;dotted&quot;</span>, <span class="st">&quot;dashed&quot;</span>))<span class="sc">+</span></span>
<span id="cb75-21"><a href="lab-LL-wage.html#cb75-21"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;right&quot;</span>,</span>
<span id="cb75-22"><a href="lab-LL-wage.html#cb75-22"></a>        <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> fsize))</span></code></pre></div>
<div class="sourceCode" id="cb76"><pre class="sourceCode numberSource r foldable numberLines"><code class="sourceCode r"><span id="cb76-1"><a href="lab-LL-wage.html#cb76-1"></a>p_mxh</span></code></pre></div>
<p><img src="seminar_files/figure-html/unnamed-chunk-82-1.svg" width="90%" height="450" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="过程4计算非参数估计的预测误差" class="section level2" number="4.6">
<h2><span class="header-section-number">4.6</span> 过程4：计算非参数估计的预测误差</h2>
<div class="notes">
<p><strong>注意</strong>：至此以下的代码块，我们需要开始执行<code>hensen21-fig19-6.R</code>文件里的R命令！</p>
</div>
<div class="sourceCode" id="cb77"><pre class="sourceCode numberSource r foldable numberLines"><code class="sourceCode r"><span id="cb77-1"><a href="lab-LL-wage.html#cb77-1"></a><span class="co"># don&#39;t run here ! </span></span>
<span id="cb77-2"><a href="lab-LL-wage.html#cb77-2"></a><span class="co"># only show you the code file path!</span></span>
<span id="cb77-3"><a href="lab-LL-wage.html#cb77-3"></a><span class="fu">source</span>(<span class="fu">here</span>(<span class="st">&quot;Rscript/hensen21-fig19-5.R&quot;</span>), <span class="at">encoding =</span> <span class="st">&quot;UTF-8&quot;</span>)</span>
<span id="cb77-4"><a href="lab-LL-wage.html#cb77-4"></a><span class="fu">source</span>(<span class="fu">here</span>(<span class="st">&quot;Rscript/hensen21-fig19-6.R&quot;</span>), <span class="at">encoding =</span> <span class="st">&quot;UTF-8&quot;</span>)</span></code></pre></div>
<div id="r运算代码-3" class="section level3" number="4.6.1">
<h3><span class="header-section-number">4.6.1</span> R运算代码</h3>
<div class="sourceCode" id="cb78"><pre class="sourceCode numberSource r foldable numberLines"><code class="sourceCode r"><span id="cb78-1"><a href="lab-LL-wage.html#cb78-1"></a><span class="do">##  This file generates Figures 19.5 and 19.6</span></span>
<span id="cb78-2"><a href="lab-LL-wage.html#cb78-2"></a><span class="do">##  Wage/Experience</span></span>
<span id="cb78-3"><a href="lab-LL-wage.html#cb78-3"></a></span>
<span id="cb78-4"><a href="lab-LL-wage.html#cb78-4"></a><span class="do">#### attention 2/2 ####</span></span>
<span id="cb78-5"><a href="lab-LL-wage.html#cb78-5"></a></span>
<span id="cb78-6"><a href="lab-LL-wage.html#cb78-6"></a><span class="do">## this is the part 2/2 R script</span></span>
<span id="cb78-7"><a href="lab-LL-wage.html#cb78-7"></a><span class="do">## so you should run `hensen21-fig19-5.R` firstly </span></span>
<span id="cb78-8"><a href="lab-LL-wage.html#cb78-8"></a></span>
<span id="cb78-9"><a href="lab-LL-wage.html#cb78-9"></a><span class="do">#### ROT Residual Estimation ####</span></span>
<span id="cb78-10"><a href="lab-LL-wage.html#cb78-10"></a>h <span class="ot">&lt;-</span> hrot</span>
<span id="cb78-11"><a href="lab-LL-wage.html#cb78-11"></a>e2 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,n,<span class="dv">1</span>)</span>
<span id="cb78-12"><a href="lab-LL-wage.html#cb78-12"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb78-13"><a href="lab-LL-wage.html#cb78-13"></a>  xj <span class="ot">&lt;-</span> x<span class="sc">-</span>x[j]</span>
<span id="cb78-14"><a href="lab-LL-wage.html#cb78-14"></a>  k <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(xj<span class="sc">/</span>h)</span>
<span id="cb78-15"><a href="lab-LL-wage.html#cb78-15"></a>  k[j] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb78-16"><a href="lab-LL-wage.html#cb78-16"></a>  z <span class="ot">&lt;-</span> <span class="fu">cbind</span>(x1,xj)</span>
<span id="cb78-17"><a href="lab-LL-wage.html#cb78-17"></a>  zk <span class="ot">&lt;-</span> z<span class="sc">*</span>(k<span class="sc">%*%</span><span class="fu">cbind</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb78-18"><a href="lab-LL-wage.html#cb78-18"></a>  beta <span class="ot">&lt;-</span> <span class="fu">solve</span>(<span class="fu">t</span>(zk)<span class="sc">%*%</span>z,<span class="fu">t</span>(zk)<span class="sc">%*%</span>y)</span>
<span id="cb78-19"><a href="lab-LL-wage.html#cb78-19"></a>  e2[j,<span class="dv">1</span>] <span class="ot">&lt;-</span> (y[j]<span class="sc">-</span>beta[<span class="dv">1</span>])<span class="sc">^</span><span class="dv">2</span>   <span class="co"># get square residual here</span></span>
<span id="cb78-20"><a href="lab-LL-wage.html#cb78-20"></a>}</span></code></pre></div>
</div>
<div id="过程步骤解读-3" class="section level3" number="4.6.2">
<h3><span class="header-section-number">4.6.2</span> 过程步骤解读</h3>
<p>（1）获得预测残差</p>
<p>我们首先可以计算得到LL估计下的预测残差的平方
<span class="math inline">\(\tilde{e}^2_i\)</span></p>
<ul>
<li><p>这一步可以直接采用前述的参考谱宽
<span class="math inline">\(h_{rot}=5.1442\)</span></p></li>
<li><p>运行上述代码即可得到预测残差的平方<span class="math inline">\(e_i^2\)</span></p></li>
</ul>
</div>
</div>
<div id="过程5计算条件方差估计时的参考谱宽" class="section level2" number="4.7">
<h2><span class="header-section-number">4.7</span> 过程5：计算条件方差估计时的参考谱宽</h2>
<div id="r运算代码-4" class="section level3" number="4.7.1">
<h3><span class="header-section-number">4.7.1</span> R运算代码</h3>
<div class="sourceCode" id="cb79"><pre class="sourceCode numberSource r foldable numberLines"><code class="sourceCode r"><span id="cb79-1"><a href="lab-LL-wage.html#cb79-1"></a><span class="do">####  Variance ROT Bandwidth ####</span></span>
<span id="cb79-2"><a href="lab-LL-wage.html#cb79-2"></a>beta <span class="ot">&lt;-</span> <span class="fu">solve</span>((<span class="fu">t</span>(zz)<span class="sc">%*%</span>zz),(<span class="fu">t</span>(zz)<span class="sc">%*%</span>e2))</span>
<span id="cb79-3"><a href="lab-LL-wage.html#cb79-3"></a>b <span class="ot">&lt;-</span> <span class="fu">mean</span>(((beta[<span class="dv">3</span>]<span class="sc">+</span>x<span class="sc">*</span><span class="dv">3</span><span class="sc">*</span>beta[<span class="dv">4</span>]<span class="sc">+</span>(x<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span><span class="dv">6</span><span class="sc">*</span>beta[<span class="dv">5</span>])<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>xtrim)</span>
<span id="cb79-4"><a href="lab-LL-wage.html#cb79-4"></a>e <span class="ot">&lt;-</span> e2 <span class="sc">-</span> zz<span class="sc">%*%</span>beta</span>
<span id="cb79-5"><a href="lab-LL-wage.html#cb79-5"></a>sig <span class="ot">&lt;-</span> (<span class="fu">sum</span>(e<span class="sc">^</span><span class="dv">2</span>))<span class="sc">/</span>(n<span class="dv">-5</span>)</span>
<span id="cb79-6"><a href="lab-LL-wage.html#cb79-6"></a>hrotv <span class="ot">&lt;-</span> <span class="fl">0.58</span><span class="sc">*</span>(((sx2<span class="sc">-</span>sx1)<span class="sc">*</span>sig<span class="sc">/</span>n<span class="sc">/</span>b)<span class="sc">^</span>.<span class="dv">2</span>)</span></code></pre></div>
</div>
<div id="过程步骤解读-4" class="section level3" number="4.7.2">
<h3><span class="header-section-number">4.7.2</span> 过程步骤解读</h3>
<p>（2）再次获得参考谱宽：</p>
<ul>
<li><p>后面我们还要计算方差估计下的最优谱宽。因此，这里我们需要再进行一次参考谱宽的计算流程。</p></li>
<li><p>构建残差平方的多项式回归模型</p></li>
</ul>
<p><span class="math display">\[\begin{align}
\begin{split}
\tilde{e}^2_i=&amp;+\gamma_{0}+\gamma_{1}X_i+\gamma_{2}X^2_i+\gamma_{3}X^3_i+\gamma_{4}X^4_i+v_i
\end{split}
\end{align}\]</span></p>
<ul>
<li>利用ROT公式流程，再次获得参考谱宽</li>
</ul>
<p><span class="math display">\[\begin{align}
hv_{\text {rot }}&amp;=0.58\left(\frac{\widehat{\sigma}^{2}\left(\xi_{2}-\xi_{1}\right)}{n \widehat{B}}\right)^{1 / 5}  = 0.58 \times \left(\frac{1.2384\times \left(40-0\right)}{762 \times 0.000000300}\right)^{1 / 5}
= 6.7708
\end{align}\]</span></p>
</div>
</div>
<div id="过程6计算条件方差估计时的最优交叉验证谱宽" class="section level2" number="4.8">
<h2><span class="header-section-number">4.8</span> 过程6：计算条件方差估计时的最优交叉验证谱宽</h2>
<div id="r运算代码-5" class="section level3" number="4.8.1">
<h3><span class="header-section-number">4.8.1</span> R运算代码</h3>
<div class="notes">
<p><strong>注意</strong>：此代码运行时间较长（约3-5分钟），为提高渲染效率代码文件仅需运行一次。</p>
</div>
<div class="sourceCode" id="cb80"><pre class="sourceCode numberSource r foldable numberLines"><code class="sourceCode r"><span id="cb80-1"><a href="lab-LL-wage.html#cb80-1"></a><span class="do">#### Variance CV Bandwidth Selection ####</span></span>
<span id="cb80-2"><a href="lab-LL-wage.html#cb80-2"></a>h1 <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb80-3"><a href="lab-LL-wage.html#cb80-3"></a>h2 <span class="ot">&lt;-</span> <span class="dv">40</span></span>
<span id="cb80-4"><a href="lab-LL-wage.html#cb80-4"></a>hh <span class="ot">&lt;-</span> <span class="fu">seq</span>(h1,h2,(h2<span class="sc">-</span>h1)<span class="sc">/</span>g)</span>
<span id="cb80-5"><a href="lab-LL-wage.html#cb80-5"></a>hn <span class="ot">&lt;-</span> <span class="fu">length</span>(hh)</span>
<span id="cb80-6"><a href="lab-LL-wage.html#cb80-6"></a>LLV <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,n,hn)</span>
<span id="cb80-7"><a href="lab-LL-wage.html#cb80-7"></a>NWV <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,n,hn)</span>
<span id="cb80-8"><a href="lab-LL-wage.html#cb80-8"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>hn){</span>
<span id="cb80-9"><a href="lab-LL-wage.html#cb80-9"></a>  hi <span class="ot">&lt;-</span> hh[i]</span>
<span id="cb80-10"><a href="lab-LL-wage.html#cb80-10"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb80-11"><a href="lab-LL-wage.html#cb80-11"></a>    xj <span class="ot">&lt;-</span> x<span class="sc">-</span>x[j]</span>
<span id="cb80-12"><a href="lab-LL-wage.html#cb80-12"></a>    k <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(xj<span class="sc">/</span>hi)</span>
<span id="cb80-13"><a href="lab-LL-wage.html#cb80-13"></a>    k[j] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb80-14"><a href="lab-LL-wage.html#cb80-14"></a>    mu <span class="ot">&lt;-</span> (<span class="fu">t</span>(k)<span class="sc">%*%</span>e2)<span class="sc">/</span><span class="fu">sum</span>(k)</span>
<span id="cb80-15"><a href="lab-LL-wage.html#cb80-15"></a>    NWV[j,i] <span class="ot">&lt;-</span> (e2[j]<span class="sc">-</span>mu)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb80-16"><a href="lab-LL-wage.html#cb80-16"></a>    z <span class="ot">&lt;-</span> <span class="fu">cbind</span>(x1,xj)</span>
<span id="cb80-17"><a href="lab-LL-wage.html#cb80-17"></a>    zk <span class="ot">&lt;-</span> z<span class="sc">*</span>(k<span class="sc">%*%</span><span class="fu">cbind</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb80-18"><a href="lab-LL-wage.html#cb80-18"></a>    beta <span class="ot">&lt;-</span> <span class="fu">solve</span>(<span class="fu">t</span>(zk)<span class="sc">%*%</span>z,<span class="fu">t</span>(zk)<span class="sc">%*%</span>e2)</span>
<span id="cb80-19"><a href="lab-LL-wage.html#cb80-19"></a>    LLV[j,i] <span class="ot">&lt;-</span> (e2[j]<span class="sc">-</span>beta[<span class="dv">1</span>])<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb80-20"><a href="lab-LL-wage.html#cb80-20"></a>  }</span>
<span id="cb80-21"><a href="lab-LL-wage.html#cb80-21"></a>}</span>
<span id="cb80-22"><a href="lab-LL-wage.html#cb80-22"></a>cvNWV <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(NWV<span class="sc">*</span>(xtrim<span class="sc">%*%</span><span class="fu">matrix</span>(<span class="dv">1</span>,<span class="dv">1</span>,hn)))</span>
<span id="cb80-23"><a href="lab-LL-wage.html#cb80-23"></a>cvLLV <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(LLV<span class="sc">*</span>(xtrim<span class="sc">%*%</span><span class="fu">matrix</span>(<span class="dv">1</span>,<span class="dv">1</span>,hn)))</span>
<span id="cb80-24"><a href="lab-LL-wage.html#cb80-24"></a>i1 <span class="ot">&lt;-</span> <span class="fu">which.min</span>(cvNWV)</span>
<span id="cb80-25"><a href="lab-LL-wage.html#cb80-25"></a>i2 <span class="ot">&lt;-</span> <span class="fu">which.min</span>(cvLLV)</span>
<span id="cb80-26"><a href="lab-LL-wage.html#cb80-26"></a>hNWV <span class="ot">&lt;-</span> hh[i1]</span>
<span id="cb80-27"><a href="lab-LL-wage.html#cb80-27"></a>hLLV <span class="ot">&lt;-</span> hh[i2]</span>
<span id="cb80-28"><a href="lab-LL-wage.html#cb80-28"></a>hNWV_tex <span class="ot">&lt;-</span><span class="fu">paste0</span>(<span class="st">&quot;$h_{NW}=$&quot;</span>,<span class="fu">number</span>(hNWV,<span class="fl">0.1</span>),<span class="st">&quot;&quot;</span>)</span>
<span id="cb80-29"><a href="lab-LL-wage.html#cb80-29"></a>hLLV_tex <span class="ot">&lt;-</span><span class="fu">paste0</span>(<span class="st">&quot;$h_{CV}=$&quot;</span>,<span class="fu">number</span>(hLLV,<span class="fl">0.1</span>),<span class="st">&quot;&quot;</span>)</span>
<span id="cb80-30"><a href="lab-LL-wage.html#cb80-30"></a></span>
<span id="cb80-31"><a href="lab-LL-wage.html#cb80-31"></a>NWminV <span class="ot">&lt;-</span> <span class="fu">min</span>(cvNWV)</span>
<span id="cb80-32"><a href="lab-LL-wage.html#cb80-32"></a>LLminV <span class="ot">&lt;-</span> <span class="fu">min</span>(cvLLV)</span>
<span id="cb80-33"><a href="lab-LL-wage.html#cb80-33"></a></span>
<span id="cb80-34"><a href="lab-LL-wage.html#cb80-34"></a><span class="co"># combine all result</span></span>
<span id="cb80-35"><a href="lab-LL-wage.html#cb80-35"></a>tbl_cvcv <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb80-36"><a href="lab-LL-wage.html#cb80-36"></a>  <span class="at">h_tune =</span> hh, </span>
<span id="cb80-37"><a href="lab-LL-wage.html#cb80-37"></a>  <span class="at">cv_NW =</span> cvNWV,</span>
<span id="cb80-38"><a href="lab-LL-wage.html#cb80-38"></a>  <span class="at">cv_LL =</span> cvLLV)</span></code></pre></div>
</div>
<div id="过程步骤解读-5" class="section level3" number="4.8.2">
<h3><span class="header-section-number">4.8.2</span> 过程步骤解读</h3>
<p>（3）再次获得最优交叉验证谱宽：然后开始计算方差估计下的最优谱宽。这里我们再进行一次交叉验证谱宽的计算流程。</p>
<ul>
<li><p>步骤1：设定<strong>经验谱宽</strong>
<span class="math inline">\(hv_{rot}=6.7708\)</span>作为<strong>初始值</strong>。。</p></li>
<li><p>步骤2：设定<strong>调参谱宽</strong>（tuning bandwidth）。
&gt;</p></li>
<li><p>一个经验谱宽范围可供参考：
<span class="math inline">\([2.0, 40.0]\)</span>。</p></li>
<li><p>给定范围内的搜寻总数为
<span class="math inline">\(n=202\)</span>。则待评估序贯值为
<span class="math inline">\(h\in (2.0000, 2.1891, 2.3781, 2.5672, 2.7562, \cdots,39.4328, 39.6219, 39.8109, 40.0000)\)</span>。</p></li>
<li><p>步骤3：采用交叉验证<strong>留一法</strong>，分别遍历计算<strong>NW估计</strong>和<strong>LL估计</strong>下的全部CV值（见后面计算表）</p></li>
<li><p>步骤4：最小CV值对应的谱宽评估值，则为最优交叉验证谱宽。当然，我们最终发现<strong>NW估计</strong>和<strong>LL估计</strong>下的结果是一样的，都选择了最大边界值
<span class="math inline">\(hv_{CV}(NW)=hv_{CV}(LL)=40\)</span>。（见后面的CV比较图）</p></li>
</ul>
<p>最后我们就可以得到，NW和LL方法下的CV值计算表（附表）：</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode numberSource r foldable numberLines"><code class="sourceCode r"><span id="cb81-1"><a href="lab-LL-wage.html#cb81-1"></a>tbl_cvcv <span class="sc">%&gt;%</span></span>
<span id="cb81-2"><a href="lab-LL-wage.html#cb81-2"></a>  <span class="fu">add_column</span>(<span class="at">id =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(.), <span class="at">.before =</span> <span class="st">&quot;h_tune&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb81-3"><a href="lab-LL-wage.html#cb81-3"></a>  DT<span class="sc">::</span><span class="fu">datatable</span>(<span class="at">caption =</span> <span class="st">&quot;NW和LL方法下的CV计算表&quot;</span>,</span>
<span id="cb81-4"><a href="lab-LL-wage.html#cb81-4"></a>                <span class="at">options =</span> <span class="fu">list</span>(<span class="at">dom =</span><span class="st">&quot;tip&quot;</span>, <span class="at">pageLength =</span><span class="dv">8</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb81-5"><a href="lab-LL-wage.html#cb81-5"></a>  <span class="fu">formatRound</span>(<span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>), <span class="at">digits =</span> <span class="dv">4</span>)</span></code></pre></div>
<div id="htmlwidget-cf1b2ac34276c00b8578" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-cf1b2ac34276c00b8578">{"x":{"filter":"none","caption":"<caption>NW和LL方法下的CV计算表<\/caption>","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153","154","155","156","157","158","159","160","161","162","163","164","165","166","167","168","169","170","171","172","173","174","175","176","177","178","179","180","181","182","183","184","185","186","187","188","189","190","191","192","193","194","195","196","197","198","199","200","201","202"],[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202],[2,2.18905472636816,2.37810945273632,2.56716417910448,2.75621890547264,2.9452736318408,3.13432835820895,3.32338308457711,3.51243781094527,3.70149253731343,3.89054726368159,4.07960199004975,4.26865671641791,4.45771144278607,4.64676616915423,4.83582089552239,5.02487562189055,5.21393034825871,5.40298507462687,5.59203980099502,5.78109452736318,5.97014925373134,6.1592039800995,6.34825870646766,6.53731343283582,6.72636815920398,6.91542288557214,7.1044776119403,7.29353233830846,7.48258706467662,7.67164179104478,7.86069651741294,8.0497512437811,8.23880597014925,8.42786069651741,8.61691542288557,8.80597014925373,8.99502487562189,9.18407960199005,9.37313432835821,9.56218905472637,9.75124378109453,9.94029850746269,10.1293532338308,10.318407960199,10.5074626865672,10.6965174129353,10.8855721393035,11.0746268656716,11.2636815920398,11.452736318408,11.6417910447761,11.8308457711443,12.0199004975124,12.2089552238806,12.3980099502488,12.5870646766169,12.7761194029851,12.9651741293532,13.1542288557214,13.3432835820896,13.5323383084577,13.7213930348259,13.910447761194,14.0995024875622,14.2885572139303,14.4776119402985,14.6666666666667,14.8557213930348,15.044776119403,15.2338308457711,15.4228855721393,15.6119402985075,15.8009950248756,15.9900497512438,16.1791044776119,16.3681592039801,16.5572139303483,16.7462686567164,16.9353233830846,17.1243781094527,17.3134328358209,17.5024875621891,17.6915422885572,17.8805970149254,18.0696517412935,18.2587064676617,18.4477611940299,18.636815920398,18.8258706467662,19.0149253731343,19.2039800995025,19.3930348258706,19.5820895522388,19.771144278607,19.9601990049751,20.1492537313433,20.3383084577114,20.5273631840796,20.7164179104478,20.9054726368159,21.0945273631841,21.2835820895522,21.4726368159204,21.6616915422886,21.8507462686567,22.0398009950249,22.228855721393,22.4179104477612,22.6069651741294,22.7960199004975,22.9850746268657,23.1741293532338,23.363184079602,23.5522388059701,23.7412935323383,23.9303482587065,24.1194029850746,24.3084577114428,24.4975124378109,24.6865671641791,24.8756218905473,25.0646766169154,25.2537313432836,25.4427860696517,25.6318407960199,25.8208955223881,26.0099502487562,26.1990049751244,26.3880597014925,26.5771144278607,26.7661691542289,26.955223880597,27.1442786069652,27.3333333333333,27.5223880597015,27.7114427860697,27.9004975124378,28.089552238806,28.2786069651741,28.4676616915423,28.6567164179104,28.8457711442786,29.0348258706468,29.2238805970149,29.4129353233831,29.6019900497512,29.7910447761194,29.9800995024876,30.1691542288557,30.3582089552239,30.547263681592,30.7363184079602,30.9253731343284,31.1144278606965,31.3034825870647,31.4925373134328,31.681592039801,31.8706467661692,32.0597014925373,32.2487562189055,32.4378109452736,32.6268656716418,32.81592039801,33.0049751243781,33.1940298507463,33.3830845771144,33.5721393034826,33.7611940298507,33.9502487562189,34.1393034825871,34.3283582089552,34.5174129353234,34.7064676616915,34.8955223880597,35.0845771144279,35.273631840796,35.4626865671642,35.6517412935323,35.8407960199005,36.0298507462687,36.2189054726368,36.407960199005,36.5970149253731,36.7860696517413,36.9751243781095,37.1641791044776,37.3532338308458,37.5422885572139,37.7313432835821,37.9203980099502,38.1094527363184,38.2985074626866,38.4875621890547,38.6766169154229,38.865671641791,39.0547263681592,39.2437810945274,39.4328358208955,39.6218905472637,39.8109452736318,40],[1.21383127979881,1.21312374471202,1.21255823830136,1.21209858482981,1.21171684176641,1.21139109331003,1.21110443641818,1.21084429053393,1.2106017250885,1.21037075595258,1.2101476551192,1.20993032958527,1.20971780520261,1.20950982604717,1.20930656107302,1.20910839994493,1.20891581730995,1.20872928655606,1.20854922783001,1.20837597909106,1.20820978240874,1.20805078029358,1.20789901862155,1.20775445385468,1.20761696296785,1.20748635492835,1.20736238285722,1.20724475620178,1.20713315240755,1.20702722771377,1.20692662681725,1.2068309912546,1.20673996644231,1.2066532073865,1.20657038312921,1.2064911800365,1.2064153040582,1.20634248210017,1.20627246265286,1.20620501581415,1.2061399328348,1.20607702530145,1.2060161240576,1.20595707794795,1.20589975245684,1.2058440282982,1.2057898000021,1.20573697453239,1.20568546996091,1.20563521421586,1.20558614391606,1.20553820329739,1.20549134323408,1.20544552035442,1.20540069624808,1.20535683676095,1.20531391137201,1.20527189264628,1.20523075575768,1.20519047807513,1.20515103880585,1.20511241868973,1.20507459973893,1.20503756501755,1.20500129845628,1.20496578469768,1.20493100896789,1.20489695697118,1.2048636148041,1.20483096888626,1.20479900590534,1.20476771277388,1.20473707659614,1.20470708464322,1.20467772433492,1.20464898322729,1.20462084900459,1.20459330947488,1.20456635256847,1.20453996633848,1.20451413896307,1.20448885874891,1.20446411413536,1.20443989369929,1.20441618616007,1.20439298038469,1.20437026539282,1.20434803036158,1.20432626463012,1.20430495770379,1.20428409925789,1.20426367914105,1.20424368737809,1.20422411417245,1.20420494990816,1.20418618515137,1.20416781065144,1.20414981734161,1.20413219633928,1.20411493894593,1.20409803664668,1.20408148110952,1.20406526418428,1.20404937790127,1.20403381446973,1.20401856627601,1.20400362588161,1.20398898602094,1.203974639599,1.20396057968895,1.20394679952942,1.20393329252188,1.2039200522278,1.2039070723658,1.20389434680873,1.20388186958067,1.20386963485391,1.20385763694598,1.2038458703165,1.20383432956421,1.20382300942384,1.20381190476311,1.20380101057966,1.20379032199805,1.20377983426677,1.20376954275527,1.20375944295105,1.20374953045675,1.20373980098732,1.2037302503672,1.20372087452756,1.20371166950362,1.20370263143194,1.20369375654784,1.20368504118281,1.20367648176204,1.20366807480193,1.2036598169077,1.20365170477102,1.20364373516775,1.20363590495566,1.20362821107227,1.20362065053267,1.20361322042747,1.20360591792077,1.20359874024814,1.2035916847147,1.20358474869326,1.20357792962247,1.20357122500502,1.20356463240591,1.20355814945078,1.20355177382422,1.20354550326819,1.20353933558048,1.20353326861315,1.20352730027109,1.20352142851058,1.20351565133786,1.20350996680783,1.20350437302269,1.2034988681307,1.20349345032487,1.20348811784183,1.20348286896058,1.2034777020014,1.20347261532471,1.20346760733003,1.20346267645487,1.20345782117378,1.2034530399973,1.20344833147104,1.20344369417475,1.20343912672138,1.20343462775622,1.20343019595604,1.20342583002827,1.20342152871018,1.20341729076809,1.20341311499662,1.20340900021796,1.20340494528111,1.20340094906124,1.20339701045895,1.20339312839965,1.20338930183293,1.20338552973187,1.20338181109252,1.20337814493326,1.20337453029424,1.20337096623682,1.20336745184305,1.20336398621512,1.20336056847486,1.20335719776325,1.20335387323994,1.20335059408278,1.20334735948733,1.2033441686665,1.20334102085001,1.20333791528408,1.20333485123093],[1.21336809696562,1.21253997466541,1.21188616035084,1.21136992742086,1.21096169351285,1.21063781023187,1.21038078604346,1.2101787742584,1.2100241038621,1.20991150464024,1.20983666512858,1.20979538396574,1.2097832509323,1.20979566069405,1.20982797264122,1.20987569600216,1.20993464286493,1.21000103266027,1.21007155128313,1.2101433742753,1.21021416351506,1.21028204501037,1.21034557359776,1.21040368911041,1.2104556677802,1.21050107203836,1.21053970130604,1.21057154576159,1.21059674445329,1.21061554854423,1.21062828997732,1.21063535545974,1.21063716539523,1.21063415722908,1.21062677259574,1.21061544764946,1.21060060599403,1.21058265368868,1.21056197588098,1.2105389346927,1.21051386805604,1.21048708926062,1.21045888702519,1.21042952595181,1.21039924725507,1.21036826968556,1.21033679058737,1.21030498704398,1.21027301707829,1.21024102088021,1.2102091220412,1.2101774287793,1.21014603514164,1.21011502217376,1.21008445904743,1.2100544041401,1.21002490606118,1.20999600462128,1.20996773174212,1.20994011230574,1.20991316494285,1.20988690276072,1.209861334012,1.20983646270637,1.20981228916717,1.20978881053592,1.20976602122758,1.20974391333964,1.20972247701823,1.20970170078453,1.20968157182455,1.20966207624536,1.20964319930089,1.20962492558987,1.2096072392288,1.20959012400229,1.20957356349325,1.20955754119484,1.2095420406064,1.20952704531498,1.20951253906425,1.20949850581206,1.20948492977834,1.20947179548412,1.20945908778319,1.20944679188699,1.20943489338387,1.20942337825331,1.20941223287592,1.2094014440397,1.20939099894321,1.209380885196,1.20937109081684,1.20936160423002,1.20935241426007,1.20934351012516,1.20933488142949,1.20932651815473,1.20931841065091,1.20931054962672,1.20930292613941,1.20929553158448,1.20928835768519,1.20928139648199,1.20927464032192,1.20926808184806,1.20926171398917,1.20925552994932,1.20924952319781,1.20924368745929,1.20923801670404,1.20923250513857,1.2092271471964,1.20922193752921,1.20921687099816,1.20921194266553,1.20920714778668,1.2092024818022,1.20919794033044,1.20919351916019,1.20918921424379,1.20918502169033,1.20918093775927,1.20917695885418,1.20917308151683,1.20916930242144,1.20916561836922,1.20916202628312,1.20915852320275,1.2091551062796,1.20915177277237,1.20914852004259,1.20914534555029,1.20914224685003,1.20913922158695,1.20913626749305,1.20913338238367,1.209130564154,1.20912781077591,1.20912512029475,1.20912249082639,1.20911992055436,1.20911740772713,1.20911495065547,1.20911254770993,1.2091101973185,1.20910789796425,1.2091056481832,1.20910344656216,1.20910129173677,1.20909918238954,1.20909711724803,1.2090950950831,1.20909311470717,1.20909117497269,1.20908927477051,1.20908741302845,1.20908558870987,1.20908380081231,1.20908204836618,1.20908033043354,1.20907864610689,1.20907699450801,1.2090753747869,1.20907378612071,1.20907222771271,1.20907069879139,1.20906919860944,1.20906772644297,1.20906628159055,1.20906486337249,1.20906347112998,1.2090621042244,1.20906076203653,1.20905944396595,1.20905814943026,1.20905687786456,1.20905562872073,1.20905440146694,1.20905319558699,1.20905201057984,1.20905084595906,1.20904970125232,1.20904857600092,1.20904746975931,1.20904638209468,1.20904531258649,1.20904426082609,1.20904322641631,1.20904220897105,1.20904120811499,1.20904022348315,1.2090392547206,1.20903830148213,1.2090373634319,1.20903644024319,1.20903553159808,1.20903463718714,1.20903375670921,1.20903288987112,1.20903203638742,1.20903119598015]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>id<\/th>\n      <th>h_tune<\/th>\n      <th>cv_NW<\/th>\n      <th>cv_LL<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"tip","columnDefs":[{"targets":2,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 4, 3, \",\", \".\");\n  }"},{"targets":3,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 4, 3, \",\", \".\");\n  }"},{"targets":4,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 4, 3, \",\", \".\");\n  }"},{"className":"dt-center","targets":"_all"},{"visible":false,"targets":0},{"orderable":false,"targets":0}],"pageLength":8,"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[8,10,25,50,100]}},"evals":["options.columnDefs.0.render","options.columnDefs.1.render","options.columnDefs.2.render"],"jsHooks":[]}</script>
</div>
<div id="图形展示谱宽选择结果" class="section level3" number="4.8.3">
<h3><span class="header-section-number">4.8.3</span> 图形展示谱宽选择结果</h3>
<p>基于上述计算，我们最终得到NW和LL方法下方差估计的CV值与谱宽关系（制图代码及附图）：</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode numberSource r foldable numberLines"><code class="sourceCode r"><span id="cb82-1"><a href="lab-LL-wage.html#cb82-1"></a><span class="do">#### plot 19.6-a Cross-Validation Criterion ####</span></span>
<span id="cb82-2"><a href="lab-LL-wage.html#cb82-2"></a><span class="do">## Cross-Validation for Conditional Variance</span></span>
<span id="cb82-3"><a href="lab-LL-wage.html#cb82-3"></a></span>
<span id="cb82-4"><a href="lab-LL-wage.html#cb82-4"></a>p_cvcv <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> h_tune),<span class="at">data =</span> tbl_cvcv) <span class="sc">+</span></span>
<span id="cb82-5"><a href="lab-LL-wage.html#cb82-5"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> cv_NW, <span class="at">lty =</span> <span class="st">&quot;CV_NW&quot;</span>, <span class="at">color =</span> <span class="st">&quot;CV_NW&quot;</span>),</span>
<span id="cb82-6"><a href="lab-LL-wage.html#cb82-6"></a>            <span class="at">lwd =</span> lwd) <span class="sc">+</span></span>
<span id="cb82-7"><a href="lab-LL-wage.html#cb82-7"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> cv_LL, <span class="at">lty =</span> <span class="st">&quot;CV_LL&quot;</span>, <span class="at">color =</span> <span class="st">&quot;CV_LL&quot;</span>),</span>
<span id="cb82-8"><a href="lab-LL-wage.html#cb82-8"></a>            <span class="at">lwd =</span> lwd) <span class="sc">+</span></span>
<span id="cb82-9"><a href="lab-LL-wage.html#cb82-9"></a>  <span class="fu">labs</span>(<span class="at">x=</span> <span class="st">&quot;谱宽h&quot;</span>, <span class="at">y =</span><span class="st">&quot;交叉验证准则函数值CV(h)&quot;</span>) <span class="sc">+</span></span>
<span id="cb82-10"><a href="lab-LL-wage.html#cb82-10"></a>  <span class="fu">scale_x_continuous</span>(<span class="co">#expand = expansion(add = c(0, .06)),</span></span>
<span id="cb82-11"><a href="lab-LL-wage.html#cb82-11"></a>    <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">40</span>,<span class="dv">5</span>), </span>
<span id="cb82-12"><a href="lab-LL-wage.html#cb82-12"></a>    <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">40</span>)) <span class="sc">+</span></span>
<span id="cb82-13"><a href="lab-LL-wage.html#cb82-13"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">add =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)),</span>
<span id="cb82-14"><a href="lab-LL-wage.html#cb82-14"></a>                     <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="fl">1.200</span>, <span class="fl">1.216</span>,<span class="fl">0.004</span>), </span>
<span id="cb82-15"><a href="lab-LL-wage.html#cb82-15"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="fl">1.200</span>, <span class="fl">1.216</span>),</span>
<span id="cb82-16"><a href="lab-LL-wage.html#cb82-16"></a>                     <span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">number_format</span>(<span class="at">accuracy =</span> <span class="fl">0.001</span>)</span>
<span id="cb82-17"><a href="lab-LL-wage.html#cb82-17"></a>                     ) <span class="sc">+</span></span>
<span id="cb82-18"><a href="lab-LL-wage.html#cb82-18"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb82-19"><a href="lab-LL-wage.html#cb82-19"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x=</span>hNWV, <span class="at">xend =</span> hNWV,</span>
<span id="cb82-20"><a href="lab-LL-wage.html#cb82-20"></a>                   <span class="at">y=</span> NWminV, <span class="at">yend =</span> <span class="fl">1.2</span>),</span>
<span id="cb82-21"><a href="lab-LL-wage.html#cb82-21"></a>               <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.1</span>,<span class="st">&quot;cm&quot;</span>),</span>
<span id="cb82-22"><a href="lab-LL-wage.html#cb82-22"></a>                             <span class="at">type =</span> <span class="st">&quot;closed&quot;</span>),</span>
<span id="cb82-23"><a href="lab-LL-wage.html#cb82-23"></a>               <span class="at">lty =</span> <span class="st">&quot;dotted&quot;</span>, <span class="at">color=</span> <span class="st">&quot;gray&quot;</span>, <span class="at">lwd=</span>lwd)  <span class="sc">+</span></span>
<span id="cb82-24"><a href="lab-LL-wage.html#cb82-24"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> hNWV<span class="dv">-2</span>, <span class="at">y=</span>NWminV<span class="fl">-0.002</span>), </span>
<span id="cb82-25"><a href="lab-LL-wage.html#cb82-25"></a>            <span class="at">label =</span>latex2exp<span class="sc">::</span><span class="fu">TeX</span>(hNWV_tex),</span>
<span id="cb82-26"><a href="lab-LL-wage.html#cb82-26"></a>            <span class="at">color=</span> <span class="st">&quot;orange&quot;</span>, <span class="at">size=</span><span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb82-27"><a href="lab-LL-wage.html#cb82-27"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x=</span>hLLV, <span class="at">xend =</span> hLLV,</span>
<span id="cb82-28"><a href="lab-LL-wage.html#cb82-28"></a>                   <span class="at">y=</span> LLminV, <span class="at">yend =</span> <span class="fl">1.2</span>),</span>
<span id="cb82-29"><a href="lab-LL-wage.html#cb82-29"></a>               <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.1</span>,<span class="st">&quot;cm&quot;</span>),</span>
<span id="cb82-30"><a href="lab-LL-wage.html#cb82-30"></a>                             <span class="at">type =</span> <span class="st">&quot;closed&quot;</span>),</span>
<span id="cb82-31"><a href="lab-LL-wage.html#cb82-31"></a>               <span class="at">lty =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">color=</span> <span class="st">&quot;gray&quot;</span>, <span class="at">lwd=</span>lwd) <span class="sc">+</span></span>
<span id="cb82-32"><a href="lab-LL-wage.html#cb82-32"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> hLLV<span class="dv">-2</span>, <span class="at">y=</span>LLminV<span class="fl">-0.002</span>), </span>
<span id="cb82-33"><a href="lab-LL-wage.html#cb82-33"></a>            <span class="at">label =</span>latex2exp<span class="sc">::</span><span class="fu">TeX</span>(hLLV_tex),</span>
<span id="cb82-34"><a href="lab-LL-wage.html#cb82-34"></a>            <span class="at">color=</span> <span class="st">&quot;blue&quot;</span>, <span class="at">size=</span><span class="dv">3</span>)  <span class="sc">+</span></span>
<span id="cb82-35"><a href="lab-LL-wage.html#cb82-35"></a>  <span class="fu">scale_color_manual</span>(</span>
<span id="cb82-36"><a href="lab-LL-wage.html#cb82-36"></a>    <span class="at">name=</span><span class="st">&quot;&quot;</span>,</span>
<span id="cb82-37"><a href="lab-LL-wage.html#cb82-37"></a>    <span class="at">breaks =</span> <span class="fu">c</span>(<span class="st">&quot;CV_NW&quot;</span>, <span class="st">&quot;CV_LL&quot;</span>),</span>
<span id="cb82-38"><a href="lab-LL-wage.html#cb82-38"></a>    <span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;orange&quot;</span>, <span class="st">&quot;blue&quot;</span>))<span class="sc">+</span></span>
<span id="cb82-39"><a href="lab-LL-wage.html#cb82-39"></a>  <span class="fu">scale_linetype_manual</span>(</span>
<span id="cb82-40"><a href="lab-LL-wage.html#cb82-40"></a>    <span class="at">name=</span><span class="st">&quot;&quot;</span>,</span>
<span id="cb82-41"><a href="lab-LL-wage.html#cb82-41"></a>    <span class="at">breaks =</span> <span class="fu">c</span>(<span class="st">&quot;CV_NW&quot;</span>, <span class="st">&quot;CV_LL&quot;</span>),</span>
<span id="cb82-42"><a href="lab-LL-wage.html#cb82-42"></a>    <span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;dotted&quot;</span>, <span class="st">&quot;dashed&quot;</span>))<span class="sc">+</span></span>
<span id="cb82-43"><a href="lab-LL-wage.html#cb82-43"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;right&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb83"><pre class="sourceCode numberSource r foldable numberLines"><code class="sourceCode r"><span id="cb83-1"><a href="lab-LL-wage.html#cb83-1"></a>p_cvcv</span></code></pre></div>
<p><img src="seminar_files/figure-html/unnamed-chunk-89-1.svg" width="90%" height="420" style="display: block; margin: auto;" /></p>
<ul>
<li><p>LL估计的CV值在局部上具有最小值，也即局部最优谱宽约为
<span class="math inline">\(hv_{cv}(LL)\simeq 5\)</span></p></li>
<li><p>但是从全局来看，无论是NW估计，还是LL估计，CV函数值都表现为下降趋势。因此它们都选择了最大边界值
<span class="math inline">\(hv_{CV}(NW)=hv_{CV}(LL)=40\)</span>。</p></li>
</ul>
</div>
</div>
<div id="过程7计算cef估计的方差和标准差" class="section level2" number="4.9">
<h2><span class="header-section-number">4.9</span> 过程7：计算CEF估计的方差和标准差</h2>
<div id="r运算代码-6" class="section level3" number="4.9.1">
<h3><span class="header-section-number">4.9.1</span> R运算代码</h3>
<div class="sourceCode" id="cb84"><pre class="sourceCode numberSource r foldable numberLines"><code class="sourceCode r"><span id="cb84-1"><a href="lab-LL-wage.html#cb84-1"></a><span class="do">#### Variance Estimation ####</span></span>
<span id="cb84-2"><a href="lab-LL-wage.html#cb84-2"></a>se <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,g,<span class="dv">1</span>)</span>
<span id="cb84-3"><a href="lab-LL-wage.html#cb84-3"></a>u <span class="ot">&lt;-</span> <span class="fu">cbind</span>(e2,e2)</span>
<span id="cb84-4"><a href="lab-LL-wage.html#cb84-4"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>g){</span>
<span id="cb84-5"><a href="lab-LL-wage.html#cb84-5"></a>  xj <span class="ot">&lt;-</span> x<span class="sc">-</span>xg[j]</span>
<span id="cb84-6"><a href="lab-LL-wage.html#cb84-6"></a>  z <span class="ot">&lt;-</span> <span class="fu">cbind</span>(x1,xj)</span>
<span id="cb84-7"><a href="lab-LL-wage.html#cb84-7"></a>  K <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(xj<span class="sc">/</span>hrot)</span>
<span id="cb84-8"><a href="lab-LL-wage.html#cb84-8"></a>  z1 <span class="ot">&lt;-</span> z<span class="sc">*</span><span class="fu">cbind</span>(K,K)</span>
<span id="cb84-9"><a href="lab-LL-wage.html#cb84-9"></a>  ZKZ <span class="ot">&lt;-</span> <span class="fu">solve</span>(<span class="fu">t</span>(z1)<span class="sc">%*%</span>z)</span>
<span id="cb84-10"><a href="lab-LL-wage.html#cb84-10"></a>  ZK2 <span class="ot">&lt;-</span> <span class="fu">t</span>(z1)<span class="sc">%*%</span>(z1<span class="sc">*</span>u)</span>
<span id="cb84-11"><a href="lab-LL-wage.html#cb84-11"></a>  V1 <span class="ot">&lt;-</span> ZKZ<span class="sc">%*%</span>ZK2<span class="sc">%*%</span>ZKZ</span>
<span id="cb84-12"><a href="lab-LL-wage.html#cb84-12"></a>  se[j,<span class="dv">1</span>] <span class="ot">=</span> <span class="fu">sqrt</span>(V1[<span class="dv">1</span>,<span class="dv">1</span>])</span>
<span id="cb84-13"><a href="lab-LL-wage.html#cb84-13"></a>}</span>
<span id="cb84-14"><a href="lab-LL-wage.html#cb84-14"></a></span>
<span id="cb84-15"><a href="lab-LL-wage.html#cb84-15"></a>L1 <span class="ot">&lt;-</span> m1<span class="fl">-1.96</span><span class="sc">*</span>se</span>
<span id="cb84-16"><a href="lab-LL-wage.html#cb84-16"></a>U1 <span class="ot">&lt;-</span> m1<span class="fl">+1.96</span><span class="sc">*</span>se</span>
<span id="cb84-17"><a href="lab-LL-wage.html#cb84-17"></a></span>
<span id="cb84-18"><a href="lab-LL-wage.html#cb84-18"></a><span class="co"># combine all result as data.frame</span></span>
<span id="cb84-19"><a href="lab-LL-wage.html#cb84-19"></a>tbl_band <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb84-20"><a href="lab-LL-wage.html#cb84-20"></a>  <span class="at">xg =</span>xg,</span>
<span id="cb84-21"><a href="lab-LL-wage.html#cb84-21"></a>  <span class="at">mx =</span> m1,</span>
<span id="cb84-22"><a href="lab-LL-wage.html#cb84-22"></a>  <span class="at">s=</span><span class="fu">as.vector</span>(se),</span>
<span id="cb84-23"><a href="lab-LL-wage.html#cb84-23"></a>  <span class="at">s2=</span>se<span class="sc">^</span><span class="dv">2</span>,</span>
<span id="cb84-24"><a href="lab-LL-wage.html#cb84-24"></a>  <span class="at">lwr =</span> L1,</span>
<span id="cb84-25"><a href="lab-LL-wage.html#cb84-25"></a>  <span class="at">upr =</span> U1</span>
<span id="cb84-26"><a href="lab-LL-wage.html#cb84-26"></a>)</span></code></pre></div>
</div>
<div id="过程步骤解读-6" class="section level3" number="4.9.2">
<h3><span class="header-section-number">4.9.2</span> 过程步骤解读</h3>
<p>（4）计算方差、标准差。利用前面的平方预测误差，并使用谱宽
<span class="math inline">\(h=5.1442\)</span>进行LL估计，最终得到方差和标准差估计值（见后面附表）。</p>
<p><span class="math display">\[\begin{align}
\widehat{\boldsymbol{V}}_{\widehat{\beta}}(x)=\left(\boldsymbol{Z}^{\prime} \boldsymbol{K} \boldsymbol{Z}\right)^{-1}\left(\sum_{i=1}^{n} K\left(\frac{X_{i}-x}{h}\right)^{2} Z_{i}(x) Z_{i}(x)^{\prime} \widetilde{\boldsymbol{e}}_{i}^{2}\right)\left(\boldsymbol{Z}^{\prime} \boldsymbol{K} \boldsymbol{Z}\right)^{-1}
\end{align}\]</span></p>
<p>同时，我们将计算得到CEF估计值<span class="math inline">\(\widehat{m}(x)\)</span>的估计方差和估计标准误（见如下计算附表）：</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode numberSource r foldable numberLines"><code class="sourceCode r"><span id="cb85-1"><a href="lab-LL-wage.html#cb85-1"></a>tbl_band <span class="sc">%&gt;%</span></span>
<span id="cb85-2"><a href="lab-LL-wage.html#cb85-2"></a>  <span class="fu">add_column</span>(<span class="at">id =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(.), <span class="at">.before =</span> <span class="st">&quot;xg&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb85-3"><a href="lab-LL-wage.html#cb85-3"></a>  DT<span class="sc">::</span><span class="fu">datatable</span>(<span class="at">caption =</span> <span class="st">&quot;LL方法下的方差和标准差、置信区间&quot;</span>,</span>
<span id="cb85-4"><a href="lab-LL-wage.html#cb85-4"></a>                <span class="at">options =</span> <span class="fu">list</span>(<span class="at">dom =</span><span class="st">&quot;tip&quot;</span>, <span class="at">pageLength =</span><span class="dv">8</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb85-5"><a href="lab-LL-wage.html#cb85-5"></a>  <span class="fu">formatRound</span>(<span class="fu">c</span>(<span class="dv">3</span><span class="sc">:</span><span class="dv">7</span>), <span class="at">digits =</span> <span class="dv">4</span>)</span></code></pre></div>
<div id="htmlwidget-6f6f0451ad054c4fee08" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-6f6f0451ad054c4fee08">{"x":{"filter":"none","caption":"<caption>LL方法下的方差和标准差、置信区间<\/caption>","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153","154","155","156","157","158","159","160","161","162","163","164","165","166","167","168","169","170","171","172","173","174","175","176","177","178","179","180","181","182","183","184","185","186","187","188","189","190","191","192","193","194","195","196","197","198","199","200","201"],[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201],[0,0.2,0.4,0.6,0.8,1,1.2,1.4,1.6,1.8,2,2.2,2.4,2.6,2.8,3,3.2,3.4,3.6,3.8,4,4.2,4.4,4.6,4.8,5,5.2,5.4,5.6,5.8,6,6.2,6.4,6.6,6.8,7,7.2,7.4,7.6,7.8,8,8.2,8.4,8.6,8.8,9,9.2,9.4,9.6,9.8,10,10.2,10.4,10.6,10.8,11,11.2,11.4,11.6,11.8,12,12.2,12.4,12.6,12.8,13,13.2,13.4,13.6,13.8,14,14.2,14.4,14.6,14.8,15,15.2,15.4,15.6,15.8,16,16.2,16.4,16.6,16.8,17,17.2,17.4,17.6,17.8,18,18.2,18.4,18.6,18.8,19,19.2,19.4,19.6,19.8,20,20.2,20.4,20.6,20.8,21,21.2,21.4,21.6,21.8,22,22.2,22.4,22.6,22.8,23,23.2,23.4,23.6,23.8,24,24.2,24.4,24.6,24.8,25,25.2,25.4,25.6,25.8,26,26.2,26.4,26.6,26.8,27,27.2,27.4,27.6,27.8,28,28.2,28.4,28.6,28.8,29,29.2,29.4,29.6,29.8,30,30.2,30.4,30.6,30.8,31,31.2,31.4,31.6,31.8,32,32.2,32.4,32.6,32.8,33,33.2,33.4,33.6,33.8,34,34.2,34.4,34.6,34.8,35,35.2,35.4,35.6,35.8,36,36.2,36.4,36.6,36.8,37,37.2,37.4,37.6,37.8,38,38.2,38.4,38.6,38.8,39,39.2,39.4,39.6,39.8,40],[[2.2050100332756],[2.20771586176893],[2.2102054679244],[2.21250064643396],[2.21462269966501],[2.2165923886791],[2.21842988927969],[2.22015475291379],[2.22178587222696],[2.22334145104625],[2.22483897855038],[2.22629520737474],[2.22772613539181],[2.22914699090616],[2.23057222100557],[2.23201548281502],[2.23348963741075],[2.2350067461634],[2.23657806929387],[2.23821406644373],[2.23992439907968],[2.24171793457294],[2.24360275181511],[2.24558614825449],[2.24767464825902],[2.2498740127334],[2.25218924994058],[2.25462462749715],[2.25718368553159],[2.2598692510117],[2.26268345326155],[2.26562774070113],[2.26870289885032],[2.27190906964417],[2.27524577210881],[2.27871192444375],[2.28230586755095],[2.28602539003958],[2.28986775472048],[2.29382972658596],[2.2979076022472],[2.30209724077672],[2.30639409587474],[2.31079324924836],[2.3152894450621],[2.31987712528718],[2.32455046574774],[2.32930341263492],[2.33412971923545],[2.33902298260204],[2.34397667987774],[2.34898420397821],[2.35403889833323],[2.35913409039339],[2.36426312361914],[2.36941938768743],[2.37459634667537],[2.37978756501042],[2.38498673101081],[2.39018767787907],[2.39538440205138],[2.40057107884913],[2.40574207542035],[2.41089196100095],[2.41601551456458],[2.42110772996607],[2.42616381871601],[2.43117921055111],[2.4361495519884],[2.44107070306844],[2.44593873250546],[2.45074991146993],[2.4555007062318],[2.46018776989166],[2.46480793342209],[2.46935819623375],[2.47383571647062],[2.47823780122641],[2.4825618968615],[2.48680557958536],[2.49096654645488],[2.49504260692524],[2.49903167507465],[2.5029317626112],[2.5067409727553],[2.51045749507771],[2.51407960135959],[2.51760564252644],[2.52103404669388],[2.52436331834786],[2.52759203866627],[2.53071886697268],[2.53374254329496],[2.53666189198428],[2.53947582633103],[2.54218335409572],[2.54478358385499],[2.54727573204497],[2.54965913056893],[2.55193323482175],[2.55409763197327],[2.55615204934452],[2.55809636270666],[2.55993060433343],[2.5616549706415],[2.56326982926288],[2.56477572540598],[2.56617338737911],[2.56746373117014],[2.56864786399835],[2.56972708677872],[2.57070289546368],[2.57157698125151],[2.57235122967426],[2.57302771859893],[2.57360871519431],[2.57409667193125],[2.5744942216951],[2.57480417209724],[2.57502949907565],[2.57517333987478],[2.5752389854909],[2.57522987266259],[2.57514957547657],[2.57500179664788],[2.5747903585207],[2.57451919382304],[2.57419233619483],[2.57381391049638],[2.57338812289235],[2.57291925069608],[2.57241163195067],[2.57186965471727],[2.57129774603716],[2.57070036053296],[2.57008196861583],[2.56944704426939],[2.56880005238714],[2.56814543564922],[2.56748760093407],[2.56683090527313],[2.5661796413697],[2.56553802271688],[2.56491016836433],[2.56430008739711],[2.56371166320421],[2.56314863762649],[2.56261459508477],[2.56211294679915],[2.56164691521662],[2.56121951877039],[2.56083355709611],[2.56049159683085],[2.56019595811832],[2.55994870193907],[2.5597516183781],[2.55960621593357],[2.55951371196003],[2.55947502432872],[2.55949076437473],[2.55956123118875],[2.559686407298],[2.55986595576808],[2.56009921874609],[2.56038521745284],[2.56072265362247],[2.56110991237722],[2.56154506651704],[2.56202588219627],[2.56254982595244],[2.5631140730475],[2.56371551707612],[2.56435078079216],[2.5650162281004],[2.56570797715765],[2.56642191452427],[2.56715371030451],[2.56789883421132],[2.56865257248909],[2.56941004562485],[2.57016622677682],[2.57091596084662],[2.57165398411982],[2.57237494439873],[2.57307342154944],[2.57374394838633],[2.57438103181708],[2.57497917417331],[2.57553289465462],[2.57603675081748],[2.57648536004545],[2.57687342094264],[2.57719573459972],[2.57744722568891],[2.57762296335265],[2.57771818185981],[2.57772830101097],[2.57764894628384],[2.5774759687173],[2.57720546453959],[2.57683379455294]],[0.101614096838251,0.0978727711830225,0.0943681088914614,0.0910950820154802,0.0880484998805146,0.0852228677757836,0.0826122505930641,0.0802101483283008,0.0780093906614993,0.0760020575521545,0.0741794318276462,0.0725319880880214,0.071049420004896,0.0697207054729809,0.0685342063842402,0.0674777973745202,0.0665390160442423,0.0657052260882813,0.0649637845641794,0.0643022051247656,0.0637083102727466,0.0631703673279914,0.0626772045864382,0.0622183058761864,0.0617838832218386,0.0613649285197082,0.0609532459731018,0.0605414675550994,0.0601230540034993,0.0596922838707052,0.0592442330142455,0.0587747466792413,0.0582804060398355,0.0577584907681487,0.0572069389114839,0.0566243050965631,0.0560097178517715,0.055362836647426,0.0546838090993582,0.0539732286596641,0.0532320930262715,0.052461763435525,0.051663924954692,0.0508405478599222,0.0499938501659062,0.0491262613628485,0.0482403874116192,0.047338977046616,0.0464248894361014,0.0455010632500935,0.0445704871852027,0.0436361719934778,0.042701124057981,0.0417683205514769,0.0408406862065677,0.0399210717163392,0.0390122337748691,0.0381168167576001,0.0372373360335522,0.0363761628955327,0.0355355110916682,0.0347174249423322,0.0339237690310932,0.0331562194665319,0.032416256723042,0.0317051600819148,0.0310240037075109,0.0303736544051397,0.029754771115174,0.0291678061996436,0.0286130085710955,0.0280904286974031,0.0275999254898374,0.0271411750454801,0.0267136811705349,0.026316787560911,0.0259496914642025,0.025611458596941,0.0253010390469921,0.0250172838569996,0.0247589619638382,0.0245247771629302,0.0243133847754475,0.0241234077199623,0.0239534517259478,0.0238021194717058,0.023668023480372,0.0235497976610616,0.0234461074346759,0.0233556584325768,0.0232772037991398,0.0232095501647119,0.0231515623830471,0.0231021671468119,0.0230603556066715,0.0230251851245821,0.0229957802912253,0.0229713333321274,0.0229511040180249,0.0229344191834819,0.0229206719445775,0.0229093206924219,0.0228998879249801,0.0228919589656722,0.0228851806038524,0.0228792596798143,0.0228739616256055,0.0228691089627825,0.022864579749365,0.0228603059606988,0.0228562717827485,0.0228525117915208,0.022849108988908,0.022846192663257,0.0228439360424554,0.0228425537083127,0.02284229874354,0.0228434595867144,0.0228463565762614,0.0228513381716622,0.0228587768487308,0.0228690646757692,0.0228826085885092,0.0228998253937233,0.0229211365438667,0.0229469627377032,0.0229777184140343,0.0230138062168566,0.0230556115199196,0.0231034971061294,0.0231577981019883,0.0232188172687641,0.023286820749967,0.0233620343687441,0.023444640558944,0.0235347760000165,0.0236325300090008,0.0237379437231879,0.0238510100854365,0.0239716746214579,0.0240998369757132,0.0242353531508926,0.0243780383762994,0.0245276705137329,0.0246839938964264,0.0248467234878331,0.0250155492429225,0.0251901405553154,0.0253701506789828,0.0255552210230783,0.0257449852323477,0.0259390729828275,0.0261371134425175,0.0263387383685698,0.0265435848354026,0.0267512976111605,0.0269615312221806,0.0271739517657503,0.0273882385496441,0.027604085651963,0.0278212035060546,0.0280393206222191,0.0282581855601264,0.0284775692631194,0.0286972678577265,0.0289171060087968,0.0291369409028438,0.0293566669097391,0.0295762209462494,0.0297955885345545,0.030014810515463,0.0302339903402284,0.0304533018274794,0.0306729972336829,0.0308934154477694,0.0311149900841809,0.0313382572149612,0.0315638624520515,0.0317925670674067,0.0320252528227827,0.0322629251752352,0.0325067145307561,0.0327578752394006,0.0330177820629537,0.0332879239024755,0.0335698946492094,0.0338653811185185,0.0341761481416135,0.0345040210210152,0.0348508656981876,0.0352185671288425,0.0356090065044434,0.036024038087464,0.0364654665323091,0.0369350256331655,0.0374343594654718,0.0379650068627628,0.0385283900923704,0.0391258084628093,0.0397584374176677,0.0404273334540823],[[0.0103254246762534],[0.00957907933904427],[0.00890533997575072],[0.00829831396740707],[0.00775253833120897],[0.0072629371919287],[0.00682478394805121],[0.00643366789484801],[0.00608546503137842],[0.005776312752161],[0.0055025881062724],[0.00526088929600088],[0.00504802008303212],[0.00486097677165014],[0.00469693744471764],[0.0045532531385168],[0.00442744065613593],[0.00431717673531216],[0.00422029330490111],[0.00413477358390743],[0.00405874879780855],[0.00399049530835337],[0.00392843197477024],[0.00387111758610269],[0.00381724822596979],[0.0037656544522289],[0.00371529819465745],[0.00366526929372515],[0.00361478162270769],[0.00356316875370086],[0.00350987914544621],[0.00345447084720898],[0.0033966057281681],[0.00333604325581432],[0.00327263385962225],[0.00320631192766867],[0.00313708849383505],[0.00306504368164957],[0.00299031897761505],[0.00291310941194839],[0.00283365572795762],[0.00275223662276499],[0.00266916114172404],[0.00258476130669704],[0.00249938505441108],[0.0024133895554909],[0.0023271349776231],[0.00224097874782004],[0.00215527035915424],[0.00207034675688901],[0.00198652832792632],[0.00190411550624438],[0.00182338599581508],[0.00174459260169093],[0.00166796164982333],[0.0015936919669811],[0.00152195438410504],[0.00145289171973246],[0.00138661919487568],[0.00132322522700233],[0.00126277254854607],[0.00120529959462647],[0.00115082210527496],[0.00109933488931283],[0.00105081369993416],[0.00100521717581984],[0.00096248880604365],[0.000922558881922865],[0.000885346404116391],[0.000850760918499967],[0.000818704259489583],[0.00078907218440389],[0.000761755887044574],[0.000736643382849391],[0.000713620761680992],[0.000692573307526122],[0.000673386487087306],[0.000655946811462824],[0.000640142576857419],[0.000625864491581695],[0.000613006197526785],[0.000601464694891383],[0.000591140679238963],[0.000581938800023537],[0.000573767849587311],[0.000566540891345356],[0.000560175335467439],[0.000554592969876944],[0.000549719953838365],[0.000545486780819198],[0.00054182821670669],[0.000538683218848277],[0.00053599484077612],[0.000533710126879233],[0.000531780000706145],[0.000530159150021278],[0.000528805911202306],[0.000527682155055707],[0.000526753175646198],[0.000525987583283664],[0.000525357202390944],[0.000524836974588231],[0.000524404866976651],[0.000524041785286018],[0.000523731491270944],[0.000523460523496377],[0.000523218120449671],[0.000522996144751619],[0.000522789007115071],[0.000522593588616762],[0.000522409159806864],[0.000522237295181599],[0.000522081781586996],[0.000521948519206657],[0.000521845413911793],[0.00052178225991715],[0.000521770611889127],[0.000521823645889852],[0.00052195600880968],[0.000522183656235668],[0.000522523679020073],[0.000522994119144513],[0.000523613775814916],[0.000524402003063016],[0.00052537850046258],[0.000526563098885538],[0.000527975543514649],[0.000529635276587026],[0.000531561222557448],[0.000533771578532929],[0.000536283612932452],[0.000539113475360258],[0.000542276020641092],[0.000545784649846381],[0.000549651170938083],[0.000553885681370954],[0.000558496474626324],[0.000563489972205234],[0.000568870682095592],[0.000574641184157051],[0.000580802142255953],[0.000587352342348479],[0.000594288755076326],[0.000601606620830242],[0.000609299554678815],[0.000617359668080836],[0.000625777703925079],[0.000634543181196548],[0.00064364454547429],[0.000653069321538384],[0.000662804264613803],[0.00067283550720845],[0.000683148699107027],[0.000693729138847969],[0.000704561895914214],[0.000715631923880879],[0.000726924165844619],[0.000738423654567325],[0.000750115610852209],[0.00076198554468091],[0.000774019364525303],[0.000786203500955601],[0.000798525051150537],[0.000810971951135765],[0.000823533182498102],[0.00083619901992399],[0.000848961325175812],[0.000861813892049369],[0.00087475284546136],[0.000887777096120476],[0.000900888850279146],[0.000914094171893027],[0.00092740359219556],[0.00094083275929752],[0.000954403118028475],[0.000968142607938678],[0.000982086365271066],[0.000996277412892024],[0.00101076732073556],[0.00102561681836315],[0.00104089634086283],[0.00105668648958407],[0.00107307839020013],[0.00109017393235671],[0.001108085877737],[0.00112693782675902],[0.00114686403830251],[0.00116800910179751],[0.00119052746661866],[0.00121458283991311],[0.00124034747060878],[0.00126800134423349],[0.00129773132012706],[0.00132973024941895],[0.00136419611852259],[0.00140133126859016],[0.00144134174608962],[0.00148443684310986],[0.00153082888786844],[0.0015807333458946],[0.00163436929020756]],[[2.00584640347263],[2.0158852302502],[2.02524397449713],[2.03395428568361],[2.0420476398992],[2.04955556783856],[2.05650987811728],[2.06294286219032],[2.06888746653042],[2.07437741824403],[2.07944729216819],[2.08413251072222],[2.08846927218221],[2.09249440817911],[2.09624517649246],[2.09975899996096],[2.10307316596404],[2.10622450303037],[2.10924905154807],[2.11218174439919],[2.1150561109451],[2.11790401461008],[2.12075543082569],[2.12363826873717],[2.12657823714422],[2.12959875283477],[2.1327208878333],[2.13596335108915],[2.13934249968473],[2.14287237462512],[2.14656475655363],[2.15042923720982],[2.15447330301224],[2.1587024277386],[2.1631201718423],[2.16772828645448],[2.17252682056148],[2.17751423021063],[2.18268748888573],[2.18804219841302],[2.19357269991571],[2.19927218444309],[2.20513280296354],[2.21114577544291],[2.21730149873692],[2.223589653016],[2.22999930642097],[2.23651901762355],[2.24313693594069],[2.24984089863186],[2.25661852499474],[2.26345730687099],[2.27034469517959],[2.2772681821125],[2.28421537865427],[2.29117408712341],[2.29813236847663],[2.30507860416552],[2.31200155238505],[2.31889039860382],[2.32573480031171],[2.33252492596216],[2.33925148811941],[2.34590577084655],[2.35247965138741],[2.35896561620551],[2.36535677144928],[2.37164684791704],[2.37783020060265],[2.38390180291714],[2.38985723570611],[2.39569267122302],[2.40140485227172],[2.40699106680252],[2.41244911832784],[2.41777729261437],[2.42297432120079],[2.42803934237641],[2.43297186032939],[2.43777170322564],[2.44243898100576],[2.44697404368589],[2.45137744091477],[2.45564988348007],[2.45979220737244],[2.46380534091317],[2.46769027533806],[2.47144803911076],[2.47507967612192],[2.47858622782001],[2.48196871921996],[2.48522814864985],[2.48836548102419],[2.49138164437653],[2.49427752934195],[2.49705399125154],[2.49971185448419],[2.502251918714],[2.5046749666936],[2.50698177322212],[2.5091731149619],[2.51124978078737],[2.5132125823737],[2.51506236476071],[2.51680001665795],[2.51842648029044],[2.5199427606198],[2.52134993381206],[2.52264915486138],[2.52384166431538],[2.52492879408453],[2.5259119723523],[2.52679272763325],[2.52757269205427],[2.52825360395572],[2.52883730992602],[2.52932576639391],[2.52972104090514],[2.53002531320776],[2.5302408762592],[2.53037013725127],[2.5304156187264],[2.53037995982911],[2.53026591770487],[2.5300763690219],[2.5298143115548],[2.52948286573154],[2.52908527600979],[2.52862491191733],[2.52810526856434],[2.52752996641618],[2.52690275010389],[2.52622748604734],[2.52550815867442],[2.52474886503743],[2.5239538076558],[2.52312728545175],[2.52227368268969],[2.52139745588177],[2.52050311867601],[2.51959522480073],[2.51867834919395],[2.51775706749934],[2.51683593415742],[2.51591945936011],[2.51501208516806],[2.51411816111036],[2.51324191959635],[2.51238745146834],[2.51155868201139],[2.51075934771499],[2.50999297404977],[2.50926285448352],[2.50857203091593],[2.50792327566168],[2.50731907506022],[2.50676161473809],[2.50625276649916],[2.50579407677142],[2.50538675649689],[2.50503167231689],[2.50472933887845],[2.50447991207024],[2.50428318299037],[2.5041385724517],[2.50404512584523],[2.50400150820764],[2.50400599937395],[2.50405648914162],[2.50415047242472],[2.50428504443719],[2.50445689600927],[2.5046623092103],[2.50489715352238],[2.50515688288003],[2.50543653395928],[2.50573072616318],[2.5060336638053],[2.50633914103697],[2.50664055009219],[2.50693089343336],[2.50720280036633],[2.5074485486506],[2.50766009155534],[2.50782909070059],[2.50794695487388],[2.50800488482479],[2.50799392381575],[2.50790501345343],[2.50772905404903],[2.50745696847292],[2.50707976819393],[2.50658861994829],[2.50597491128558],[2.50523031311164],[2.50434683730749],[2.50331688755995],[2.5021333017028],[2.50078938413019],[2.49927892720096],[2.49759622098294]],[[2.40417366307857],[2.39954649328765],[2.39516696135166],[2.3910470071843],[2.38719775943081],[2.38362920951964],[2.38034990044209],[2.37736664363726],[2.3746842779235],[2.37230548384847],[2.37023066493256],[2.36845790402727],[2.36698299860141],[2.3657995736332],[2.36489926551868],[2.36427196566908],[2.36390610885747],[2.36378898929643],[2.36390708703966],[2.36424638848827],[2.36479268721427],[2.3655318545358],[2.36645007280453],[2.36753402777182],[2.36877105937382],[2.37014927263203],[2.37165761204786],[2.37328590390514],[2.37502487137844],[2.37686612739828],[2.37880214996947],[2.38082624419245],[2.3829324946884],[2.38511571154974],[2.38737137237532],[2.38969556243301],[2.39208491454042],[2.39453654986854],[2.39704802055522],[2.3996172547589],[2.40224250457869],[2.40492229711035],[2.40765538878594],[2.4104407230538],[2.41327739138727],[2.41616459755837],[2.41910162507452],[2.42208780764628],[2.42512250253021],[2.42820506657222],[2.43133483476073],[2.43451110108542],[2.43773310148687],[2.44099999867428],[2.44431086858401],[2.44766468825146],[2.45106032487411],[2.45449652585531],[2.45797190963658],[2.46148495715431],[2.46503400379105],[2.4686172317361],[2.47223266272129],[2.47587815115535],[2.47955137774174],[2.48324984372662],[2.48697086598273],[2.49071157318518],[2.49446890337414],[2.49823960321974],[2.50202022930481],[2.50580715171684],[2.50959656019188],[2.5133844729808],[2.51716674851633],[2.52093909985314],[2.52469711174046],[2.52843626007642],[2.5321519333936],[2.53583945594507],[2.539494111904],[2.54311117016458],[2.54668590923453],[2.55021364174233],[2.55368973813816],[2.55710964924225],[2.56046892738111],[2.56376324594212],[2.56698841726584],[2.57014040887571],[2.57321535811259],[2.57620958529552],[2.57911960556573],[2.58194213959203],[2.5846741233201],[2.5873127169399],[2.5898553132258],[2.59229954537594],[2.59464329444426],[2.59688469642137],[2.59902214898465],[2.60105431790166],[2.60298014303962],[2.60479884390614],[2.60650992462505],[2.60811317823531],[2.60960869019217],[2.61099684094616],[2.61227830747889],[2.61345406368132],[2.6145253794729],[2.61549381857506],[2.61636123486977],[2.61712976729424],[2.61780183324214],[2.6183801204626],[2.61886757746859],[2.61926740248506],[2.61958303098671],[2.61981812189211],[2.61997654249829],[2.62006235225541],[2.62007978549607],[2.62003323324827],[2.61992722427386],[2.61976640548659],[2.61955552191455],[2.61929939637987],[2.61900290907542],[2.61867097722037],[2.61830853497598],[2.61792051379745],[2.61751182338721],[2.61708733339989],[2.61665185602849],[2.61621012957586],[2.61576680308703],[2.61532642208459],[2.61489341541668],[2.61447208319213],[2.61406658574553],[2.61368093354545],[2.61331897793443],[2.61298440257125],[2.6126807154341],[2.61241124124037],[2.61217911414261],[2.61198727057319],[2.61183844212996],[2.61173514842186],[2.61167968982579],[2.61167414014245],[2.61172033917819],[2.61181988532072],[2.61197412821646],[2.61218416169597],[2.61245081712904],[2.6127746574209],[2.61315597188603],[2.61359477225258],[2.61409079006062],[2.61464347571755],[2.61525199946593],[2.6159152545018],[2.61663186245399],[2.61740018139971],[2.61821831654679],[2.61908413366013],[2.61999527525091],[2.62094917948017],[2.62194310165781],[2.62297413814297],[2.62403925237402],[2.62513530267842],[2.62625907143528],[2.62740729508927],[2.62857669444583],[2.62976400461734],[2.63096600394121],[2.6321795411575],[2.63340156012028],[2.6346291213269],[2.63585941958905],[2.63708979724212],[2.63831775239829],[2.63954094189878],[2.64075717880938],[2.64196442453087],[2.64316077585581],[2.64434444758593],[2.64551375161798],[2.64666707369135],[2.64780284925115],[2.64891954009223],[2.65001561359365],[2.65108952641214],[2.65213971446198],[2.65316459086489],[2.6541625533044],[2.65513200187821],[2.65607136812294]]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>id<\/th>\n      <th>xg<\/th>\n      <th>mx<\/th>\n      <th>s<\/th>\n      <th>s2<\/th>\n      <th>lwr<\/th>\n      <th>upr<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"tip","columnDefs":[{"targets":3,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 4, 3, \",\", \".\");\n  }"},{"targets":4,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 4, 3, \",\", \".\");\n  }"},{"targets":5,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 4, 3, \",\", \".\");\n  }"},{"targets":6,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 4, 3, \",\", \".\");\n  }"},{"targets":7,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 4, 3, \",\", \".\");\n  }"},{"className":"dt-center","targets":"_all"},{"visible":false,"targets":0},{"orderable":false,"targets":0}],"pageLength":8,"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[8,10,25,50,100]}},"evals":["options.columnDefs.0.render","options.columnDefs.1.render","options.columnDefs.2.render","options.columnDefs.3.render","options.columnDefs.4.render"],"jsHooks":[]}</script>
<p>（5）计算置信区间和置信带。进一步计算<strong>逐点置信区间</strong>（Pointwise Conﬁdence Interval）（见前面附表），并得到置信带（见后面附图）。</p>
<p><span class="math display">\[\begin{align}
\widehat{m}(x) \pm z_{1-\alpha/2}(n-1) \cdot \sqrt{\widehat{V}_{\widehat{m}(x)}}\\
\widehat{m}(x) \pm 1.96 \sqrt{\widehat{V}_{\widehat{m}(x)}}
\end{align}\]</span></p>
</div>
<div id="图形展示置信带" class="section level3" number="4.9.3">
<h3><span class="header-section-number">4.9.3</span> 图形展示置信带</h3>
<p>利用前述数据和置信区间机选公式，最总我们可以得到LLR方法下CEF估计量<span class="math inline">\(\widehat{m}(x)\)</span>的估计置信区间和置信带（附图）</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode numberSource r foldable numberLines"><code class="sourceCode r"><span id="cb86-1"><a href="lab-LL-wage.html#cb86-1"></a><span class="do">#### Plot 19.6-b Confidence Bands ####</span></span>
<span id="cb86-2"><a href="lab-LL-wage.html#cb86-2"></a>p_band <span class="ot">&lt;-</span> p00 <span class="sc">+</span></span>
<span id="cb86-3"><a href="lab-LL-wage.html#cb86-3"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> xg, <span class="at">y =</span> mx),</span>
<span id="cb86-4"><a href="lab-LL-wage.html#cb86-4"></a>            <span class="at">data =</span> tbl_band,</span>
<span id="cb86-5"><a href="lab-LL-wage.html#cb86-5"></a>            <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">lty =</span> <span class="st">&quot;solid&quot;</span>, <span class="at">lwd =</span> lwd) <span class="sc">+</span></span>
<span id="cb86-6"><a href="lab-LL-wage.html#cb86-6"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">x=</span>xg,<span class="at">ymin =</span> lwr, <span class="at">ymax =</span> upr),</span>
<span id="cb86-7"><a href="lab-LL-wage.html#cb86-7"></a>              <span class="at">data =</span> tbl_band,</span>
<span id="cb86-8"><a href="lab-LL-wage.html#cb86-8"></a>              <span class="at">alpha =</span> <span class="fl">0.2</span>)</span></code></pre></div>
<div class="sourceCode" id="cb87"><pre class="sourceCode numberSource r foldable numberLines"><code class="sourceCode r"><span id="cb87-1"><a href="lab-LL-wage.html#cb87-1"></a>p_band</span></code></pre></div>
<p><img src="seminar_files/figure-html/unnamed-chunk-93-1.svg" width="90%" height="450" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="参考文献-3" class="section level2 unnumbered">
<h2>参考文献</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-ludwig2007" class="csl-entry">
Ludwig J, Miller D L. Does <span>Head Start</span> Improve Children’s Life Chances? <span>Evidence</span> from a Regression Discontinuity Design[J]. The Quarterly journal of economics, 2007, 122(1): 159–208.
</div>
<div id="ref-robinson1988" class="csl-entry">
Robinson P M. Root-<span>N-consistent</span> Semiparametric Regression[J]. Econometrica: Journal of the Econometric Society, 1988, : 931–954.
</div>
</div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="lab-local-reg.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="lab-srdd-nocovs.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook/js/app.min.js"></script>
<script src="libs/gitbook/js/lunr.js"></script>
<script src="libs/gitbook/js/clipboard.min.js"></script>
<script src="libs/gitbook/js/plugin-search.js"></script>
<script src="libs/gitbook/js/plugin-sharing.js"></script>
<script src="libs/gitbook/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook/js/plugin-bookdown.js"></script>
<script src="libs/gitbook/js/jquery.highlight.js"></script>
<script src="libs/gitbook/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section",
"toc_depth": 5,
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
